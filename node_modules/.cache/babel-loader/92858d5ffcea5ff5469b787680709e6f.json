{"ast":null,"code":"require(\"core-js/modules/web.dom-exception.stack.js\");\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\n!function (e, t) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = t(require(\"jszip\")) : \"function\" == typeof define && define.amd ? define([\"jszip\"], t) : \"object\" == typeof exports ? exports.docx = t(require(\"jszip\")) : e.docx = t(e.JSZip);\n}(globalThis, e => (() => {\n  \"use strict\";\n\n  var t = {\n    438: (e, t, r) => {\n      r.r(t), r.d(t, {\n        default: () => d\n      });\n      var a = r(537),\n          s = r.n(a),\n          n = r(645),\n          l = r.n(n),\n          o = r(806),\n          i = r.n(o),\n          c = new URL(r(583), r.b),\n          u = l()(s()),\n          p = i()(c);\n      u.push([e.id, '@namespace \"http://www.w3.org/1998/Math/MathML\";math{display:inline-block;line-height:initial}mfrac{display:inline-block;vertical-align:-50%;text-align:center}mfrac>:first-child{border-bottom:solid thin currentColor}mfrac>*{display:block}msub>:nth-child(2){font-size:smaller;vertical-align:sub}msup>:nth-child(2){font-size:smaller;vertical-align:super}munder,mover,munderover{display:inline-flex;flex-flow:column nowrap;vertical-align:middle;text-align:center}munder>:not(:first-child),mover>:not(:first-child),munderover>:not(:first-child){font-size:smaller}munderover>:last-child{order:-1}mroot,msqrt{position:relative;display:inline-block;border-top:solid thin currentColor;margin-top:.5px;vertical-align:middle;margin-left:1ch}mroot:before,msqrt:before{content:\"\";display:inline-block;position:absolute;width:1ch;left:-1ch;top:-1px;bottom:0;background-image:url(' + p + \")}\", \"\", {\n        version: 3,\n        sources: [\"webpack://./src/mathml.scss\"],\n        names: [],\n        mappings: \"AAAA,+CAAA,CAEA,KACI,oBAAA,CACA,mBAAA,CAGJ,MACI,oBAAA,CACA,mBAAA,CACA,iBAAA,CAEA,mBACI,qCAAA,CAGJ,QACI,aAAA,CAKJ,mBACI,iBAAA,CACA,kBAAA,CAKJ,mBACI,iBAAA,CACA,oBAAA,CAIR,wBACI,mBAAA,CACA,uBAAA,CACA,qBAAA,CACA,iBAAA,CAEA,iFACI,iBAAA,CAKJ,uBAAA,QAAA,CAGJ,YACI,iBAAA,CACA,oBAAA,CACA,kCAAA,CACA,eAAA,CACA,qBAAA,CACA,eAAA,CAEA,0BACI,UAAA,CACA,oBAAA,CACA,iBAAA,CACA,SAAA,CACA,SAAA,CACA,QAAA,CACA,QAAA,CACA,wDAAA\",\n        sourcesContent: [\"@namespace \\\"http://www.w3.org/1998/Math/MathML\\\";\\r\\n\\r\\nmath {\\r\\n    display: inline-block;\\r\\n    line-height: initial;\\r\\n}\\r\\n\\r\\nmfrac {\\r\\n    display: inline-block;\\r\\n    vertical-align: -50%;\\r\\n    text-align: center;\\r\\n\\r\\n    &>:first-child {\\r\\n        border-bottom: solid thin currentColor;\\r\\n    }\\r\\n\\r\\n    &>* {\\r\\n        display: block;\\r\\n    }\\r\\n}\\r\\n\\r\\nmsub {\\r\\n    &>:nth-child(2) {\\r\\n        font-size: smaller;\\r\\n        vertical-align: sub;\\r\\n    }\\r\\n}\\r\\n\\r\\nmsup {\\r\\n    &>:nth-child(2) {\\r\\n        font-size: smaller;\\r\\n        vertical-align: super;\\r\\n    }\\r\\n}\\r\\n\\r\\nmunder, mover, munderover {\\r\\n    display: inline-flex;\\r\\n    flex-flow: column nowrap;\\r\\n    vertical-align: middle;\\r\\n    text-align: center;\\r\\n\\r\\n    &>:not(:first-child) {\\r\\n        font-size: smaller;\\r\\n    }\\r\\n}\\r\\n\\r\\nmunderover {\\r\\n    &>:last-child { order: -1; }\\r\\n}\\r\\n\\r\\nmroot, msqrt {\\r\\n    position: relative;\\r\\n    display: inline-block;\\r\\n    border-top: solid thin currentColor;  \\r\\n    margin-top: 0.5px;\\r\\n    vertical-align: middle;  \\r\\n    margin-left: 1ch; \\r\\n\\r\\n    &:before {\\r\\n        content: \\\"\\\";\\r\\n        display: inline-block;\\r\\n        position: absolute;\\r\\n        width: 1ch;\\r\\n        left: -1ch;\\r\\n        top: -1px;\\r\\n        bottom: 0;\\r\\n        background-image: url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 100' preserveAspectRatio='none'%3E%3Cpath d='m0,75 l5,0 l5,25 l10,-100' stroke='black' fill='none' vector-effect='non-scaling-stroke'/%3E%3C/svg%3E\\\");\\r\\n    }\\r\\n}\"],\n        sourceRoot: \"\"\n      }]);\n      const d = u.toString();\n    },\n    645: e => {\n      e.exports = function (e) {\n        var t = [];\n        return t.toString = function () {\n          return this.map(function (t) {\n            var r = \"\",\n                a = void 0 !== t[5];\n            return t[4] && (r += \"@supports (\".concat(t[4], \") {\")), t[2] && (r += \"@media \".concat(t[2], \" {\")), a && (r += \"@layer\".concat(t[5].length > 0 ? \" \".concat(t[5]) : \"\", \" {\")), r += e(t), a && (r += \"}\"), t[2] && (r += \"}\"), t[4] && (r += \"}\"), r;\n          }).join(\"\");\n        }, t.i = function (e, r, a, s, n) {\n          \"string\" == typeof e && (e = [[null, e, void 0]]);\n          var l = {};\n          if (a) for (var o = 0; o < this.length; o++) {\n            var i = this[o][0];\n            null != i && (l[i] = !0);\n          }\n\n          for (var c = 0; c < e.length; c++) {\n            var u = [].concat(e[c]);\n            a && l[u[0]] || (void 0 !== n && (void 0 === u[5] || (u[1] = \"@layer\".concat(u[5].length > 0 ? \" \".concat(u[5]) : \"\", \" {\").concat(u[1], \"}\")), u[5] = n), r && (u[2] ? (u[1] = \"@media \".concat(u[2], \" {\").concat(u[1], \"}\"), u[2] = r) : u[2] = r), s && (u[4] ? (u[1] = \"@supports (\".concat(u[4], \") {\").concat(u[1], \"}\"), u[4] = s) : u[4] = \"\".concat(s)), t.push(u));\n          }\n        }, t;\n      };\n    },\n    806: e => {\n      e.exports = function (e, t) {\n        return t || (t = {}), e ? (e = String(e.__esModule ? e.default : e), /^['\"].*['\"]$/.test(e) && (e = e.slice(1, -1)), t.hash && (e += t.hash), /[\"'() \\t\\n]|(%20)/.test(e) || t.needQuotes ? '\"'.concat(e.replace(/\"/g, '\\\\\"').replace(/\\n/g, \"\\\\n\"), '\"') : e) : e;\n      };\n    },\n    537: e => {\n      e.exports = function (e) {\n        var t = e[1],\n            r = e[3];\n        if (!r) return t;\n\n        if (\"function\" == typeof btoa) {\n          var a = btoa(unescape(encodeURIComponent(JSON.stringify(r)))),\n              s = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(a),\n              n = \"/*# \".concat(s, \" */\"),\n              l = r.sources.map(function (e) {\n            return \"/*# sourceURL=\".concat(r.sourceRoot || \"\").concat(e, \" */\");\n          });\n          return [t].concat(l).concat([n]).join(\"\\n\");\n        }\n\n        return [t].join(\"\\n\");\n      };\n    },\n    522: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.OpenXmlPackage = void 0;\n      const a = r(626),\n            s = r(472),\n            n = r(593),\n            l = r(461);\n\n      class o {\n        constructor(e, t) {\n          this._zip = e, this.options = t, this.xmlParser = new s.XmlParser();\n        }\n\n        get(e) {\n          return this._zip.files[function (e) {\n            return e.startsWith(\"/\") ? e.substr(1) : e;\n          }(e)];\n        }\n\n        update(e, t) {\n          this._zip.file(e, t);\n        }\n\n        static load(e, t) {\n          return a.loadAsync(e).then(e => new o(e, t));\n        }\n\n        save(e = \"blob\") {\n          return this._zip.generateAsync({\n            type: e\n          });\n        }\n\n        load(e, t = \"string\") {\n          var r, a;\n          return null !== (a = null === (r = this.get(e)) || void 0 === r ? void 0 : r.async(t)) && void 0 !== a ? a : Promise.resolve(null);\n        }\n\n        loadRelationships(e = null) {\n          let t = \"_rels/.rels\";\n\n          if (null != e) {\n            const [r, a] = (0, n.splitPath)(e);\n            t = `${r}_rels/${a}.rels`;\n          }\n\n          return this.load(t).then(e => e ? (0, l.parseRelationships)(this.parseXmlDocument(e).firstElementChild, this.xmlParser) : null);\n        }\n\n        parseXmlDocument(e) {\n          return (0, s.parseXmlString)(e, this.options.trimXmlDeclaration);\n        }\n\n      }\n\n      t.OpenXmlPackage = o;\n    },\n    530: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.Part = void 0;\n      const a = r(472);\n      t.Part = class {\n        constructor(e, t) {\n          this._package = e, this.path = t;\n        }\n\n        load() {\n          return Promise.all([this._package.loadRelationships(this.path).then(e => {\n            this.rels = e;\n          }), this._package.load(this.path).then(e => {\n            const t = this._package.parseXmlDocument(e);\n\n            this._package.options.keepOrigin && (this._xmlDocument = t), this.parseXml(t.firstElementChild);\n          })]);\n        }\n\n        save() {\n          this._package.update(this.path, (0, a.serializeXmlString)(this._xmlDocument));\n        }\n\n        parseXml(e) {}\n\n      };\n    },\n    461: (e, t) => {\n      var r;\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseRelationships = t.RelationshipTypes = void 0, (r = t.RelationshipTypes || (t.RelationshipTypes = {})).OfficeDocument = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\", r.FontTable = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable\", r.Image = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\", r.Numbering = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering\", r.Styles = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\", r.StylesWithEffects = \"http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects\", r.Theme = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\", r.Settings = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings\", r.WebSettings = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings\", r.Hyperlink = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\", r.Footnotes = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes\", r.Endnotes = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes\", r.Footer = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\", r.Header = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\", r.ExtendedProperties = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\", r.CoreProperties = \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\", r.CustomProperties = \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties\", t.parseRelationships = function (e, t) {\n        return t.elements(e).map(e => ({\n          id: t.attr(e, \"Id\"),\n          type: t.attr(e, \"Type\"),\n          target: t.attr(e, \"Target\"),\n          targetMode: t.attr(e, \"TargetMode\")\n        }));\n      };\n    },\n    168: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.DocumentParser = t.autos = void 0;\n      const a = r(120),\n            s = r(109),\n            n = r(59),\n            l = r(472),\n            o = r(488),\n            i = r(172),\n            c = r(149),\n            u = r(320);\n      t.autos = {\n        shd: \"inherit\",\n        color: \"black\",\n        borderColor: \"black\",\n        highlight: \"transparent\"\n      };\n      const p = [],\n            d = {\n        oMath: a.DomType.MmlMath,\n        oMathPara: a.DomType.MmlMathParagraph,\n        f: a.DomType.MmlFraction,\n        num: a.DomType.MmlNumerator,\n        den: a.DomType.MmlDenominator,\n        rad: a.DomType.MmlRadical,\n        deg: a.DomType.MmlDegree,\n        e: a.DomType.MmlBase,\n        sSup: a.DomType.MmlSuperscript,\n        sSub: a.DomType.MmlSubscript,\n        sup: a.DomType.MmlSuperArgument,\n        sub: a.DomType.MmlSubArgument,\n        d: a.DomType.MmlDelimiter,\n        nary: a.DomType.MmlNary\n      };\n      t.DocumentParser = class {\n        constructor(e) {\n          this.options = Object.assign({\n            ignoreWidth: !1,\n            debug: !1\n          }, e);\n        }\n\n        parseNotes(e, t, r) {\n          var a = [];\n\n          for (let s of l.default.elements(e, t)) {\n            const e = new r();\n            e.id = l.default.attr(s, \"id\"), e.noteType = l.default.attr(s, \"type\"), e.children = this.parseBodyElements(s), a.push(e);\n          }\n\n          return a;\n        }\n\n        parseDocumentFile(e) {\n          var t = l.default.element(e, \"body\"),\n              r = l.default.element(e, \"background\"),\n              s = l.default.element(t, \"sectPr\");\n          return {\n            type: a.DomType.Document,\n            children: this.parseBodyElements(t),\n            props: s ? (0, n.parseSectionProperties)(s, l.default) : null,\n            cssStyle: r ? this.parseBackground(r) : {}\n          };\n        }\n\n        parseBackground(e) {\n          var t = {},\n              r = m.colorAttr(e, \"color\");\n          return r && (t[\"background-color\"] = r), t;\n        }\n\n        parseBodyElements(e) {\n          var t = [];\n\n          for (let r of l.default.elements(e)) switch (r.localName) {\n            case \"p\":\n              t.push(this.parseParagraph(r));\n              break;\n\n            case \"tbl\":\n              t.push(this.parseTable(r));\n              break;\n\n            case \"sdt\":\n              t.push(...this.parseSdt(r, e => this.parseBodyElements(e)));\n          }\n\n          return t;\n        }\n\n        parseStylesFile(e) {\n          var t = [];\n          return m.foreach(e, e => {\n            switch (e.localName) {\n              case \"style\":\n                t.push(this.parseStyle(e));\n                break;\n\n              case \"docDefaults\":\n                t.push(this.parseDefaultStyles(e));\n            }\n          }), t;\n        }\n\n        parseDefaultStyles(e) {\n          var t = {\n            id: null,\n            name: null,\n            target: null,\n            basedOn: null,\n            styles: []\n          };\n          return m.foreach(e, e => {\n            switch (e.localName) {\n              case \"rPrDefault\":\n                var r = l.default.element(e, \"rPr\");\n                r && t.styles.push({\n                  target: \"span\",\n                  values: this.parseDefaultProperties(r, {})\n                });\n                break;\n\n              case \"pPrDefault\":\n                var a = l.default.element(e, \"pPr\");\n                a && t.styles.push({\n                  target: \"p\",\n                  values: this.parseDefaultProperties(a, {})\n                });\n            }\n          }), t;\n        }\n\n        parseStyle(e) {\n          var t = {\n            id: l.default.attr(e, \"styleId\"),\n            isDefault: l.default.boolAttr(e, \"default\"),\n            name: null,\n            target: null,\n            basedOn: null,\n            styles: [],\n            linked: null\n          };\n\n          switch (l.default.attr(e, \"type\")) {\n            case \"paragraph\":\n              t.target = \"p\";\n              break;\n\n            case \"table\":\n              t.target = \"table\";\n              break;\n\n            case \"character\":\n              t.target = \"span\";\n          }\n\n          return m.foreach(e, e => {\n            switch (e.localName) {\n              case \"basedOn\":\n                t.basedOn = l.default.attr(e, \"val\");\n                break;\n\n              case \"name\":\n                t.name = l.default.attr(e, \"val\");\n                break;\n\n              case \"link\":\n                t.linked = l.default.attr(e, \"val\");\n                break;\n\n              case \"next\":\n                t.next = l.default.attr(e, \"val\");\n                break;\n\n              case \"aliases\":\n                t.aliases = l.default.attr(e, \"val\").split(\",\");\n                break;\n\n              case \"pPr\":\n                t.styles.push({\n                  target: \"p\",\n                  values: this.parseDefaultProperties(e, {})\n                }), t.paragraphProps = (0, s.parseParagraphProperties)(e, l.default);\n                break;\n\n              case \"rPr\":\n                t.styles.push({\n                  target: \"span\",\n                  values: this.parseDefaultProperties(e, {})\n                }), t.runProps = (0, o.parseRunProperties)(e, l.default);\n                break;\n\n              case \"tblPr\":\n              case \"tcPr\":\n                t.styles.push({\n                  target: \"td\",\n                  values: this.parseDefaultProperties(e, {})\n                });\n                break;\n\n              case \"tblStylePr\":\n                for (let r of this.parseTableStyle(e)) t.styles.push(r);\n\n                break;\n\n              case \"rsid\":\n              case \"qFormat\":\n              case \"hidden\":\n              case \"semiHidden\":\n              case \"unhideWhenUsed\":\n              case \"autoRedefine\":\n              case \"uiPriority\":\n                break;\n\n              default:\n                this.options.debug && console.warn(`DOCX: Unknown style element: ${e.localName}`);\n            }\n          }), t;\n        }\n\n        parseTableStyle(e) {\n          var t = [],\n              r = l.default.attr(e, \"type\"),\n              a = \"\",\n              s = \"\";\n\n          switch (r) {\n            case \"firstRow\":\n              s = \".first-row\", a = \"tr.first-row td\";\n              break;\n\n            case \"lastRow\":\n              s = \".last-row\", a = \"tr.last-row td\";\n              break;\n\n            case \"firstCol\":\n              s = \".first-col\", a = \"td.first-col\";\n              break;\n\n            case \"lastCol\":\n              s = \".last-col\", a = \"td.last-col\";\n              break;\n\n            case \"band1Vert\":\n              s = \":not(.no-vband)\", a = \"td.odd-col\";\n              break;\n\n            case \"band2Vert\":\n              s = \":not(.no-vband)\", a = \"td.even-col\";\n              break;\n\n            case \"band1Horz\":\n              s = \":not(.no-hband)\", a = \"tr.odd-row\";\n              break;\n\n            case \"band2Horz\":\n              s = \":not(.no-hband)\", a = \"tr.even-row\";\n              break;\n\n            default:\n              return [];\n          }\n\n          return m.foreach(e, e => {\n            switch (e.localName) {\n              case \"pPr\":\n                t.push({\n                  target: `${a} p`,\n                  mod: s,\n                  values: this.parseDefaultProperties(e, {})\n                });\n                break;\n\n              case \"rPr\":\n                t.push({\n                  target: `${a} span`,\n                  mod: s,\n                  values: this.parseDefaultProperties(e, {})\n                });\n                break;\n\n              case \"tblPr\":\n              case \"tcPr\":\n                t.push({\n                  target: a,\n                  mod: s,\n                  values: this.parseDefaultProperties(e, {})\n                });\n            }\n          }), t;\n        }\n\n        parseNumberingFile(e) {\n          var t = [],\n              r = {},\n              a = [];\n          return m.foreach(e, e => {\n            switch (e.localName) {\n              case \"abstractNum\":\n                this.parseAbstractNumbering(e, a).forEach(e => t.push(e));\n                break;\n\n              case \"numPicBullet\":\n                a.push(this.parseNumberingPicBullet(e));\n                break;\n\n              case \"num\":\n                var s = l.default.attr(e, \"numId\"),\n                    n = l.default.elementAttr(e, \"abstractNumId\", \"val\");\n                r[n] = s;\n            }\n          }), t.forEach(e => e.id = r[e.id]), t;\n        }\n\n        parseNumberingPicBullet(e) {\n          var t = l.default.element(e, \"pict\"),\n              r = t && l.default.element(t, \"shape\"),\n              a = r && l.default.element(r, \"imagedata\");\n          return a ? {\n            id: l.default.intAttr(e, \"numPicBulletId\"),\n            src: l.default.attr(a, \"id\"),\n            style: l.default.attr(r, \"style\")\n          } : null;\n        }\n\n        parseAbstractNumbering(e, t) {\n          var r = [],\n              a = l.default.attr(e, \"abstractNumId\");\n          return m.foreach(e, e => {\n            \"lvl\" === e.localName && r.push(this.parseNumberingLevel(a, e, t));\n          }), r;\n        }\n\n        parseNumberingLevel(e, t, r) {\n          var a = {\n            id: e,\n            level: l.default.intAttr(t, \"ilvl\"),\n            pStyleName: void 0,\n            pStyle: {},\n            rStyle: {},\n            suff: \"tab\"\n          };\n          return m.foreach(t, e => {\n            switch (e.localName) {\n              case \"pPr\":\n                this.parseDefaultProperties(e, a.pStyle);\n                break;\n\n              case \"rPr\":\n                this.parseDefaultProperties(e, a.rStyle);\n                break;\n\n              case \"lvlPicBulletId\":\n                var t = l.default.intAttr(e, \"val\");\n                a.bullet = r.find(e => e.id == t);\n                break;\n\n              case \"lvlText\":\n                a.levelText = l.default.attr(e, \"val\");\n                break;\n\n              case \"pStyle\":\n                a.pStyleName = l.default.attr(e, \"val\");\n                break;\n\n              case \"numFmt\":\n                a.format = l.default.attr(e, \"val\");\n                break;\n\n              case \"suff\":\n                a.suff = l.default.attr(e, \"val\");\n            }\n          }), a;\n        }\n\n        parseSdt(e, t) {\n          const r = l.default.element(e, \"sdtContent\");\n          return r ? t(r) : [];\n        }\n\n        parseInserted(e, t) {\n          var r, s;\n          return {\n            type: a.DomType.Inserted,\n            children: null !== (s = null === (r = t(e)) || void 0 === r ? void 0 : r.children) && void 0 !== s ? s : []\n          };\n        }\n\n        parseDeleted(e, t) {\n          var r, s;\n          return {\n            type: a.DomType.Deleted,\n            children: null !== (s = null === (r = t(e)) || void 0 === r ? void 0 : r.children) && void 0 !== s ? s : []\n          };\n        }\n\n        parseParagraph(e) {\n          var t = {\n            type: a.DomType.Paragraph,\n            children: []\n          };\n\n          for (let r of l.default.elements(e)) switch (r.localName) {\n            case \"pPr\":\n              this.parseParagraphProperties(r, t);\n              break;\n\n            case \"r\":\n              t.children.push(this.parseRun(r, t));\n              break;\n\n            case \"hyperlink\":\n              t.children.push(this.parseHyperlink(r, t));\n              break;\n\n            case \"bookmarkStart\":\n              t.children.push((0, i.parseBookmarkStart)(r, l.default));\n              break;\n\n            case \"bookmarkEnd\":\n              t.children.push((0, i.parseBookmarkEnd)(r, l.default));\n              break;\n\n            case \"oMath\":\n            case \"oMathPara\":\n              t.children.push(this.parseMathElement(r));\n              break;\n\n            case \"sdt\":\n              t.children.push(...this.parseSdt(r, e => this.parseParagraph(e).children));\n              break;\n\n            case \"ins\":\n              t.children.push(this.parseInserted(r, e => this.parseParagraph(e)));\n              break;\n\n            case \"del\":\n              t.children.push(this.parseDeleted(r, e => this.parseParagraph(e)));\n          }\n\n          return t;\n        }\n\n        parseParagraphProperties(e, t) {\n          this.parseDefaultProperties(e, t.cssStyle = {}, null, e => {\n            if ((0, s.parseParagraphProperty)(e, t, l.default)) return !0;\n\n            switch (e.localName) {\n              case \"pStyle\":\n                t.styleName = l.default.attr(e, \"val\");\n                break;\n\n              case \"cnfStyle\":\n                t.className = f.classNameOfCnfStyle(e);\n                break;\n\n              case \"framePr\":\n                this.parseFrame(e, t);\n                break;\n\n              case \"rPr\":\n                break;\n\n              default:\n                return !1;\n            }\n\n            return !0;\n          });\n        }\n\n        parseFrame(e, t) {\n          \"drop\" == l.default.attr(e, \"dropCap\") && (t.cssStyle.float = \"left\");\n        }\n\n        parseHyperlink(e, t) {\n          var r = {\n            type: a.DomType.Hyperlink,\n            parent: t,\n            children: []\n          },\n              s = l.default.attr(e, \"anchor\"),\n              n = l.default.attr(e, \"id\");\n          return s && (r.href = \"#\" + s), n && (r.id = n), m.foreach(e, e => {\n            \"r\" === e.localName && r.children.push(this.parseRun(e, r));\n          }), r;\n        }\n\n        parseRun(e, t) {\n          var r = {\n            type: a.DomType.Run,\n            parent: t,\n            children: []\n          };\n          return m.foreach(e, e => {\n            switch ((e = this.checkAlternateContent(e)).localName) {\n              case \"t\":\n                r.children.push({\n                  type: a.DomType.Text,\n                  text: e.textContent\n                });\n                break;\n\n              case \"delText\":\n                r.children.push({\n                  type: a.DomType.DeletedText,\n                  text: e.textContent\n                });\n                break;\n\n              case \"fldSimple\":\n                r.children.push({\n                  type: a.DomType.SimpleField,\n                  instruction: l.default.attr(e, \"instr\"),\n                  lock: l.default.boolAttr(e, \"lock\", !1),\n                  dirty: l.default.boolAttr(e, \"dirty\", !1)\n                });\n                break;\n\n              case \"instrText\":\n                r.fieldRun = !0, r.children.push({\n                  type: a.DomType.Instruction,\n                  text: e.textContent\n                });\n                break;\n\n              case \"fldChar\":\n                r.fieldRun = !0, r.children.push({\n                  type: a.DomType.ComplexField,\n                  charType: l.default.attr(e, \"fldCharType\"),\n                  lock: l.default.boolAttr(e, \"lock\", !1),\n                  dirty: l.default.boolAttr(e, \"dirty\", !1)\n                });\n                break;\n\n              case \"noBreakHyphen\":\n                r.children.push({\n                  type: a.DomType.NoBreakHyphen\n                });\n                break;\n\n              case \"br\":\n                r.children.push({\n                  type: a.DomType.Break,\n                  break: l.default.attr(e, \"type\") || \"textWrapping\"\n                });\n                break;\n\n              case \"lastRenderedPageBreak\":\n                r.children.push({\n                  type: a.DomType.Break,\n                  break: \"lastRenderedPageBreak\"\n                });\n                break;\n\n              case \"sym\":\n                r.children.push({\n                  type: a.DomType.Symbol,\n                  font: l.default.attr(e, \"font\"),\n                  char: l.default.attr(e, \"char\")\n                });\n                break;\n\n              case \"tab\":\n                r.children.push({\n                  type: a.DomType.Tab\n                });\n                break;\n\n              case \"footnoteReference\":\n                r.children.push({\n                  type: a.DomType.FootnoteReference,\n                  id: l.default.attr(e, \"id\")\n                });\n                break;\n\n              case \"endnoteReference\":\n                r.children.push({\n                  type: a.DomType.EndnoteReference,\n                  id: l.default.attr(e, \"id\")\n                });\n                break;\n\n              case \"drawing\":\n                let t = this.parseDrawing(e);\n                t && (r.children = [t]);\n                break;\n\n              case \"pict\":\n                r.children.push(this.parseVmlPicture(e));\n                break;\n\n              case \"rPr\":\n                this.parseRunProperties(e, r);\n            }\n          }), r;\n        }\n\n        parseMathElement(e) {\n          const t = `${e.localName}Pr`,\n                r = {\n            type: d[e.localName],\n            children: []\n          };\n\n          for (const a of l.default.elements(e)) d[a.localName] ? r.children.push(this.parseMathElement(a)) : \"r\" == a.localName ? r.children.push(this.parseRun(a)) : a.localName == t && (r.props = this.parseMathProperies(a));\n\n          return r;\n        }\n\n        parseMathProperies(e) {\n          const t = {};\n\n          for (const r of l.default.elements(e)) switch (r.localName) {\n            case \"chr\":\n              t.char = l.default.attr(r, \"val\");\n              break;\n\n            case \"degHide\":\n              t.hideDegree = l.default.boolAttr(r, \"val\");\n              break;\n\n            case \"begChr\":\n              t.beginChar = l.default.attr(r, \"val\");\n              break;\n\n            case \"endChr\":\n              t.endChar = l.default.attr(r, \"val\");\n          }\n\n          return t;\n        }\n\n        parseRunProperties(e, t) {\n          this.parseDefaultProperties(e, t.cssStyle = {}, null, e => {\n            switch (e.localName) {\n              case \"rStyle\":\n                t.styleName = l.default.attr(e, \"val\");\n                break;\n\n              case \"vertAlign\":\n                t.verticalAlign = f.valueOfVertAlign(e, !0);\n                break;\n\n              default:\n                return !1;\n            }\n\n            return !0;\n          });\n        }\n\n        parseVmlPicture(e) {\n          const t = {\n            type: a.DomType.VmlPicture,\n            children: []\n          };\n\n          for (const r of l.default.elements(e)) {\n            const e = (0, u.parseVmlElement)(r);\n            e && t.children.push(e);\n          }\n\n          return t;\n        }\n\n        checkAlternateContent(e) {\n          var t;\n          if (\"AlternateContent\" != e.localName) return e;\n          var r = l.default.element(e, \"Choice\");\n\n          if (r) {\n            var a = l.default.attr(r, \"Requires\"),\n                s = e.lookupNamespaceURI(a);\n            if (p.includes(s)) return r.firstElementChild;\n          }\n\n          return null === (t = l.default.element(e, \"Fallback\")) || void 0 === t ? void 0 : t.firstElementChild;\n        }\n\n        parseDrawing(e) {\n          for (var t of l.default.elements(e)) switch (t.localName) {\n            case \"inline\":\n            case \"anchor\":\n              return this.parseDrawingWrapper(t);\n          }\n        }\n\n        parseDrawingWrapper(e) {\n          var t,\n              r = {\n            type: a.DomType.Drawing,\n            children: [],\n            cssStyle: {}\n          },\n              s = \"anchor\" == e.localName;\n          let n = null,\n              o = l.default.boolAttr(e, \"simplePos\"),\n              i = {\n            relative: \"page\",\n            align: \"left\",\n            offset: \"0\"\n          },\n              u = {\n            relative: \"page\",\n            align: \"top\",\n            offset: \"0\"\n          };\n\n          for (var p of l.default.elements(e)) switch (p.localName) {\n            case \"simplePos\":\n              o && (i.offset = l.default.lengthAttr(p, \"x\", c.LengthUsage.Emu), u.offset = l.default.lengthAttr(p, \"y\", c.LengthUsage.Emu));\n              break;\n\n            case \"extent\":\n              r.cssStyle.width = l.default.lengthAttr(p, \"cx\", c.LengthUsage.Emu), r.cssStyle.height = l.default.lengthAttr(p, \"cy\", c.LengthUsage.Emu);\n              break;\n\n            case \"positionH\":\n            case \"positionV\":\n              if (!o) {\n                let e = \"positionH\" == p.localName ? i : u;\n                var d = l.default.element(p, \"align\"),\n                    h = l.default.element(p, \"posOffset\");\n                e.relative = null !== (t = l.default.attr(p, \"relativeFrom\")) && void 0 !== t ? t : e.relative, d && (e.align = d.textContent), h && (e.offset = m.sizeValue(h, c.LengthUsage.Emu));\n              }\n\n              break;\n\n            case \"wrapTopAndBottom\":\n              n = \"wrapTopAndBottom\";\n              break;\n\n            case \"wrapNone\":\n              n = \"wrapNone\";\n              break;\n\n            case \"graphic\":\n              var f = this.parseGraphic(p);\n              f && r.children.push(f);\n          }\n\n          return \"wrapTopAndBottom\" == n ? (r.cssStyle.display = \"block\", i.align && (r.cssStyle[\"text-align\"] = i.align, r.cssStyle.width = \"100%\")) : \"wrapNone\" == n ? (r.cssStyle.display = \"block\", r.cssStyle.position = \"relative\", r.cssStyle.width = \"0px\", r.cssStyle.height = \"0px\", i.offset && (r.cssStyle.left = i.offset), u.offset && (r.cssStyle.top = u.offset)) : !s || \"left\" != i.align && \"right\" != i.align || (r.cssStyle.float = i.align), r;\n        }\n\n        parseGraphic(e) {\n          var t = l.default.element(e, \"graphicData\");\n\n          for (let e of l.default.elements(t)) if (\"pic\" === e.localName) return this.parsePicture(e);\n\n          return null;\n        }\n\n        parsePicture(e) {\n          var t = {\n            type: a.DomType.Image,\n            src: \"\",\n            cssStyle: {}\n          },\n              r = l.default.element(e, \"blipFill\"),\n              s = l.default.element(r, \"blip\");\n          t.src = l.default.attr(s, \"embed\");\n          var n = l.default.element(e, \"spPr\"),\n              o = l.default.element(n, \"xfrm\");\n\n          for (var i of (t.cssStyle.position = \"relative\", l.default.elements(o))) switch (i.localName) {\n            case \"ext\":\n              t.cssStyle.width = l.default.lengthAttr(i, \"cx\", c.LengthUsage.Emu), t.cssStyle.height = l.default.lengthAttr(i, \"cy\", c.LengthUsage.Emu);\n              break;\n\n            case \"off\":\n              t.cssStyle.left = l.default.lengthAttr(i, \"x\", c.LengthUsage.Emu), t.cssStyle.top = l.default.lengthAttr(i, \"y\", c.LengthUsage.Emu);\n          }\n\n          return t;\n        }\n\n        parseTable(e) {\n          var t = {\n            type: a.DomType.Table,\n            children: []\n          };\n          return m.foreach(e, e => {\n            switch (e.localName) {\n              case \"tr\":\n                t.children.push(this.parseTableRow(e));\n                break;\n\n              case \"tblGrid\":\n                t.columns = this.parseTableColumns(e);\n                break;\n\n              case \"tblPr\":\n                this.parseTableProperties(e, t);\n            }\n          }), t;\n        }\n\n        parseTableColumns(e) {\n          var t = [];\n          return m.foreach(e, e => {\n            \"gridCol\" === e.localName && t.push({\n              width: l.default.lengthAttr(e, \"w\")\n            });\n          }), t;\n        }\n\n        parseTableProperties(e, t) {\n          switch (t.cssStyle = {}, t.cellStyle = {}, this.parseDefaultProperties(e, t.cssStyle, t.cellStyle, e => {\n            switch (e.localName) {\n              case \"tblStyle\":\n                t.styleName = l.default.attr(e, \"val\");\n                break;\n\n              case \"tblLook\":\n                t.className = f.classNameOftblLook(e);\n                break;\n\n              case \"tblpPr\":\n                this.parseTablePosition(e, t);\n                break;\n\n              case \"tblStyleColBandSize\":\n                t.colBandSize = l.default.intAttr(e, \"val\");\n                break;\n\n              case \"tblStyleRowBandSize\":\n                t.rowBandSize = l.default.intAttr(e, \"val\");\n                break;\n\n              default:\n                return !1;\n            }\n\n            return !0;\n          }), t.cssStyle[\"text-align\"]) {\n            case \"center\":\n              delete t.cssStyle[\"text-align\"], t.cssStyle[\"margin-left\"] = \"auto\", t.cssStyle[\"margin-right\"] = \"auto\";\n              break;\n\n            case \"right\":\n              delete t.cssStyle[\"text-align\"], t.cssStyle[\"margin-left\"] = \"auto\";\n          }\n        }\n\n        parseTablePosition(e, t) {\n          var r = l.default.lengthAttr(e, \"topFromText\"),\n              a = l.default.lengthAttr(e, \"bottomFromText\"),\n              s = l.default.lengthAttr(e, \"rightFromText\"),\n              n = l.default.lengthAttr(e, \"leftFromText\");\n          t.cssStyle.float = \"left\", t.cssStyle[\"margin-bottom\"] = f.addSize(t.cssStyle[\"margin-bottom\"], a), t.cssStyle[\"margin-left\"] = f.addSize(t.cssStyle[\"margin-left\"], n), t.cssStyle[\"margin-right\"] = f.addSize(t.cssStyle[\"margin-right\"], s), t.cssStyle[\"margin-top\"] = f.addSize(t.cssStyle[\"margin-top\"], r);\n        }\n\n        parseTableRow(e) {\n          var t = {\n            type: a.DomType.Row,\n            children: []\n          };\n          return m.foreach(e, e => {\n            switch (e.localName) {\n              case \"tc\":\n                t.children.push(this.parseTableCell(e));\n                break;\n\n              case \"trPr\":\n                this.parseTableRowProperties(e, t);\n            }\n          }), t;\n        }\n\n        parseTableRowProperties(e, t) {\n          t.cssStyle = this.parseDefaultProperties(e, {}, null, e => {\n            switch (e.localName) {\n              case \"cnfStyle\":\n                t.className = f.classNameOfCnfStyle(e);\n                break;\n\n              case \"tblHeader\":\n                t.isHeader = l.default.boolAttr(e, \"val\");\n                break;\n\n              default:\n                return !1;\n            }\n\n            return !0;\n          });\n        }\n\n        parseTableCell(e) {\n          var t = {\n            type: a.DomType.Cell,\n            children: []\n          };\n          return m.foreach(e, e => {\n            switch (e.localName) {\n              case \"tbl\":\n                t.children.push(this.parseTable(e));\n                break;\n\n              case \"p\":\n                t.children.push(this.parseParagraph(e));\n                break;\n\n              case \"tcPr\":\n                this.parseTableCellProperties(e, t);\n            }\n          }), t;\n        }\n\n        parseTableCellProperties(e, t) {\n          t.cssStyle = this.parseDefaultProperties(e, {}, null, e => {\n            var r;\n\n            switch (e.localName) {\n              case \"gridSpan\":\n                t.span = l.default.intAttr(e, \"val\", null);\n                break;\n\n              case \"vMerge\":\n                t.verticalMerge = null !== (r = l.default.attr(e, \"val\")) && void 0 !== r ? r : \"continue\";\n                break;\n\n              case \"cnfStyle\":\n                t.className = f.classNameOfCnfStyle(e);\n                break;\n\n              default:\n                return !1;\n            }\n\n            return !0;\n          });\n        }\n\n        parseDefaultProperties(e, r = null, a = null, s = null) {\n          return r = r || {}, m.foreach(e, n => {\n            if (!(null == s ? void 0 : s(n))) switch (n.localName) {\n              case \"jc\":\n                r[\"text-align\"] = f.valueOfJc(n);\n                break;\n\n              case \"textAlignment\":\n                r[\"vertical-align\"] = f.valueOfTextAlignment(n);\n                break;\n\n              case \"color\":\n                r.color = m.colorAttr(n, \"val\", null, t.autos.color);\n                break;\n\n              case \"sz\":\n                r[\"font-size\"] = r[\"min-height\"] = l.default.lengthAttr(n, \"val\", c.LengthUsage.FontSize);\n                break;\n\n              case \"shd\":\n                r[\"background-color\"] = m.colorAttr(n, \"fill\", null, t.autos.shd);\n                break;\n\n              case \"highlight\":\n                r[\"background-color\"] = m.colorAttr(n, \"val\", null, t.autos.highlight);\n                break;\n\n              case \"vertAlign\":\n                break;\n\n              case \"position\":\n                r.verticalAlign = l.default.lengthAttr(n, \"val\", c.LengthUsage.FontSize);\n                break;\n\n              case \"tcW\":\n                if (this.options.ignoreWidth) break;\n\n              case \"tblW\":\n                r.width = f.valueOfSize(n, \"w\");\n                break;\n\n              case \"trHeight\":\n                this.parseTrHeight(n, r);\n                break;\n\n              case \"strike\":\n                r[\"text-decoration\"] = l.default.boolAttr(n, \"val\", !0) ? \"line-through\" : \"none\";\n                break;\n\n              case \"b\":\n                r[\"font-weight\"] = l.default.boolAttr(n, \"val\", !0) ? \"bold\" : \"normal\";\n                break;\n\n              case \"i\":\n                r[\"font-style\"] = l.default.boolAttr(n, \"val\", !0) ? \"italic\" : \"normal\";\n                break;\n\n              case \"caps\":\n                r[\"text-transform\"] = l.default.boolAttr(n, \"val\", !0) ? \"uppercase\" : \"none\";\n                break;\n\n              case \"smallCaps\":\n                r[\"text-transform\"] = l.default.boolAttr(n, \"val\", !0) ? \"lowercase\" : \"none\";\n                break;\n\n              case \"u\":\n                this.parseUnderline(n, r);\n                break;\n\n              case \"ind\":\n              case \"tblInd\":\n                this.parseIndentation(n, r);\n                break;\n\n              case \"rFonts\":\n                this.parseFont(n, r);\n                break;\n\n              case \"tblBorders\":\n                this.parseBorderProperties(n, a || r);\n                break;\n\n              case \"tblCellSpacing\":\n                r[\"border-spacing\"] = f.valueOfMargin(n), r[\"border-collapse\"] = \"separate\";\n                break;\n\n              case \"pBdr\":\n                this.parseBorderProperties(n, r);\n                break;\n\n              case \"bdr\":\n                r.border = f.valueOfBorder(n);\n                break;\n\n              case \"tcBorders\":\n                this.parseBorderProperties(n, r);\n                break;\n\n              case \"vanish\":\n                l.default.boolAttr(n, \"val\", !0) && (r.display = \"none\");\n                break;\n\n              case \"kern\":\n              case \"noWrap\":\n                break;\n\n              case \"tblCellMar\":\n              case \"tcMar\":\n                this.parseMarginProperties(n, a || r);\n                break;\n\n              case \"tblLayout\":\n                r[\"table-layout\"] = f.valueOfTblLayout(n);\n                break;\n\n              case \"vAlign\":\n                r[\"vertical-align\"] = f.valueOfTextAlignment(n);\n                break;\n\n              case \"spacing\":\n                \"pPr\" == e.localName && this.parseSpacing(n, r);\n                break;\n\n              case \"wordWrap\":\n                l.default.boolAttr(n, \"val\") && (r[\"overflow-wrap\"] = \"break-word\");\n                break;\n\n              case \"bCs\":\n              case \"iCs\":\n              case \"szCs\":\n              case \"tabs\":\n              case \"outlineLvl\":\n              case \"contextualSpacing\":\n              case \"tblStyleColBandSize\":\n              case \"tblStyleRowBandSize\":\n              case \"webHidden\":\n              case \"pageBreakBefore\":\n              case \"suppressLineNumbers\":\n              case \"keepLines\":\n              case \"keepNext\":\n              case \"lang\":\n              case \"widowControl\":\n              case \"bidi\":\n              case \"rtl\":\n              case \"noProof\":\n                break;\n\n              default:\n                this.options.debug && console.warn(`DOCX: Unknown document element: ${e.localName}.${n.localName}`);\n            }\n          }), r;\n        }\n\n        parseUnderline(e, t) {\n          var r = l.default.attr(e, \"val\");\n\n          if (null != r) {\n            switch (r) {\n              case \"dash\":\n              case \"dashDotDotHeavy\":\n              case \"dashDotHeavy\":\n              case \"dashedHeavy\":\n              case \"dashLong\":\n              case \"dashLongHeavy\":\n              case \"dotDash\":\n              case \"dotDotDash\":\n                t[\"text-decoration-style\"] = \"dashed\";\n                break;\n\n              case \"dotted\":\n              case \"dottedHeavy\":\n                t[\"text-decoration-style\"] = \"dotted\";\n                break;\n\n              case \"double\":\n                t[\"text-decoration-style\"] = \"double\";\n                break;\n\n              case \"single\":\n              case \"thick\":\n              case \"words\":\n                t[\"text-decoration\"] = \"underline\";\n                break;\n\n              case \"wave\":\n              case \"wavyDouble\":\n              case \"wavyHeavy\":\n                t[\"text-decoration-style\"] = \"wavy\";\n                break;\n\n              case \"none\":\n                t[\"text-decoration\"] = \"none\";\n            }\n\n            var a = m.colorAttr(e, \"color\");\n            a && (t[\"text-decoration-color\"] = a);\n          }\n        }\n\n        parseFont(e, t) {\n          var r = [l.default.attr(e, \"ascii\"), f.themeValue(e, \"asciiTheme\")].filter(e => e).join(\", \");\n          r.length > 0 && (t[\"font-family\"] = r);\n        }\n\n        parseIndentation(e, t) {\n          var r = l.default.lengthAttr(e, \"firstLine\"),\n              a = l.default.lengthAttr(e, \"hanging\"),\n              s = l.default.lengthAttr(e, \"left\"),\n              n = l.default.lengthAttr(e, \"start\"),\n              o = l.default.lengthAttr(e, \"right\"),\n              i = l.default.lengthAttr(e, \"end\");\n          r && (t[\"text-indent\"] = r), a && (t[\"text-indent\"] = `-${a}`), (s || n) && (t[\"margin-left\"] = s || n), (o || i) && (t[\"margin-right\"] = o || i);\n        }\n\n        parseSpacing(e, t) {\n          var r = l.default.lengthAttr(e, \"before\"),\n              a = l.default.lengthAttr(e, \"after\"),\n              s = l.default.intAttr(e, \"line\", null),\n              n = l.default.attr(e, \"lineRule\");\n          if (r && (t[\"margin-top\"] = r), a && (t[\"margin-bottom\"] = a), null !== s) switch (n) {\n            case \"auto\":\n              t[\"line-height\"] = `${(s / 240).toFixed(2)}`;\n              break;\n\n            case \"atLeast\":\n              t[\"line-height\"] = `calc(100% + ${s / 20}pt)`;\n              break;\n\n            default:\n              t[\"line-height\"] = t[\"min-height\"] = s / 20 + \"pt\";\n          }\n        }\n\n        parseMarginProperties(e, t) {\n          m.foreach(e, e => {\n            switch (e.localName) {\n              case \"left\":\n                t[\"padding-left\"] = f.valueOfMargin(e);\n                break;\n\n              case \"right\":\n                t[\"padding-right\"] = f.valueOfMargin(e);\n                break;\n\n              case \"top\":\n                t[\"padding-top\"] = f.valueOfMargin(e);\n                break;\n\n              case \"bottom\":\n                t[\"padding-bottom\"] = f.valueOfMargin(e);\n            }\n          });\n        }\n\n        parseTrHeight(e, t) {\n          l.default.attr(e, \"hRule\"), t.height = l.default.lengthAttr(e, \"val\");\n        }\n\n        parseBorderProperties(e, t) {\n          m.foreach(e, e => {\n            switch (e.localName) {\n              case \"start\":\n              case \"left\":\n                t[\"border-left\"] = f.valueOfBorder(e);\n                break;\n\n              case \"end\":\n              case \"right\":\n                t[\"border-right\"] = f.valueOfBorder(e);\n                break;\n\n              case \"top\":\n                t[\"border-top\"] = f.valueOfBorder(e);\n                break;\n\n              case \"bottom\":\n                t[\"border-bottom\"] = f.valueOfBorder(e);\n            }\n          });\n        }\n\n      };\n      const h = [\"black\", \"blue\", \"cyan\", \"darkBlue\", \"darkCyan\", \"darkGray\", \"darkGreen\", \"darkMagenta\", \"darkRed\", \"darkYellow\", \"green\", \"lightGray\", \"magenta\", \"none\", \"red\", \"white\", \"yellow\"];\n\n      class m {\n        static foreach(e, t) {\n          for (var r = 0; r < e.childNodes.length; r++) {\n            let a = e.childNodes[r];\n            a.nodeType == Node.ELEMENT_NODE && t(a);\n          }\n        }\n\n        static colorAttr(e, t, r = null, a = \"black\") {\n          var s = l.default.attr(e, t);\n          if (s) return \"auto\" == s ? a : h.includes(s) ? s : `#${s}`;\n          var n = l.default.attr(e, \"themeColor\");\n          return n ? `var(--docx-${n}-color)` : r;\n        }\n\n        static sizeValue(e, t = c.LengthUsage.Dxa) {\n          return (0, c.convertLength)(e.textContent, t);\n        }\n\n      }\n\n      class f {\n        static themeValue(e, t) {\n          var r = l.default.attr(e, t);\n          return r ? `var(--docx-${r}-font)` : null;\n        }\n\n        static valueOfSize(e, t) {\n          var r = c.LengthUsage.Dxa;\n\n          switch (l.default.attr(e, \"type\")) {\n            case \"dxa\":\n              break;\n\n            case \"pct\":\n              r = c.LengthUsage.Percent;\n              break;\n\n            case \"auto\":\n              return \"auto\";\n          }\n\n          return l.default.lengthAttr(e, t, r);\n        }\n\n        static valueOfMargin(e) {\n          return l.default.lengthAttr(e, \"w\");\n        }\n\n        static valueOfBorder(e) {\n          if (\"nil\" == l.default.attr(e, \"val\")) return \"none\";\n          var r = m.colorAttr(e, \"color\");\n          return `${l.default.lengthAttr(e, \"sz\", c.LengthUsage.Border)} solid ${\"auto\" == r ? t.autos.borderColor : r}`;\n        }\n\n        static valueOfTblLayout(e) {\n          return \"fixed\" == l.default.attr(e, \"val\") ? \"fixed\" : \"auto\";\n        }\n\n        static classNameOfCnfStyle(e) {\n          const t = l.default.attr(e, \"val\");\n          return [\"first-row\", \"last-row\", \"first-col\", \"last-col\", \"odd-col\", \"even-col\", \"odd-row\", \"even-row\", \"ne-cell\", \"nw-cell\", \"se-cell\", \"sw-cell\"].filter((e, r) => \"1\" == t[r]).join(\" \");\n        }\n\n        static valueOfJc(e) {\n          var t = l.default.attr(e, \"val\");\n\n          switch (t) {\n            case \"start\":\n            case \"left\":\n              return \"left\";\n\n            case \"center\":\n              return \"center\";\n\n            case \"end\":\n            case \"right\":\n              return \"right\";\n\n            case \"both\":\n              return \"justify\";\n          }\n\n          return t;\n        }\n\n        static valueOfVertAlign(e, t = !1) {\n          var r = l.default.attr(e, \"val\");\n\n          switch (r) {\n            case \"subscript\":\n              return \"sub\";\n\n            case \"superscript\":\n              return t ? \"sup\" : \"super\";\n          }\n\n          return t ? null : r;\n        }\n\n        static valueOfTextAlignment(e) {\n          var t = l.default.attr(e, \"val\");\n\n          switch (t) {\n            case \"auto\":\n            case \"baseline\":\n              return \"baseline\";\n\n            case \"top\":\n              return \"top\";\n\n            case \"center\":\n              return \"middle\";\n\n            case \"bottom\":\n              return \"bottom\";\n          }\n\n          return t;\n        }\n\n        static addSize(e, t) {\n          return null == e ? t : null == t ? e : `calc(${e} + ${t})`;\n        }\n\n        static classNameOftblLook(e) {\n          const t = l.default.hexAttr(e, \"val\", 0);\n          let r = \"\";\n          return (l.default.boolAttr(e, \"firstRow\") || 32 & t) && (r += \" first-row\"), (l.default.boolAttr(e, \"lastRow\") || 64 & t) && (r += \" last-row\"), (l.default.boolAttr(e, \"firstColumn\") || 128 & t) && (r += \" first-col\"), (l.default.boolAttr(e, \"lastColumn\") || 256 & t) && (r += \" last-col\"), (l.default.boolAttr(e, \"noHBand\") || 512 & t) && (r += \" no-hband\"), (l.default.boolAttr(e, \"noVBand\") || 1024 & t) && (r += \" no-vband\"), r.trim();\n        }\n\n      }\n    },\n    162: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.CorePropsPart = void 0;\n      const a = r(530),\n            s = r(614);\n\n      class n extends a.Part {\n        parseXml(e) {\n          this.props = (0, s.parseCoreProps)(e, this._package.xmlParser);\n        }\n\n      }\n\n      t.CorePropsPart = n;\n    },\n    614: (e, t) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseCoreProps = void 0, t.parseCoreProps = function (e, t) {\n        const r = {};\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"title\":\n            r.title = a.textContent;\n            break;\n\n          case \"description\":\n            r.description = a.textContent;\n            break;\n\n          case \"subject\":\n            r.subject = a.textContent;\n            break;\n\n          case \"creator\":\n            r.creator = a.textContent;\n            break;\n\n          case \"keywords\":\n            r.keywords = a.textContent;\n            break;\n\n          case \"language\":\n            r.language = a.textContent;\n            break;\n\n          case \"lastModifiedBy\":\n            r.lastModifiedBy = a.textContent;\n            break;\n\n          case \"revision\":\n            a.textContent && (r.revision = parseInt(a.textContent));\n        }\n\n        return r;\n      };\n    },\n    177: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.CustomPropsPart = void 0;\n      const a = r(530),\n            s = r(821);\n\n      class n extends a.Part {\n        parseXml(e) {\n          this.props = (0, s.parseCustomProps)(e, this._package.xmlParser);\n        }\n\n      }\n\n      t.CustomPropsPart = n;\n    },\n    821: (e, t) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseCustomProps = void 0, t.parseCustomProps = function (e, t) {\n        return t.elements(e, \"property\").map(e => {\n          const r = e.firstChild;\n          return {\n            formatId: t.attr(e, \"fmtid\"),\n            name: t.attr(e, \"name\"),\n            type: r.nodeName,\n            value: r.textContent\n          };\n        });\n      };\n    },\n    665: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.ExtendedPropsPart = void 0;\n      const a = r(530),\n            s = r(668);\n\n      class n extends a.Part {\n        parseXml(e) {\n          this.props = (0, s.parseExtendedProps)(e, this._package.xmlParser);\n        }\n\n      }\n\n      t.ExtendedPropsPart = n;\n    },\n    668: (e, t) => {\n      function r(e) {\n        if (void 0 !== e) return parseInt(e);\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseExtendedProps = void 0, t.parseExtendedProps = function (e, t) {\n        const a = {};\n\n        for (let s of t.elements(e)) switch (s.localName) {\n          case \"Template\":\n            a.template = s.textContent;\n            break;\n\n          case \"Pages\":\n            a.pages = r(s.textContent);\n            break;\n\n          case \"Words\":\n            a.words = r(s.textContent);\n            break;\n\n          case \"Characters\":\n            a.characters = r(s.textContent);\n            break;\n\n          case \"Application\":\n            a.application = s.textContent;\n            break;\n\n          case \"Lines\":\n            a.lines = r(s.textContent);\n            break;\n\n          case \"Paragraphs\":\n            a.paragraphs = r(s.textContent);\n            break;\n\n          case \"Company\":\n            a.company = s.textContent;\n            break;\n\n          case \"AppVersion\":\n            a.appVersion = s.textContent;\n        }\n\n        return a;\n      };\n    },\n    172: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseBookmarkEnd = t.parseBookmarkStart = void 0;\n      const a = r(120);\n      t.parseBookmarkStart = function (e, t) {\n        return {\n          type: a.DomType.BookmarkStart,\n          id: t.attr(e, \"id\"),\n          name: t.attr(e, \"name\"),\n          colFirst: t.intAttr(e, \"colFirst\"),\n          colLast: t.intAttr(e, \"colLast\")\n        };\n      }, t.parseBookmarkEnd = function (e, t) {\n        return {\n          type: a.DomType.BookmarkEnd,\n          id: t.attr(e, \"id\")\n        };\n      };\n    },\n    191: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseBorders = t.parseBorder = void 0;\n      const a = r(149);\n\n      function s(e, t) {\n        return {\n          type: t.attr(e, \"val\"),\n          color: t.attr(e, \"color\"),\n          size: t.lengthAttr(e, \"sz\", a.LengthUsage.Border),\n          offset: t.lengthAttr(e, \"space\", a.LengthUsage.Point),\n          frame: t.boolAttr(e, \"frame\"),\n          shadow: t.boolAttr(e, \"shadow\")\n        };\n      }\n\n      t.parseBorder = s, t.parseBorders = function (e, t) {\n        var r = {};\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"left\":\n            r.left = s(a, t);\n            break;\n\n          case \"top\":\n            r.top = s(a, t);\n            break;\n\n          case \"right\":\n            r.right = s(a, t);\n            break;\n\n          case \"bottom\":\n            r.bottom = s(a, t);\n        }\n\n        return r;\n      };\n    },\n    149: (e, t) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseCommonProperty = t.convertPercentage = t.convertBoolean = t.convertLength = t.LengthUsage = t.ns = void 0, t.ns = {\n        wordml: \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\",\n        drawingml: \"http://schemas.openxmlformats.org/drawingml/2006/main\",\n        picture: \"http://schemas.openxmlformats.org/drawingml/2006/picture\",\n        compatibility: \"http://schemas.openxmlformats.org/markup-compatibility/2006\",\n        math: \"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n      }, t.LengthUsage = {\n        Dxa: {\n          mul: .05,\n          unit: \"pt\"\n        },\n        Emu: {\n          mul: 1 / 12700,\n          unit: \"pt\"\n        },\n        FontSize: {\n          mul: .5,\n          unit: \"pt\"\n        },\n        Border: {\n          mul: .125,\n          unit: \"pt\"\n        },\n        Point: {\n          mul: 1,\n          unit: \"pt\"\n        },\n        Percent: {\n          mul: .02,\n          unit: \"%\"\n        },\n        LineHeight: {\n          mul: 1 / 240,\n          unit: \"\"\n        },\n        VmlEmu: {\n          mul: 1 / 12700,\n          unit: \"\"\n        }\n      }, t.convertLength = function (e, r = t.LengthUsage.Dxa) {\n        return null == e || /.+(p[xt]|[%])$/.test(e) ? e : `${(parseInt(e) * r.mul).toFixed(2)}${r.unit}`;\n      }, t.convertBoolean = function (e, t = !1) {\n        switch (e) {\n          case \"1\":\n          case \"on\":\n          case \"true\":\n            return !0;\n\n          case \"0\":\n          case \"off\":\n          case \"false\":\n            return !1;\n\n          default:\n            return t;\n        }\n      }, t.convertPercentage = function (e) {\n        return e ? parseInt(e) / 100 : null;\n      }, t.parseCommonProperty = function (e, r, a) {\n        if (e.namespaceURI != t.ns.wordml) return !1;\n\n        switch (e.localName) {\n          case \"color\":\n            r.color = a.attr(e, \"val\");\n            break;\n\n          case \"sz\":\n            r.fontSize = a.lengthAttr(e, \"val\", t.LengthUsage.FontSize);\n            break;\n\n          default:\n            return !1;\n        }\n\n        return !0;\n      };\n    },\n    448: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.DocumentPart = void 0;\n      const a = r(530);\n\n      class s extends a.Part {\n        constructor(e, t, r) {\n          super(e, t), this._documentParser = r;\n        }\n\n        parseXml(e) {\n          this.body = this._documentParser.parseDocumentFile(e);\n        }\n\n      }\n\n      t.DocumentPart = s;\n    },\n    120: (e, t) => {\n      var r;\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.DomType = void 0, (r = t.DomType || (t.DomType = {})).Document = \"document\", r.Paragraph = \"paragraph\", r.Run = \"run\", r.Break = \"break\", r.NoBreakHyphen = \"noBreakHyphen\", r.Table = \"table\", r.Row = \"row\", r.Cell = \"cell\", r.Hyperlink = \"hyperlink\", r.Drawing = \"drawing\", r.Image = \"image\", r.Text = \"text\", r.Tab = \"tab\", r.Symbol = \"symbol\", r.BookmarkStart = \"bookmarkStart\", r.BookmarkEnd = \"bookmarkEnd\", r.Footer = \"footer\", r.Header = \"header\", r.FootnoteReference = \"footnoteReference\", r.EndnoteReference = \"endnoteReference\", r.Footnote = \"footnote\", r.Endnote = \"endnote\", r.SimpleField = \"simpleField\", r.ComplexField = \"complexField\", r.Instruction = \"instruction\", r.VmlPicture = \"vmlPicture\", r.MmlMath = \"mmlMath\", r.MmlMathParagraph = \"mmlMathParagraph\", r.MmlFraction = \"mmlFraction\", r.MmlNumerator = \"mmlNumerator\", r.MmlDenominator = \"mmlDenominator\", r.MmlRadical = \"mmlRadical\", r.MmlBase = \"mmlBase\", r.MmlDegree = \"mmlDegree\", r.MmlSuperscript = \"mmlSuperscript\", r.MmlSubscript = \"mmlSubscript\", r.MmlSubArgument = \"mmlSubArgument\", r.MmlSuperArgument = \"mmlSuperArgument\", r.MmlNary = \"mmlNary\", r.MmlDelimiter = \"mmlDelimiter\", r.VmlElement = \"vmlElement\", r.Inserted = \"inserted\", r.Deleted = \"deleted\", r.DeletedText = \"deletedText\";\n    },\n    931: (e, t) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseLineSpacing = void 0, t.parseLineSpacing = function (e, t) {\n        return {\n          before: t.lengthAttr(e, \"before\"),\n          after: t.lengthAttr(e, \"after\"),\n          line: t.intAttr(e, \"line\"),\n          lineRule: t.attr(e, \"lineRule\")\n        };\n      };\n    },\n    109: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseNumbering = t.parseTabs = t.parseParagraphProperty = t.parseParagraphProperties = void 0;\n      const a = r(149),\n            s = r(59),\n            n = r(931),\n            l = r(488);\n\n      function o(e, t, r) {\n        if (e.namespaceURI != a.ns.wordml) return !1;\n        if ((0, a.parseCommonProperty)(e, t, r)) return !0;\n\n        switch (e.localName) {\n          case \"tabs\":\n            t.tabs = i(e, r);\n            break;\n\n          case \"sectPr\":\n            t.sectionProps = (0, s.parseSectionProperties)(e, r);\n            break;\n\n          case \"numPr\":\n            t.numbering = c(e, r);\n            break;\n\n          case \"spacing\":\n            return t.lineSpacing = (0, n.parseLineSpacing)(e, r), !1;\n\n          case \"textAlignment\":\n            return t.textAlignment = r.attr(e, \"val\"), !1;\n\n          case \"keepNext\":\n            t.keepLines = r.boolAttr(e, \"val\", !0);\n            break;\n\n          case \"keepNext\":\n            t.keepNext = r.boolAttr(e, \"val\", !0);\n            break;\n\n          case \"pageBreakBefore\":\n            t.pageBreakBefore = r.boolAttr(e, \"val\", !0);\n            break;\n\n          case \"outlineLvl\":\n            t.outlineLevel = r.intAttr(e, \"val\");\n            break;\n\n          case \"pStyle\":\n            t.styleName = r.attr(e, \"val\");\n            break;\n\n          case \"rPr\":\n            t.runProps = (0, l.parseRunProperties)(e, r);\n            break;\n\n          default:\n            return !1;\n        }\n\n        return !0;\n      }\n\n      function i(e, t) {\n        return t.elements(e, \"tab\").map(e => ({\n          position: t.lengthAttr(e, \"pos\"),\n          leader: t.attr(e, \"leader\"),\n          style: t.attr(e, \"val\")\n        }));\n      }\n\n      function c(e, t) {\n        var r = {};\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"numId\":\n            r.id = t.attr(a, \"val\");\n            break;\n\n          case \"ilvl\":\n            r.level = t.intAttr(a, \"val\");\n        }\n\n        return r;\n      }\n\n      t.parseParagraphProperties = function (e, t) {\n        let r = {};\n\n        for (let a of t.elements(e)) o(a, r, t);\n\n        return r;\n      }, t.parseParagraphProperty = o, t.parseTabs = i, t.parseNumbering = c;\n    },\n    488: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseRunProperty = t.parseRunProperties = void 0;\n      const a = r(149);\n\n      function s(e, t, r) {\n        return !!(0, a.parseCommonProperty)(e, t, r);\n      }\n\n      t.parseRunProperties = function (e, t) {\n        let r = {};\n\n        for (let a of t.elements(e)) s(a, r, t);\n\n        return r;\n      }, t.parseRunProperty = s;\n    },\n    59: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseSectionProperties = t.SectionType = void 0;\n      const a = r(472),\n            s = r(191);\n\n      function n(e, t) {\n        return {\n          numberOfColumns: t.intAttr(e, \"num\"),\n          space: t.lengthAttr(e, \"space\"),\n          separator: t.boolAttr(e, \"sep\"),\n          equalWidth: t.boolAttr(e, \"equalWidth\", !0),\n          columns: t.elements(e, \"col\").map(e => ({\n            width: t.lengthAttr(e, \"w\"),\n            space: t.lengthAttr(e, \"space\")\n          }))\n        };\n      }\n\n      function l(e, t) {\n        return {\n          chapSep: t.attr(e, \"chapSep\"),\n          chapStyle: t.attr(e, \"chapStyle\"),\n          format: t.attr(e, \"fmt\"),\n          start: t.intAttr(e, \"start\")\n        };\n      }\n\n      function o(e, t) {\n        return {\n          id: t.attr(e, \"id\"),\n          type: t.attr(e, \"type\")\n        };\n      }\n\n      var i;\n      (i = t.SectionType || (t.SectionType = {})).Continuous = \"continuous\", i.NextPage = \"nextPage\", i.NextColumn = \"nextColumn\", i.EvenPage = \"evenPage\", i.OddPage = \"oddPage\", t.parseSectionProperties = function (e, t = a.default) {\n        var r,\n            i,\n            c = {};\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"pgSz\":\n            c.pageSize = {\n              width: t.lengthAttr(a, \"w\"),\n              height: t.lengthAttr(a, \"h\"),\n              orientation: t.attr(a, \"orient\")\n            };\n            break;\n\n          case \"type\":\n            c.type = t.attr(a, \"val\");\n            break;\n\n          case \"pgMar\":\n            c.pageMargins = {\n              left: t.lengthAttr(a, \"left\"),\n              right: t.lengthAttr(a, \"right\"),\n              top: t.lengthAttr(a, \"top\"),\n              bottom: t.lengthAttr(a, \"bottom\"),\n              header: t.lengthAttr(a, \"header\"),\n              footer: t.lengthAttr(a, \"footer\"),\n              gutter: t.lengthAttr(a, \"gutter\")\n            };\n            break;\n\n          case \"cols\":\n            c.columns = n(a, t);\n            break;\n\n          case \"headerReference\":\n            (null !== (r = c.headerRefs) && void 0 !== r ? r : c.headerRefs = []).push(o(a, t));\n            break;\n\n          case \"footerReference\":\n            (null !== (i = c.footerRefs) && void 0 !== i ? i : c.footerRefs = []).push(o(a, t));\n            break;\n\n          case \"titlePg\":\n            c.titlePage = t.boolAttr(a, \"val\", !0);\n            break;\n\n          case \"pgBorders\":\n            c.pageBorders = (0, s.parseBorders)(a, t);\n            break;\n\n          case \"pgNumType\":\n            c.pageNumber = l(a, t);\n        }\n\n        return c;\n      };\n    },\n    667: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.renderAsync = t.praseAsync = t.defaultOptions = void 0;\n      const a = r(213),\n            s = r(168),\n            n = r(932);\n      t.defaultOptions = {\n        ignoreHeight: !1,\n        ignoreWidth: !1,\n        ignoreFonts: !1,\n        breakPages: !0,\n        debug: !1,\n        experimental: !1,\n        className: \"docx\",\n        inWrapper: !0,\n        trimXmlDeclaration: !0,\n        ignoreLastRenderedPageBreak: !0,\n        renderHeaders: !0,\n        renderFooters: !0,\n        renderFootnotes: !0,\n        renderEndnotes: !0,\n        useBase64URL: !1,\n        useMathMLPolyfill: !1,\n        renderChanges: !1\n      }, t.praseAsync = function (e, r = null) {\n        const n = Object.assign(Object.assign({}, t.defaultOptions), r);\n        return a.WordDocument.load(e, new s.DocumentParser(n), n);\n      }, t.renderAsync = function (e, r, l = null, o = null) {\n        const i = Object.assign(Object.assign({}, t.defaultOptions), o),\n              c = new n.HtmlRenderer(window.document);\n        return a.WordDocument.load(e, new s.DocumentParser(i), i).then(e => (c.render(e, r, l, i), e));\n      };\n    },\n    380: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.FontTablePart = void 0;\n      const a = r(530),\n            s = r(512);\n\n      class n extends a.Part {\n        parseXml(e) {\n          this.fonts = (0, s.parseFonts)(e, this._package.xmlParser);\n        }\n\n      }\n\n      t.FontTablePart = n;\n    },\n    512: (e, t) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseEmbedFontRef = t.parseFont = t.parseFonts = void 0;\n      const r = {\n        embedRegular: \"regular\",\n        embedBold: \"bold\",\n        embedItalic: \"italic\",\n        embedBoldItalic: \"boldItalic\"\n      };\n\n      function a(e, t) {\n        let r = {\n          name: t.attr(e, \"name\"),\n          embedFontRefs: []\n        };\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"family\":\n            r.family = t.attr(a, \"val\");\n            break;\n\n          case \"altName\":\n            r.altName = t.attr(a, \"val\");\n            break;\n\n          case \"embedRegular\":\n          case \"embedBold\":\n          case \"embedItalic\":\n          case \"embedBoldItalic\":\n            r.embedFontRefs.push(s(a, t));\n        }\n\n        return r;\n      }\n\n      function s(e, t) {\n        return {\n          id: t.attr(e, \"id\"),\n          key: t.attr(e, \"fontKey\"),\n          type: r[e.localName]\n        };\n      }\n\n      t.parseFonts = function (e, t) {\n        return t.elements(e).map(e => a(e, t));\n      }, t.parseFont = a, t.parseEmbedFontRef = s;\n    },\n    984: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.WmlFooter = t.WmlHeader = void 0;\n      const a = r(120);\n      t.WmlHeader = class {\n        constructor() {\n          this.type = a.DomType.Header, this.children = [], this.cssStyle = {};\n        }\n\n      }, t.WmlFooter = class {\n        constructor() {\n          this.type = a.DomType.Footer, this.children = [], this.cssStyle = {};\n        }\n\n      };\n    },\n    985: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.FooterPart = t.HeaderPart = t.BaseHeaderFooterPart = void 0;\n      const a = r(530),\n            s = r(984);\n\n      class n extends a.Part {\n        constructor(e, t, r) {\n          super(e, t), this._documentParser = r;\n        }\n\n        parseXml(e) {\n          this.rootElement = this.createRootElement(), this.rootElement.children = this._documentParser.parseBodyElements(e);\n        }\n\n      }\n\n      t.BaseHeaderFooterPart = n, t.HeaderPart = class extends n {\n        createRootElement() {\n          return new s.WmlHeader();\n        }\n\n      }, t.FooterPart = class extends n {\n        createRootElement() {\n          return new s.WmlFooter();\n        }\n\n      };\n    },\n    932: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.HtmlRenderer = void 0;\n      const a = r(120),\n            s = r(593),\n            n = r(630),\n            l = r(438),\n            o = \"http://www.w3.org/1998/Math/MathML\";\n\n      function i(e, t, r) {\n        return u(void 0, e, t, r);\n      }\n\n      function c(e, t, r) {\n        return u(\"http://www.w3.org/2000/svg\", e, t, r);\n      }\n\n      function u(e, t, r, a) {\n        var s = e ? document.createElementNS(e, t) : document.createElement(t);\n        return Object.assign(s, r), a && d(s, a), s;\n      }\n\n      function p(e) {\n        e.innerHTML = \"\";\n      }\n\n      function d(e, t) {\n        t.forEach(t => e.appendChild((0, s.isString)(t) ? document.createTextNode(t) : t));\n      }\n\n      function h(e) {\n        return i(\"style\", {\n          innerHTML: e\n        });\n      }\n\n      function m(e, t) {\n        e.appendChild(document.createComment(t));\n      }\n\n      t.HtmlRenderer = class {\n        constructor(e) {\n          this.htmlDocument = e, this.className = \"docx\", this.styleMap = {}, this.currentPart = null, this.tableVerticalMerges = [], this.currentVerticalMerge = null, this.tableCellPositions = [], this.currentCellPosition = null, this.footnoteMap = {}, this.endnoteMap = {}, this.currentEndnoteIds = [], this.usedHederFooterParts = [], this.currentTabs = [], this.tabsTimeout = 0, this.createElement = i;\n        }\n\n        render(e, t, r = null, a) {\n          var n;\n          this.document = e, this.options = a, this.className = a.className, this.rootSelector = a.inWrapper ? `.${this.className}-wrapper` : \":root\", this.styleMap = null, p(r = r || t), p(t), m(r, \"docxjs library predefined styles\"), r.appendChild(this.renderDefaultStyle()), !window.MathMLElement && a.useMathMLPolyfill && (m(r, \"docxjs mathml polyfill styles\"), r.appendChild(h(l.default))), e.themePart && (m(r, \"docxjs document theme values\"), this.renderTheme(e.themePart, r)), null != e.stylesPart && (this.styleMap = this.processStyles(e.stylesPart.styles), m(r, \"docxjs document styles\"), r.appendChild(this.renderStyles(e.stylesPart.styles))), e.numberingPart && (this.prodessNumberings(e.numberingPart.domNumberings), m(r, \"docxjs document numbering styles\"), r.appendChild(this.renderNumbering(e.numberingPart.domNumberings, r))), e.footnotesPart && (this.footnoteMap = (0, s.keyBy)(e.footnotesPart.notes, e => e.id)), e.endnotesPart && (this.endnoteMap = (0, s.keyBy)(e.endnotesPart.notes, e => e.id)), e.settingsPart && (this.defaultTabSize = null === (n = e.settingsPart.settings) || void 0 === n ? void 0 : n.defaultTabStop), !a.ignoreFonts && e.fontTablePart && this.renderFontTable(e.fontTablePart, r);\n          var o = this.renderSections(e.documentPart.body);\n          this.options.inWrapper ? t.appendChild(this.renderWrapper(o)) : d(t, o), this.refreshTabStops();\n        }\n\n        renderTheme(e, t) {\n          var r, a;\n          const s = {},\n                n = null === (r = e.theme) || void 0 === r ? void 0 : r.fontScheme;\n          n && (n.majorFont && (s[\"--docx-majorHAnsi-font\"] = n.majorFont.latinTypeface), n.minorFont && (s[\"--docx-minorHAnsi-font\"] = n.minorFont.latinTypeface));\n          const l = null === (a = e.theme) || void 0 === a ? void 0 : a.colorScheme;\n          if (l) for (let [e, t] of Object.entries(l.colors)) s[`--docx-${e}-color`] = `#${t}`;\n          const o = this.styleToString(`.${this.className}`, s);\n          t.appendChild(h(o));\n        }\n\n        renderFontTable(e, t) {\n          for (let r of e.fonts) for (let e of r.embedFontRefs) this.document.loadFont(e.id, e.key).then(a => {\n            const s = {\n              \"font-family\": r.name,\n              src: `url(${a})`\n            };\n            \"bold\" != e.type && \"boldItalic\" != e.type || (s[\"font-weight\"] = \"bold\"), \"italic\" != e.type && \"boldItalic\" != e.type || (s[\"font-style\"] = \"italic\"), m(t, `docxjs ${r.name} font`);\n            const n = this.styleToString(\"@font-face\", s);\n            t.appendChild(h(n)), this.refreshTabStops();\n          });\n        }\n\n        processStyleName(e) {\n          return e ? `${this.className}_${(0, s.escapeClassName)(e)}` : this.className;\n        }\n\n        processStyles(e) {\n          const t = (0, s.keyBy)(e.filter(e => null != e.id), e => e.id);\n\n          for (const a of e.filter(e => e.basedOn)) {\n            var r = t[a.basedOn];\n\n            if (r) {\n              a.paragraphProps = (0, s.mergeDeep)(a.paragraphProps, r.paragraphProps), a.runProps = (0, s.mergeDeep)(a.runProps, r.runProps);\n\n              for (const e of r.styles) {\n                const t = a.styles.find(t => t.target == e.target);\n                t ? this.copyStyleProperties(e.values, t.values) : a.styles.push(Object.assign(Object.assign({}, e), {\n                  values: Object.assign({}, e.values)\n                }));\n              }\n            } else this.options.debug && console.warn(`Can't find base style ${a.basedOn}`);\n          }\n\n          for (let t of e) t.cssName = this.processStyleName(t.id);\n\n          return t;\n        }\n\n        prodessNumberings(e) {\n          var t;\n\n          for (let r of e.filter(e => e.pStyleName)) {\n            const e = this.findStyle(r.pStyleName);\n            (null === (t = null == e ? void 0 : e.paragraphProps) || void 0 === t ? void 0 : t.numbering) && (e.paragraphProps.numbering.level = r.level);\n          }\n        }\n\n        processElement(e) {\n          if (e.children) for (var t of e.children) t.parent = e, t.type == a.DomType.Table ? this.processTable(t) : this.processElement(t);\n        }\n\n        processTable(e) {\n          for (var t of e.children) for (var r of t.children) r.cssStyle = this.copyStyleProperties(e.cellStyle, r.cssStyle, [\"border-left\", \"border-right\", \"border-top\", \"border-bottom\", \"padding-left\", \"padding-right\", \"padding-top\", \"padding-bottom\"]), this.processElement(r);\n        }\n\n        copyStyleProperties(e, t, r = null) {\n          if (!e) return t;\n\n          for (var a of (null == t && (t = {}), null == r && (r = Object.getOwnPropertyNames(e)), r)) e.hasOwnProperty(a) && !t.hasOwnProperty(a) && (t[a] = e[a]);\n\n          return t;\n        }\n\n        createSection(e, t) {\n          var r = this.createElement(\"section\", {\n            className: e\n          });\n          return t && (t.pageMargins && (r.style.paddingLeft = t.pageMargins.left, r.style.paddingRight = t.pageMargins.right, r.style.paddingTop = t.pageMargins.top, r.style.paddingBottom = t.pageMargins.bottom), t.pageSize && (this.options.ignoreWidth || (r.style.width = t.pageSize.width), this.options.ignoreHeight || (r.style.minHeight = t.pageSize.height)), t.columns && t.columns.numberOfColumns && (r.style.columnCount = `${t.columns.numberOfColumns}`, r.style.columnGap = t.columns.space, t.columns.separator && (r.style.columnRule = \"1px solid black\"))), r;\n        }\n\n        renderSections(e) {\n          const t = [];\n          this.processElement(e);\n          const r = this.splitBySection(e.children);\n          let a = null;\n\n          for (let n = 0, l = r.length; n < l; n++) {\n            this.currentFootnoteIds = [];\n            const o = r[n],\n                  i = o.sectProps || e.props,\n                  c = this.createSection(this.className, i);\n            this.renderStyleValues(e.cssStyle, c), this.options.renderHeaders && this.renderHeaderFooter(i.headerRefs, i, t.length, a != i, c);\n            var s = this.createElement(\"article\");\n            this.renderElements(o.elements, s), c.appendChild(s), this.options.renderFootnotes && this.renderNotes(this.currentFootnoteIds, this.footnoteMap, c), this.options.renderEndnotes && n == l - 1 && this.renderNotes(this.currentEndnoteIds, this.endnoteMap, c), this.options.renderFooters && this.renderHeaderFooter(i.footerRefs, i, t.length, a != i, c), t.push(c), a = i;\n          }\n\n          return t;\n        }\n\n        renderHeaderFooter(e, t, r, a, s) {\n          var n, l;\n\n          if (e) {\n            var o = null !== (l = null !== (n = t.titlePage && a ? e.find(e => \"first\" == e.type) : null) && void 0 !== n ? n : r % 2 == 1 ? e.find(e => \"even\" == e.type) : null) && void 0 !== l ? l : e.find(e => \"default\" == e.type),\n                i = o && this.document.findPartByRelId(o.id, this.document.documentPart);\n            i && (this.currentPart = i, this.usedHederFooterParts.includes(i.path) || (this.processElement(i.rootElement), this.usedHederFooterParts.push(i.path)), this.renderElements([i.rootElement], s), this.currentPart = null);\n          }\n        }\n\n        isPageBreakElement(e) {\n          return e.type == a.DomType.Break && (\"lastRenderedPageBreak\" == e.break ? !this.options.ignoreLastRenderedPageBreak : \"page\" == e.break);\n        }\n\n        splitBySection(e) {\n          var t,\n              r = {\n            sectProps: null,\n            elements: []\n          },\n              s = [r];\n\n          for (let u of e) {\n            if (u.type == a.DomType.Paragraph) {\n              const e = this.findStyle(u.styleName);\n              (null === (t = null == e ? void 0 : e.paragraphProps) || void 0 === t ? void 0 : t.pageBreakBefore) && (r.sectProps = n, r = {\n                sectProps: null,\n                elements: []\n              }, s.push(r));\n            }\n\n            if (r.elements.push(u), u.type == a.DomType.Paragraph) {\n              const e = u;\n              var n = e.sectionProps,\n                  l = -1,\n                  o = -1;\n\n              if (this.options.breakPages && e.children && (l = e.children.findIndex(e => {\n                var t, r;\n                return -1 != (o = null !== (r = null === (t = e.children) || void 0 === t ? void 0 : t.findIndex(this.isPageBreakElement.bind(this))) && void 0 !== r ? r : -1);\n              })), (n || -1 != l) && (r.sectProps = n, r = {\n                sectProps: null,\n                elements: []\n              }, s.push(r)), -1 != l) {\n                let t = e.children[l],\n                    a = o < t.children.length - 1;\n\n                if (l < e.children.length - 1 || a) {\n                  var i = u.children,\n                      c = Object.assign(Object.assign({}, u), {\n                    children: i.slice(l)\n                  });\n\n                  if (u.children = i.slice(0, l), r.elements.push(c), a) {\n                    let e = t.children,\n                        r = Object.assign(Object.assign({}, t), {\n                      children: e.slice(0, o)\n                    });\n                    u.children.push(r), t.children = e.slice(o);\n                  }\n                }\n              }\n            }\n          }\n\n          let u = null;\n\n          for (let e = s.length - 1; e >= 0; e--) null == s[e].sectProps ? s[e].sectProps = u : u = s[e].sectProps;\n\n          return s;\n        }\n\n        renderWrapper(e) {\n          return this.createElement(\"div\", {\n            className: `${this.className}-wrapper`\n          }, e);\n        }\n\n        renderDefaultStyle() {\n          var e = this.className;\n          return h(`\\n.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \\n.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }\\n.${e} { color: black; }\\nsection.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\\nsection.${e}>article { margin-bottom: auto; }\\n.${e} table { border-collapse: collapse; }\\n.${e} table td, .${e} table th { vertical-align: top; }\\n.${e} p { margin: 0pt; min-height: 1em; }\\n.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }\\n.${e} a { color: inherit; text-decoration: inherit; }\\n`);\n        }\n\n        renderNumbering(e, t) {\n          var r = \"\",\n              a = [];\n\n          for (var s of e) {\n            var n = `p.${this.numberingClass(s.id, s.level)}`,\n                l = \"none\";\n\n            if (s.bullet) {\n              let e = `--${this.className}-${s.bullet.src}`.toLowerCase();\n              r += this.styleToString(`${n}:before`, {\n                content: \"' '\",\n                display: \"inline-block\",\n                background: `var(${e})`\n              }, s.bullet.style), this.document.loadNumberingImage(s.bullet.src).then(r => {\n                var a = `${this.rootSelector} { ${e}: url(${r}) }`;\n                t.appendChild(h(a));\n              });\n            } else if (s.levelText) {\n              let e = this.numberingCounter(s.id, s.level);\n              s.level > 0 ? r += this.styleToString(`p.${this.numberingClass(s.id, s.level - 1)}`, {\n                \"counter-reset\": e\n              }) : a.push(e), r += this.styleToString(`${n}:before`, Object.assign({\n                content: this.levelTextToContent(s.levelText, s.suff, s.id, this.numFormatToCssValue(s.format)),\n                \"counter-increment\": e\n              }, s.rStyle));\n            } else l = this.numFormatToCssValue(s.format);\n\n            r += this.styleToString(n, Object.assign({\n              display: \"list-item\",\n              \"list-style-position\": \"inside\",\n              \"list-style-type\": l\n            }, s.pStyle));\n          }\n\n          return a.length > 0 && (r += this.styleToString(this.rootSelector, {\n            \"counter-reset\": a.join(\" \")\n          })), h(r);\n        }\n\n        renderStyles(e) {\n          var t,\n              r = \"\";\n          const a = this.styleMap,\n                n = (0, s.keyBy)(e.filter(e => e.isDefault), e => e.target);\n\n          for (const s of e) {\n            var l = s.styles;\n\n            if (s.linked) {\n              var o = s.linked && a[s.linked];\n              o ? l = l.concat(o.styles) : this.options.debug && console.warn(`Can't find linked style ${s.linked}`);\n            }\n\n            for (const e of l) {\n              var i = `${null !== (t = s.target) && void 0 !== t ? t : \"\"}.${s.cssName}`;\n              s.target != e.target && (i += ` ${e.target}`), n[s.target] == s && (i = `.${this.className} ${s.target}, ` + i), r += this.styleToString(i, e.values);\n            }\n          }\n\n          return h(r);\n        }\n\n        renderNotes(e, t, r) {\n          var a = e.map(e => t[e]).filter(e => e);\n\n          if (a.length > 0) {\n            var s = this.createElement(\"ol\", null, this.renderElements(a));\n            r.appendChild(s);\n          }\n        }\n\n        renderElement(e) {\n          switch (e.type) {\n            case a.DomType.Paragraph:\n              return this.renderParagraph(e);\n\n            case a.DomType.BookmarkStart:\n              return this.renderBookmarkStart(e);\n\n            case a.DomType.BookmarkEnd:\n              return null;\n\n            case a.DomType.Run:\n              return this.renderRun(e);\n\n            case a.DomType.Table:\n              return this.renderTable(e);\n\n            case a.DomType.Row:\n              return this.renderTableRow(e);\n\n            case a.DomType.Cell:\n              return this.renderTableCell(e);\n\n            case a.DomType.Hyperlink:\n              return this.renderHyperlink(e);\n\n            case a.DomType.Drawing:\n              return this.renderDrawing(e);\n\n            case a.DomType.Image:\n              return this.renderImage(e);\n\n            case a.DomType.Text:\n            case a.DomType.Text:\n              return this.renderText(e);\n\n            case a.DomType.DeletedText:\n              return this.renderDeletedText(e);\n\n            case a.DomType.Tab:\n              return this.renderTab(e);\n\n            case a.DomType.Symbol:\n              return this.renderSymbol(e);\n\n            case a.DomType.Break:\n              return this.renderBreak(e);\n\n            case a.DomType.Footer:\n              return this.renderContainer(e, \"footer\");\n\n            case a.DomType.Header:\n              return this.renderContainer(e, \"header\");\n\n            case a.DomType.Footnote:\n            case a.DomType.Endnote:\n              return this.renderContainer(e, \"li\");\n\n            case a.DomType.FootnoteReference:\n              return this.renderFootnoteReference(e);\n\n            case a.DomType.EndnoteReference:\n              return this.renderEndnoteReference(e);\n\n            case a.DomType.NoBreakHyphen:\n              return this.createElement(\"wbr\");\n\n            case a.DomType.VmlPicture:\n              return this.renderVmlPicture(e);\n\n            case a.DomType.VmlElement:\n              return this.renderVmlElement(e);\n\n            case a.DomType.MmlMath:\n              return this.renderContainerNS(e, o, \"math\", {\n                xmlns: o\n              });\n\n            case a.DomType.MmlMathParagraph:\n              return this.renderContainer(e, \"span\");\n\n            case a.DomType.MmlFraction:\n              return this.renderContainerNS(e, o, \"mfrac\");\n\n            case a.DomType.MmlNumerator:\n            case a.DomType.MmlDenominator:\n              return this.renderContainerNS(e, o, \"mrow\");\n\n            case a.DomType.MmlRadical:\n              return this.renderMmlRadical(e);\n\n            case a.DomType.MmlDegree:\n              return this.renderContainerNS(e, o, \"mn\");\n\n            case a.DomType.MmlSuperscript:\n              return this.renderContainerNS(e, o, \"msup\");\n\n            case a.DomType.MmlSubscript:\n              return this.renderContainerNS(e, o, \"msub\");\n\n            case a.DomType.MmlBase:\n              return this.renderContainerNS(e, o, \"mrow\");\n\n            case a.DomType.MmlSuperArgument:\n            case a.DomType.MmlSubArgument:\n              return this.renderContainerNS(e, o, \"mn\");\n\n            case a.DomType.MmlDelimiter:\n              return this.renderMmlDelimiter(e);\n\n            case a.DomType.MmlNary:\n              return this.renderMmlNary(e);\n\n            case a.DomType.Inserted:\n              return this.renderInserted(e);\n\n            case a.DomType.Deleted:\n              return this.renderDeleted(e);\n          }\n\n          return null;\n        }\n\n        renderChildren(e, t) {\n          return this.renderElements(e.children, t);\n        }\n\n        renderElements(e, t) {\n          if (null == e) return null;\n          var r = e.flatMap(e => this.renderElement(e)).filter(e => null != e);\n          return t && d(t, r), r;\n        }\n\n        renderContainer(e, t, r) {\n          return this.createElement(t, r, this.renderChildren(e));\n        }\n\n        renderContainerNS(e, t, r, a) {\n          return u(t, r, a, this.renderChildren(e));\n        }\n\n        renderParagraph(e) {\n          var t,\n              r,\n              a,\n              s,\n              n = this.createElement(\"p\");\n          const l = this.findStyle(e.styleName);\n          null !== (t = e.tabs) && void 0 !== t || (e.tabs = null === (r = null == l ? void 0 : l.paragraphProps) || void 0 === r ? void 0 : r.tabs), this.renderClass(e, n), this.renderChildren(e, n), this.renderStyleValues(e.cssStyle, n), this.renderCommonProperties(n.style, e);\n          const o = null !== (a = e.numbering) && void 0 !== a ? a : null === (s = null == l ? void 0 : l.paragraphProps) || void 0 === s ? void 0 : s.numbering;\n          return o && n.classList.add(this.numberingClass(o.id, o.level)), n;\n        }\n\n        renderRunProperties(e, t) {\n          this.renderCommonProperties(e, t);\n        }\n\n        renderCommonProperties(e, t) {\n          null != t && (t.color && (e.color = t.color), t.fontSize && (e[\"font-size\"] = t.fontSize));\n        }\n\n        renderHyperlink(e) {\n          var t = this.createElement(\"a\");\n          if (this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), e.href) t.href = e.href;else if (e.id) {\n            const r = this.document.documentPart.rels.find(t => t.id == e.id && \"External\" === t.targetMode);\n            t.href = null == r ? void 0 : r.target;\n          }\n          return t;\n        }\n\n        renderDrawing(e) {\n          var t = this.createElement(\"div\");\n          return t.style.display = \"inline-block\", t.style.position = \"relative\", t.style.textIndent = \"0px\", this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), t;\n        }\n\n        renderImage(e) {\n          let t = this.createElement(\"img\");\n          return this.renderStyleValues(e.cssStyle, t), this.document && this.document.loadDocumentImage(e.src, this.currentPart).then(e => {\n            t.src = e;\n          }), t;\n        }\n\n        renderText(e) {\n          return this.htmlDocument.createTextNode(e.text);\n        }\n\n        renderDeletedText(e) {\n          return this.options.renderEndnotes ? this.htmlDocument.createTextNode(e.text) : null;\n        }\n\n        renderBreak(e) {\n          return \"textWrapping\" == e.break ? this.createElement(\"br\") : null;\n        }\n\n        renderInserted(e) {\n          return this.options.renderChanges ? this.renderContainer(e, \"ins\") : this.renderChildren(e);\n        }\n\n        renderDeleted(e) {\n          return this.options.renderChanges ? this.renderContainer(e, \"del\") : null;\n        }\n\n        renderSymbol(e) {\n          var t = this.createElement(\"span\");\n          return t.style.fontFamily = e.font, t.innerHTML = `&#x${e.char};`, t;\n        }\n\n        renderFootnoteReference(e) {\n          var t = this.createElement(\"sup\");\n          return this.currentFootnoteIds.push(e.id), t.textContent = `${this.currentFootnoteIds.length}`, t;\n        }\n\n        renderEndnoteReference(e) {\n          var t = this.createElement(\"sup\");\n          return this.currentEndnoteIds.push(e.id), t.textContent = `${this.currentEndnoteIds.length}`, t;\n        }\n\n        renderTab(e) {\n          var t,\n              r = this.createElement(\"span\");\n\n          if (r.innerHTML = \"&emsp;\", this.options.experimental) {\n            r.className = this.tabStopClass();\n            var s = null === (t = function (e, t) {\n              for (var r = e.parent; null != r && r.type != t;) r = r.parent;\n\n              return r;\n            }(e, a.DomType.Paragraph)) || void 0 === t ? void 0 : t.tabs;\n            this.currentTabs.push({\n              stops: s,\n              span: r\n            });\n          }\n\n          return r;\n        }\n\n        renderBookmarkStart(e) {\n          var t = this.createElement(\"span\");\n          return t.id = e.name, t;\n        }\n\n        renderRun(e) {\n          if (e.fieldRun) return null;\n          const t = this.createElement(\"span\");\n\n          if (e.id && (t.id = e.id), this.renderClass(e, t), this.renderStyleValues(e.cssStyle, t), e.verticalAlign) {\n            const r = this.createElement(e.verticalAlign);\n            this.renderChildren(e, r), t.appendChild(r);\n          } else this.renderChildren(e, t);\n\n          return t;\n        }\n\n        renderTable(e) {\n          let t = this.createElement(\"table\");\n          return this.tableCellPositions.push(this.currentCellPosition), this.tableVerticalMerges.push(this.currentVerticalMerge), this.currentVerticalMerge = {}, this.currentCellPosition = {\n            col: 0,\n            row: 0\n          }, e.columns && t.appendChild(this.renderTableColumns(e.columns)), this.renderClass(e, t), this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), this.currentVerticalMerge = this.tableVerticalMerges.pop(), this.currentCellPosition = this.tableCellPositions.pop(), t;\n        }\n\n        renderTableColumns(e) {\n          let t = this.createElement(\"colgroup\");\n\n          for (let r of e) {\n            let e = this.createElement(\"col\");\n            r.width && (e.style.width = r.width), t.appendChild(e);\n          }\n\n          return t;\n        }\n\n        renderTableRow(e) {\n          let t = this.createElement(\"tr\");\n          return this.currentCellPosition.col = 0, this.renderClass(e, t), this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), this.currentCellPosition.row++, t;\n        }\n\n        renderTableCell(e) {\n          let t = this.createElement(\"td\");\n\n          if (e.verticalMerge) {\n            const r = this.currentCellPosition.col;\n            \"restart\" == e.verticalMerge ? (this.currentVerticalMerge[r] = t, t.rowSpan = 1) : this.currentVerticalMerge[r] && (this.currentVerticalMerge[r].rowSpan += 1, t.style.display = \"none\");\n          }\n\n          return this.renderClass(e, t), this.renderChildren(e, t), this.renderStyleValues(e.cssStyle, t), e.span && (t.colSpan = e.span), this.currentCellPosition.col++, t;\n        }\n\n        renderVmlPicture(e) {\n          var t = i(\"div\");\n          return this.renderChildren(e, t), t;\n        }\n\n        renderVmlElement(e) {\n          var t,\n              r,\n              a = c(\"svg\");\n          a.setAttribute(\"style\", e.cssStyleText);\n          const s = c(e.tagName);\n          return Object.entries(e.attrs).forEach(([e, t]) => s.setAttribute(e, t)), (null === (t = e.imageHref) || void 0 === t ? void 0 : t.id) && (null === (r = this.document) || void 0 === r || r.loadDocumentImage(e.imageHref.id, this.currentPart).then(e => s.setAttribute(\"href\", e))), a.appendChild(s), setTimeout(() => {\n            const e = a.firstElementChild.getBBox();\n            a.setAttribute(\"width\", `${Math.ceil(e.x + e.width)}`), a.setAttribute(\"height\", `${Math.ceil(e.y + e.height)}`);\n          }, 0), a;\n        }\n\n        renderMmlRadical(e) {\n          var t;\n          const r = e.children.find(e => e.type == a.DomType.MmlBase);\n          if (null === (t = e.props) || void 0 === t ? void 0 : t.hideDegree) return u(o, \"msqrt\", null, this.renderElements([r]));\n          const s = e.children.find(e => e.type == a.DomType.MmlDegree);\n          return u(o, \"mroot\", null, this.renderElements([r, s]));\n        }\n\n        renderMmlDelimiter(e) {\n          var t, r;\n          const a = [];\n          return a.push(u(o, \"mo\", null, [null !== (t = e.props.beginChar) && void 0 !== t ? t : \"(\"])), a.push(...this.renderElements(e.children)), a.push(u(o, \"mo\", null, [null !== (r = e.props.endChar) && void 0 !== r ? r : \")\"])), u(o, \"mrow\", null, a);\n        }\n\n        renderMmlNary(e) {\n          var t;\n          const r = [],\n                n = (0, s.keyBy)(e.children, e => e.type),\n                l = n[a.DomType.MmlSuperArgument],\n                i = n[a.DomType.MmlSubArgument],\n                c = l ? u(o, \"mo\", null, (0, s.asArray)(this.renderElement(l))) : null,\n                p = i ? u(o, \"mo\", null, (0, s.asArray)(this.renderElement(i))) : null;\n\n          if (null === (t = e.props) || void 0 === t ? void 0 : t.char) {\n            const t = u(o, \"mo\", null, [e.props.char]);\n            c || p ? r.push(u(o, \"munderover\", null, [t, p, c])) : c ? r.push(u(o, \"mover\", null, [t, c])) : p ? r.push(u(o, \"munder\", null, [t, p])) : r.push(t);\n          }\n\n          return r.push(...this.renderElements(n[a.DomType.MmlBase].children)), u(o, \"mrow\", null, r);\n        }\n\n        renderStyleValues(e, t) {\n          Object.assign(t.style, e);\n        }\n\n        renderClass(e, t) {\n          e.className && (t.className = e.className), e.styleName && t.classList.add(this.processStyleName(e.styleName));\n        }\n\n        findStyle(e) {\n          var t;\n          return e && (null === (t = this.styleMap) || void 0 === t ? void 0 : t[e]);\n        }\n\n        numberingClass(e, t) {\n          return `${this.className}-num-${e}-${t}`;\n        }\n\n        tabStopClass() {\n          return `${this.className}-tab-stop`;\n        }\n\n        styleToString(e, t, r = null) {\n          let a = `${e} {\\r\\n`;\n\n          for (const e in t) a += `  ${e}: ${t[e]};\\r\\n`;\n\n          return r && (a += r), a + \"}\\r\\n\";\n        }\n\n        numberingCounter(e, t) {\n          return `${this.className}-num-${e}-${t}`;\n        }\n\n        levelTextToContent(e, t, r, a) {\n          var s;\n          return `\"${e.replace(/%\\d*/g, e => {\n            let t = parseInt(e.substring(1), 10) - 1;\n            return `\"counter(${this.numberingCounter(r, t)}, ${a})\"`;\n          })}${null !== (s = {\n            tab: \"\\\\9\",\n            space: \"\\\\a0\"\n          }[t]) && void 0 !== s ? s : \"\"}\"`;\n        }\n\n        numFormatToCssValue(e) {\n          return {\n            none: \"none\",\n            bullet: \"disc\",\n            decimal: \"decimal\",\n            lowerLetter: \"lower-alpha\",\n            upperLetter: \"upper-alpha\",\n            lowerRoman: \"lower-roman\",\n            upperRoman: \"upper-roman\"\n          }[e] || e;\n        }\n\n        refreshTabStops() {\n          this.options.experimental && (clearTimeout(this.tabsTimeout), this.tabsTimeout = setTimeout(() => {\n            const e = (0, n.computePixelToPoint)();\n\n            for (let t of this.currentTabs) (0, n.updateTabStop)(t.span, t.stops, this.defaultTabSize, e);\n          }, 500));\n        }\n\n      };\n    },\n    630: (e, t) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.updateTabStop = t.computePixelToPoint = void 0;\n      const r = {\n        pos: 0,\n        leader: \"none\",\n        style: \"left\"\n      };\n\n      function a(e) {\n        return parseFloat(e);\n      }\n\n      t.computePixelToPoint = function (e = document.body) {\n        const t = document.createElement(\"div\");\n        t.style.width = \"100pt\", e.appendChild(t);\n        const r = 100 / t.offsetWidth;\n        return e.removeChild(t), r;\n      }, t.updateTabStop = function (e, t, s, n = .75) {\n        const l = e.closest(\"p\"),\n              o = e.getBoundingClientRect(),\n              i = l.getBoundingClientRect(),\n              c = getComputedStyle(l),\n              u = (null == t ? void 0 : t.length) > 0 ? t.map(e => ({\n          pos: a(e.position),\n          leader: e.leader,\n          style: e.style\n        })).sort((e, t) => e.pos - t.pos) : [r],\n              p = u[u.length - 1],\n              d = i.width * n,\n              h = a(s);\n        let m = p.pos + h;\n        if (m < d) for (; m < d && u.length < 50; m += h) u.push(Object.assign(Object.assign({}, r), {\n          pos: m\n        }));\n        const f = parseFloat(c.marginLeft),\n              g = i.left + f,\n              b = (o.left - g) * n,\n              y = u.find(e => \"clear\" != e.style && e.pos > b);\n        if (null == y) return;\n        let v = 1;\n\n        if (\"right\" == y.style || \"center\" == y.style) {\n          const t = Array.from(l.querySelectorAll(`.${e.className}`)),\n                r = t.indexOf(e) + 1,\n                a = document.createRange();\n          a.setStart(e, 1), r < t.length ? a.setEndBefore(t[r]) : a.setEndAfter(l);\n          const s = \"center\" == y.style ? .5 : 1,\n                o = a.getBoundingClientRect(),\n                c = o.left + s * o.width - (i.left - f);\n          v = y.pos - c * n;\n        } else v = y.pos - b;\n\n        switch (e.innerHTML = \"&nbsp;\", e.style.textDecoration = \"inherit\", e.style.wordSpacing = `${v.toFixed(0)}pt`, y.leader) {\n          case \"dot\":\n          case \"middleDot\":\n            e.style.textDecoration = \"underline\", e.style.textDecorationStyle = \"dotted\";\n            break;\n\n          case \"hyphen\":\n          case \"heavy\":\n          case \"underscore\":\n            e.style.textDecoration = \"underline\";\n        }\n      };\n    },\n    881: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.WmlEndnote = t.WmlFootnote = t.WmlBaseNote = void 0;\n      const a = r(120);\n\n      class s {\n        constructor() {\n          this.children = [], this.cssStyle = {};\n        }\n\n      }\n\n      t.WmlBaseNote = s, t.WmlFootnote = class extends s {\n        constructor() {\n          super(...arguments), this.type = a.DomType.Footnote;\n        }\n\n      }, t.WmlEndnote = class extends s {\n        constructor() {\n          super(...arguments), this.type = a.DomType.Endnote;\n        }\n\n      };\n    },\n    735: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.EndnotesPart = t.FootnotesPart = t.BaseNotePart = void 0;\n      const a = r(530),\n            s = r(881);\n\n      class n extends a.Part {\n        constructor(e, t, r) {\n          super(e, t), this._documentParser = r;\n        }\n\n      }\n\n      t.BaseNotePart = n, t.FootnotesPart = class extends n {\n        constructor(e, t, r) {\n          super(e, t, r);\n        }\n\n        parseXml(e) {\n          this.notes = this._documentParser.parseNotes(e, \"footnote\", s.WmlFootnote);\n        }\n\n      }, t.EndnotesPart = class extends n {\n        constructor(e, t, r) {\n          super(e, t, r);\n        }\n\n        parseXml(e) {\n          this.notes = this._documentParser.parseNotes(e, \"endnote\", s.WmlEndnote);\n        }\n\n      };\n    },\n    527: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.NumberingPart = void 0;\n      const a = r(530),\n            s = r(682);\n\n      class n extends a.Part {\n        constructor(e, t, r) {\n          super(e, t), this._documentParser = r;\n        }\n\n        parseXml(e) {\n          Object.assign(this, (0, s.parseNumberingPart)(e, this._package.xmlParser)), this.domNumberings = this._documentParser.parseNumberingFile(e);\n        }\n\n      }\n\n      t.NumberingPart = n;\n    },\n    682: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseNumberingBulletPicture = t.parseNumberingLevelOverrride = t.parseNumberingLevel = t.parseAbstractNumbering = t.parseNumbering = t.parseNumberingPart = void 0;\n      const a = r(109),\n            s = r(488);\n\n      function n(e, t) {\n        let r = {\n          id: t.attr(e, \"numId\"),\n          overrides: []\n        };\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"abstractNumId\":\n            r.abstractId = t.attr(a, \"val\");\n            break;\n\n          case \"lvlOverride\":\n            r.overrides.push(i(a, t));\n        }\n\n        return r;\n      }\n\n      function l(e, t) {\n        let r = {\n          id: t.attr(e, \"abstractNumId\"),\n          levels: []\n        };\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"name\":\n            r.name = t.attr(a, \"val\");\n            break;\n\n          case \"multiLevelType\":\n            r.multiLevelType = t.attr(a, \"val\");\n            break;\n\n          case \"numStyleLink\":\n            r.numberingStyleLink = t.attr(a, \"val\");\n            break;\n\n          case \"styleLink\":\n            r.styleLink = t.attr(a, \"val\");\n            break;\n\n          case \"lvl\":\n            r.levels.push(o(a, t));\n        }\n\n        return r;\n      }\n\n      function o(e, t) {\n        let r = {\n          level: t.intAttr(e, \"ilvl\")\n        };\n\n        for (let n of t.elements(e)) switch (n.localName) {\n          case \"start\":\n            r.start = t.attr(n, \"val\");\n            break;\n\n          case \"lvlRestart\":\n            r.restart = t.intAttr(n, \"val\");\n            break;\n\n          case \"numFmt\":\n            r.format = t.attr(n, \"val\");\n            break;\n\n          case \"lvlText\":\n            r.text = t.attr(n, \"val\");\n            break;\n\n          case \"lvlJc\":\n            r.justification = t.attr(n, \"val\");\n            break;\n\n          case \"lvlPicBulletId\":\n            r.bulletPictureId = t.attr(n, \"val\");\n            break;\n\n          case \"pStyle\":\n            r.paragraphStyle = t.attr(n, \"val\");\n            break;\n\n          case \"pPr\":\n            r.paragraphProps = (0, a.parseParagraphProperties)(n, t);\n            break;\n\n          case \"rPr\":\n            r.runProps = (0, s.parseRunProperties)(n, t);\n        }\n\n        return r;\n      }\n\n      function i(e, t) {\n        let r = {\n          level: t.intAttr(e, \"ilvl\")\n        };\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"startOverride\":\n            r.start = t.intAttr(a, \"val\");\n            break;\n\n          case \"lvl\":\n            r.numberingLevel = o(a, t);\n        }\n\n        return r;\n      }\n\n      function c(e, t) {\n        var r = t.element(e, \"pict\"),\n            a = r && t.element(r, \"shape\"),\n            s = a && t.element(a, \"imagedata\");\n        return s ? {\n          id: t.attr(e, \"numPicBulletId\"),\n          referenceId: t.attr(s, \"id\"),\n          style: t.attr(a, \"style\")\n        } : null;\n      }\n\n      t.parseNumberingPart = function (e, t) {\n        let r = {\n          numberings: [],\n          abstractNumberings: [],\n          bulletPictures: []\n        };\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"num\":\n            r.numberings.push(n(a, t));\n            break;\n\n          case \"abstractNum\":\n            r.abstractNumberings.push(l(a, t));\n            break;\n\n          case \"numPicBullet\":\n            r.bulletPictures.push(c(a, t));\n        }\n\n        return r;\n      }, t.parseNumbering = n, t.parseAbstractNumbering = l, t.parseNumberingLevel = o, t.parseNumberingLevelOverrride = i, t.parseNumberingBulletPicture = c;\n    },\n    472: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.XmlParser = t.serializeXmlString = t.parseXmlString = void 0;\n      const a = r(149);\n      t.parseXmlString = function (e, t = !1) {\n        t && (e = e.replace(/<[?].*[?]>/, \"\"));\n        const r = new DOMParser().parseFromString(e, \"application/xml\"),\n              a = null === (s = r.getElementsByTagName(\"parsererror\")[0]) || void 0 === s ? void 0 : s.textContent;\n        var s;\n        if (a) throw new Error(a);\n        return r;\n      }, t.serializeXmlString = function (e) {\n        return new XMLSerializer().serializeToString(e);\n      };\n\n      class s {\n        elements(e, t = null) {\n          const r = [];\n\n          for (let a = 0, s = e.childNodes.length; a < s; a++) {\n            let s = e.childNodes.item(a);\n            1 != s.nodeType || null != t && s.localName != t || r.push(s);\n          }\n\n          return r;\n        }\n\n        element(e, t) {\n          for (let r = 0, a = e.childNodes.length; r < a; r++) {\n            let a = e.childNodes.item(r);\n            if (1 == a.nodeType && a.localName == t) return a;\n          }\n\n          return null;\n        }\n\n        elementAttr(e, t, r) {\n          var a = this.element(e, t);\n          return a ? this.attr(a, r) : void 0;\n        }\n\n        attrs(e) {\n          return Array.from(e.attributes);\n        }\n\n        attr(e, t) {\n          for (let r = 0, a = e.attributes.length; r < a; r++) {\n            let a = e.attributes.item(r);\n            if (a.localName == t) return a.value;\n          }\n\n          return null;\n        }\n\n        intAttr(e, t, r = null) {\n          var a = this.attr(e, t);\n          return a ? parseInt(a) : r;\n        }\n\n        hexAttr(e, t, r = null) {\n          var a = this.attr(e, t);\n          return a ? parseInt(a, 16) : r;\n        }\n\n        floatAttr(e, t, r = null) {\n          var a = this.attr(e, t);\n          return a ? parseFloat(a) : r;\n        }\n\n        boolAttr(e, t, r = null) {\n          return (0, a.convertBoolean)(this.attr(e, t), r);\n        }\n\n        lengthAttr(e, t, r = a.LengthUsage.Dxa) {\n          return (0, a.convertLength)(this.attr(e, t), r);\n        }\n\n      }\n\n      t.XmlParser = s;\n      const n = new s();\n      t.default = n;\n    },\n    287: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.SettingsPart = void 0;\n      const a = r(530),\n            s = r(846);\n\n      class n extends a.Part {\n        constructor(e, t) {\n          super(e, t);\n        }\n\n        parseXml(e) {\n          this.settings = (0, s.parseSettings)(e, this._package.xmlParser);\n        }\n\n      }\n\n      t.SettingsPart = n;\n    },\n    846: (e, t) => {\n      function r(e, t) {\n        var r = {\n          defaultNoteIds: []\n        };\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"numFmt\":\n            r.nummeringFormat = t.attr(a, \"val\");\n            break;\n\n          case \"footnote\":\n          case \"endnote\":\n            r.defaultNoteIds.push(t.attr(a, \"id\"));\n        }\n\n        return r;\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseNoteProperties = t.parseSettings = void 0, t.parseSettings = function (e, t) {\n        var a = {};\n\n        for (let s of t.elements(e)) switch (s.localName) {\n          case \"defaultTabStop\":\n            a.defaultTabStop = t.lengthAttr(s, \"val\");\n            break;\n\n          case \"footnotePr\":\n            a.footnoteProps = r(s, t);\n            break;\n\n          case \"endnotePr\":\n            a.endnoteProps = r(s, t);\n            break;\n\n          case \"autoHyphenation\":\n            a.autoHyphenation = t.boolAttr(s, \"val\");\n        }\n\n        return a;\n      }, t.parseNoteProperties = r;\n    },\n    240: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.StylesPart = void 0;\n      const a = r(530);\n\n      class s extends a.Part {\n        constructor(e, t, r) {\n          super(e, t), this._documentParser = r;\n        }\n\n        parseXml(e) {\n          this.styles = this._documentParser.parseStylesFile(e);\n        }\n\n      }\n\n      t.StylesPart = s;\n    },\n    893: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.ThemePart = void 0;\n      const a = r(530),\n            s = r(55);\n\n      class n extends a.Part {\n        constructor(e, t) {\n          super(e, t);\n        }\n\n        parseXml(e) {\n          this.theme = (0, s.parseTheme)(e, this._package.xmlParser);\n        }\n\n      }\n\n      t.ThemePart = n;\n    },\n    55: (e, t) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseFontInfo = t.parseFontScheme = t.parseColorScheme = t.parseTheme = t.DmlTheme = void 0;\n\n      class r {}\n\n      function a(e, t) {\n        var r = {\n          name: t.attr(e, \"name\"),\n          colors: {}\n        };\n\n        for (let n of t.elements(e)) {\n          var a = t.element(n, \"srgbClr\"),\n              s = t.element(n, \"sysClr\");\n          a ? r.colors[n.localName] = t.attr(a, \"val\") : s && (r.colors[n.localName] = t.attr(s, \"lastClr\"));\n        }\n\n        return r;\n      }\n\n      function s(e, t) {\n        var r = {\n          name: t.attr(e, \"name\")\n        };\n\n        for (let a of t.elements(e)) switch (a.localName) {\n          case \"majorFont\":\n            r.majorFont = n(a, t);\n            break;\n\n          case \"minorFont\":\n            r.minorFont = n(a, t);\n        }\n\n        return r;\n      }\n\n      function n(e, t) {\n        return {\n          latinTypeface: t.elementAttr(e, \"latin\", \"typeface\"),\n          eaTypeface: t.elementAttr(e, \"ea\", \"typeface\"),\n          csTypeface: t.elementAttr(e, \"cs\", \"typeface\")\n        };\n      }\n\n      t.DmlTheme = r, t.parseTheme = function (e, t) {\n        var n = new r(),\n            l = t.element(e, \"themeElements\");\n\n        for (let e of t.elements(l)) switch (e.localName) {\n          case \"clrScheme\":\n            n.colorScheme = a(e, t);\n            break;\n\n          case \"fontScheme\":\n            n.fontScheme = s(e, t);\n        }\n\n        return n;\n      }, t.parseColorScheme = a, t.parseFontScheme = s, t.parseFontInfo = n;\n    },\n    593: (e, t) => {\n      function r(e) {\n        return e && \"object\" == typeof e && !Array.isArray(e);\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.asArray = t.formatCssRules = t.parseCssRules = t.mergeDeep = t.isString = t.isObject = t.blobToBase64 = t.keyBy = t.resolvePath = t.splitPath = t.escapeClassName = void 0, t.escapeClassName = function (e) {\n        return null == e ? void 0 : e.replace(/[ .]+/g, \"-\").replace(/[&]+/g, \"and\").toLowerCase();\n      }, t.splitPath = function (e) {\n        let t = e.lastIndexOf(\"/\") + 1;\n        return [0 == t ? \"\" : e.substring(0, t), 0 == t ? e : e.substring(t)];\n      }, t.resolvePath = function (e, t) {\n        try {\n          const r = \"http://docx/\";\n          return new URL(e, r + t).toString().substring(r.length);\n        } catch (r) {\n          return `${t}${e}`;\n        }\n      }, t.keyBy = function (e, t) {\n        return e.reduce((e, r) => (e[t(r)] = r, e), {});\n      }, t.blobToBase64 = function (e) {\n        return new Promise((t, r) => {\n          const a = new FileReader();\n          a.onloadend = () => t(a.result), a.readAsDataURL(e);\n        });\n      }, t.isObject = r, t.isString = function (e) {\n        return e && \"string\" == typeof e || e instanceof String;\n      }, t.mergeDeep = function e(t, ...a) {\n        var s;\n        if (!a.length) return t;\n        const n = a.shift();\n        if (r(t) && r(n)) for (const a in n) r(n[a]) ? e(null !== (s = t[a]) && void 0 !== s ? s : t[a] = {}, n[a]) : t[a] = n[a];\n        return e(t, ...a);\n      }, t.parseCssRules = function (e) {\n        const t = {};\n\n        for (const r of e.split(\";\")) {\n          const [e, a] = r.split(\":\");\n          t[e] = a;\n        }\n\n        return t;\n      }, t.formatCssRules = function (e) {\n        return Object.entries(e).map((e, t) => `${e}: ${t}`).join(\";\");\n      }, t.asArray = function (e) {\n        return Array.isArray(e) ? e : [e];\n      };\n    },\n    320: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.parseVmlElement = t.VmlElement = void 0;\n      const a = r(149),\n            s = r(120),\n            n = r(472);\n\n      class l {\n        constructor() {\n          this.type = s.DomType.VmlElement, this.attrs = {}, this.chidren = [];\n        }\n\n      }\n\n      function o(e) {\n        var t;\n        return {\n          stroke: n.default.attr(e, \"color\"),\n          \"stroke-width\": null !== (t = n.default.lengthAttr(e, \"weight\", a.LengthUsage.Emu)) && void 0 !== t ? t : \"1px\"\n        };\n      }\n\n      function i(e) {\n        return e.split(\",\");\n      }\n\n      t.VmlElement = l, t.parseVmlElement = function e(t) {\n        var r = new l();\n\n        switch (t.localName) {\n          case \"rect\":\n            r.tagName = \"rect\", Object.assign(r.attrs, {\n              width: \"100%\",\n              height: \"100%\"\n            });\n            break;\n\n          case \"oval\":\n            r.tagName = \"ellipse\", Object.assign(r.attrs, {\n              cx: \"50%\",\n              cy: \"50%\",\n              rx: \"50%\",\n              ry: \"50%\"\n            });\n            break;\n\n          case \"line\":\n            r.tagName = \"line\";\n            break;\n\n          case \"shape\":\n            r.tagName = \"g\";\n            break;\n\n          default:\n            return null;\n        }\n\n        for (const e of n.default.attrs(t)) switch (e.localName) {\n          case \"style\":\n            r.cssStyleText = e.value;\n            break;\n\n          case \"fillcolor\":\n            r.attrs.fill = e.value;\n            break;\n\n          case \"from\":\n            const [t, a] = i(e.value);\n            Object.assign(r.attrs, {\n              x1: t,\n              y1: a\n            });\n            break;\n\n          case \"to\":\n            const [s, n] = i(e.value);\n            Object.assign(r.attrs, {\n              x2: s,\n              y2: n\n            });\n        }\n\n        for (const a of n.default.elements(t)) switch (a.localName) {\n          case \"stroke\":\n            Object.assign(r.attrs, o(a));\n            break;\n\n          case \"fill\":\n            Object.assign(r.attrs, {});\n            break;\n\n          case \"imagedata\":\n            r.tagName = \"image\", Object.assign(r.attrs, {\n              width: \"100%\",\n              height: \"100%\"\n            }), r.imageHref = {\n              id: n.default.attr(a, \"id\"),\n              title: n.default.attr(a, \"title\")\n            };\n            break;\n\n          default:\n            const t = e(a);\n            t && r.chidren.push(t);\n        }\n\n        return r;\n      };\n    },\n    213: (e, t, r) => {\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.deobfuscate = t.WordDocument = void 0;\n      const a = r(461),\n            s = r(380),\n            n = r(522),\n            l = r(448),\n            o = r(593),\n            i = r(527),\n            c = r(240),\n            u = r(985),\n            p = r(665),\n            d = r(162),\n            h = r(893),\n            m = r(735),\n            f = r(287),\n            g = r(177),\n            b = [{\n        type: a.RelationshipTypes.OfficeDocument,\n        target: \"word/document.xml\"\n      }, {\n        type: a.RelationshipTypes.ExtendedProperties,\n        target: \"docProps/app.xml\"\n      }, {\n        type: a.RelationshipTypes.CoreProperties,\n        target: \"docProps/core.xml\"\n      }, {\n        type: a.RelationshipTypes.CustomProperties,\n        target: \"docProps/custom.xml\"\n      }];\n\n      class y {\n        constructor() {\n          this.parts = [], this.partsMap = {};\n        }\n\n        static load(e, t, r) {\n          var a = new y();\n          return a._options = r, a._parser = t, n.OpenXmlPackage.load(e, r).then(e => (a._package = e, a._package.loadRelationships())).then(e => {\n            a.rels = e;\n            const t = b.map(t => {\n              var r;\n              const s = null !== (r = e.find(e => e.type === t.type)) && void 0 !== r ? r : t;\n              return a.loadRelationshipPart(s.target, s.type);\n            });\n            return Promise.all(t);\n          }).then(() => a);\n        }\n\n        save(e = \"blob\") {\n          return this._package.save(e);\n        }\n\n        loadRelationshipPart(e, t) {\n          if (this.partsMap[e]) return Promise.resolve(this.partsMap[e]);\n          if (!this._package.get(e)) return Promise.resolve(null);\n          let r = null;\n\n          switch (t) {\n            case a.RelationshipTypes.OfficeDocument:\n              this.documentPart = r = new l.DocumentPart(this._package, e, this._parser);\n              break;\n\n            case a.RelationshipTypes.FontTable:\n              this.fontTablePart = r = new s.FontTablePart(this._package, e);\n              break;\n\n            case a.RelationshipTypes.Numbering:\n              this.numberingPart = r = new i.NumberingPart(this._package, e, this._parser);\n              break;\n\n            case a.RelationshipTypes.Styles:\n              this.stylesPart = r = new c.StylesPart(this._package, e, this._parser);\n              break;\n\n            case a.RelationshipTypes.Theme:\n              this.themePart = r = new h.ThemePart(this._package, e);\n              break;\n\n            case a.RelationshipTypes.Footnotes:\n              this.footnotesPart = r = new m.FootnotesPart(this._package, e, this._parser);\n              break;\n\n            case a.RelationshipTypes.Endnotes:\n              this.endnotesPart = r = new m.EndnotesPart(this._package, e, this._parser);\n              break;\n\n            case a.RelationshipTypes.Footer:\n              r = new u.FooterPart(this._package, e, this._parser);\n              break;\n\n            case a.RelationshipTypes.Header:\n              r = new u.HeaderPart(this._package, e, this._parser);\n              break;\n\n            case a.RelationshipTypes.CoreProperties:\n              this.corePropsPart = r = new d.CorePropsPart(this._package, e);\n              break;\n\n            case a.RelationshipTypes.ExtendedProperties:\n              this.extendedPropsPart = r = new p.ExtendedPropsPart(this._package, e);\n              break;\n\n            case a.RelationshipTypes.CustomProperties:\n              r = new g.CustomPropsPart(this._package, e);\n              break;\n\n            case a.RelationshipTypes.Settings:\n              this.settingsPart = r = new f.SettingsPart(this._package, e);\n          }\n\n          return null == r ? Promise.resolve(null) : (this.partsMap[e] = r, this.parts.push(r), r.load().then(() => {\n            if (null == r.rels || 0 == r.rels.length) return r;\n            const [e] = (0, o.splitPath)(r.path),\n                  t = r.rels.map(t => this.loadRelationshipPart((0, o.resolvePath)(t.target, e), t.type));\n            return Promise.all(t).then(() => r);\n          }));\n        }\n\n        loadDocumentImage(e, t) {\n          return this.loadResource(null != t ? t : this.documentPart, e, \"blob\").then(e => this.blobToURL(e));\n        }\n\n        loadNumberingImage(e) {\n          return this.loadResource(this.numberingPart, e, \"blob\").then(e => this.blobToURL(e));\n        }\n\n        loadFont(e, t) {\n          return this.loadResource(this.fontTablePart, e, \"uint8array\").then(e => e ? this.blobToURL(new Blob([v(e, t)])) : e);\n        }\n\n        blobToURL(e) {\n          return e ? this._options.useBase64URL ? (0, o.blobToBase64)(e) : URL.createObjectURL(e) : null;\n        }\n\n        findPartByRelId(e, t = null) {\n          var r,\n              a = (null !== (r = t.rels) && void 0 !== r ? r : this.rels).find(t => t.id == e);\n          const s = t ? (0, o.splitPath)(t.path)[0] : \"\";\n          return a ? this.partsMap[(0, o.resolvePath)(a.target, s)] : null;\n        }\n\n        getPathById(e, t) {\n          const r = e.rels.find(e => e.id == t),\n                [a] = (0, o.splitPath)(e.path);\n          return r ? (0, o.resolvePath)(r.target, a) : null;\n        }\n\n        loadResource(e, t, r) {\n          const a = this.getPathById(e, t);\n          return a ? this._package.load(a, r) : Promise.resolve(null);\n        }\n\n      }\n\n      function v(e, t) {\n        const r = t.replace(/{|}|-/g, \"\"),\n              a = new Array(16);\n\n        for (let e = 0; e < 16; e++) a[16 - e - 1] = parseInt(r.substr(2 * e, 2), 16);\n\n        for (let t = 0; t < 32; t++) e[t] = e[t] ^ a[t % 16];\n\n        return e;\n      }\n\n      t.WordDocument = y, t.deobfuscate = v;\n    },\n    583: e => {\n      e.exports = \"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 100%27 preserveAspectRatio=%27none%27%3E%3Cpath d=%27m0,75 l5,0 l5,25 l10,-100%27 stroke=%27black%27 fill=%27none%27 vector-effect=%27non-scaling-stroke%27/%3E%3C/svg%3E\";\n    },\n    626: t => {\n      t.exports = e;\n    }\n  },\n      r = {};\n\n  function a(e) {\n    var s = r[e];\n    if (void 0 !== s) return s.exports;\n    var n = r[e] = {\n      id: e,\n      exports: {}\n    };\n    return t[e](n, n.exports, a), n.exports;\n  }\n\n  return a.m = t, a.n = e => {\n    var t = e && e.__esModule ? () => e.default : () => e;\n    return a.d(t, {\n      a: t\n    }), t;\n  }, a.d = (e, t) => {\n    for (var r in t) a.o(t, r) && !a.o(e, r) && Object.defineProperty(e, r, {\n      enumerable: !0,\n      get: t[r]\n    });\n  }, a.o = (e, t) => Object.prototype.hasOwnProperty.call(e, t), a.r = e => {\n    \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n      value: \"Module\"\n    }), Object.defineProperty(e, \"__esModule\", {\n      value: !0\n    });\n  }, a.b = document.baseURI || self.location.href, a(667);\n})());","map":{"version":3,"mappings":"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","names":["root","factory","exports","module","require","define","amd","docx","JSZip","globalThis","__WEBPACK_EXTERNAL_MODULE__626__","___CSS_LOADER_URL_IMPORT_0___","URL","r","___CSS_LOADER_EXPORT___","l","s","___CSS_LOADER_URL_REPLACEMENT_0___","i","push","id","version","sources","names","mappings","sourcesContent","sourceRoot","toString","cssWithMappingToString","list","this","map","item","content","needLayer","concat","length","join","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","url","options","String","__esModule","default","test","slice","hash","needQuotes","replace","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","source","n","OpenXmlPackage","constructor","_zip","get","path","files","startsWith","substr","normalizePath","update","file","static","input","loadAsync","then","zip","save","type","generateAsync","load","a","async","Promise","resolve","loadRelationships","relsPath","f","fn","txt","parseXmlDocument","firstElementChild","xmlParser","trimXmlDeclaration","t","_package","all","rels","text","xmlDoc","keepOrigin","_xmlDocument","parseXml","RelationshipTypes","OfficeDocument","xml","elements","e","attr","target","targetMode","o","c","u","shd","color","borderColor","highlight","supportedNamespaceURIs","mmlTagMap","oMath","MmlMath","oMathPara","MmlMathParagraph","MmlFraction","num","MmlNumerator","den","MmlDenominator","rad","MmlRadical","deg","MmlDegree","MmlBase","sSup","MmlSuperscript","sSub","MmlSubscript","sup","MmlSuperArgument","sub","MmlSubArgument","d","MmlDelimiter","nary","MmlNary","Object","assign","ignoreWidth","debug","parseNotes","elemName","elemClass","result","el","node","noteType","children","parseBodyElements","parseDocumentFile","xbody","element","background","sectPr","Document","props","cssStyle","parseBackground","elem","xmlUtil","colorAttr","localName","parseParagraph","parseTable","parseSdt","parseStylesFile","xstyles","foreach","parseStyle","parseDefaultStyles","name","basedOn","styles","rPr","values","parseDefaultProperties","pPr","isDefault","boolAttr","linked","next","aliases","split","paragraphProps","runProps","parseTableStyle","console","warn","selector","modificator","mod","parseNumberingFile","xnums","mapping","bullets","parseAbstractNumbering","forEach","x","parseNumberingPicBullet","numId","abstractNumId","elementAttr","pict","shape","imagedata","intAttr","src","style","parseNumberingLevel","level","pStyleName","pStyle","rStyle","suff","bullet","find","levelText","format","parser","sdtContent","parseInserted","parentParser","Inserted","parseDeleted","Deleted","Paragraph","parseParagraphProperties","parseRun","parseHyperlink","parseMathElement","paragraph","styleName","className","classNameOfCnfStyle","parseFrame","float","parent","Hyperlink","anchor","relId","href","Run","checkAlternateContent","Text","textContent","DeletedText","SimpleField","instruction","lock","dirty","fieldRun","Instruction","ComplexField","charType","NoBreakHyphen","Break","break","Symbol","font","char","Tab","FootnoteReference","EndnoteReference","parseDrawing","parseVmlPicture","parseRunProperties","propsTag","parseMathProperies","hideDegree","beginChar","endChar","run","verticalAlign","valueOfVertAlign","VmlPicture","child","choice","requires","namespaceURI","lookupNamespaceURI","includes","parseDrawingWrapper","Drawing","isAnchor","wrapType","simplePos","posX","relative","align","offset","posY","lengthAttr","Emu","width","height","pos","alignNode","offsetNode","sizeValue","g","parseGraphic","display","position","left","top","graphicData","parsePicture","Image","blipFill","blip","spPr","xfrm","Table","parseTableRow","columns","parseTableColumns","parseTableProperties","table","cellStyle","classNameOftblLook","parseTablePosition","colBandSize","rowBandSize","topFromText","bottomFromText","rightFromText","leftFromText","addSize","Row","parseTableCell","parseTableRowProperties","row","isHeader","Cell","parseTableCellProperties","cell","span","verticalMerge","childStyle","handler","valueOfJc","valueOfTextAlignment","FontSize","valueOfSize","parseTrHeight","parseUnderline","parseIndentation","parseFont","parseBorderProperties","valueOfMargin","border","valueOfBorder","parseMarginProperties","valueOfTblLayout","parseSpacing","val","col","fonts","themeValue","filter","firstLine","hanging","start","right","end","before","after","line","lineRule","toFixed","output","knownColors","cb","childNodes","nodeType","Node","ELEMENT_NODE","attrName","defValue","autoColor","v","themeColor","Dxa","Percent","Border","_","asTagName","b","hexAttr","trim","CorePropsPart","Part","title","description","subject","creator","keywords","language","lastModifiedBy","revision","parseInt","CustomPropsPart","firstChild","formatId","nodeName","value","ExtendedPropsPart","safeParseToInt","template","pages","words","characters","application","lines","paragraphs","company","appVersion","BookmarkStart","colFirst","colLast","BookmarkEnd","parseBorder","size","Point","frame","shadow","bottom","wordml","drawingml","picture","compatibility","math","mul","unit","LineHeight","VmlEmu","usage","defaultValue","fontSize","DocumentPart","pkg","super","_documentParser","body","DomType","parseParagraphProperty","tabs","parseTabs","sectionProps","numbering","parseNumbering","lineSpacing","textAlignment","keepLines","keepNext","pageBreakBefore","outlineLevel","leader","parseRunProperty","parseColumns","numberOfColumns","space","separator","equalWidth","parsePageNumber","chapSep","chapStyle","parseFooterHeaderReference","SectionType","Continuous","section","pageSize","orientation","pageMargins","header","footer","gutter","headerRefs","footerRefs","titlePage","pageBorders","pageNumber","ignoreHeight","ignoreFonts","breakPages","experimental","inWrapper","ignoreLastRenderedPageBreak","renderHeaders","renderFooters","renderFootnotes","renderEndnotes","useBase64URL","useMathMLPolyfill","renderChanges","userOptions","ops","bodyContainer","styleContainer","renderer","window","document","doc","render","FontTablePart","embedFontTypeMap","embedRegular","embedBold","embedItalic","embedBoldItalic","embedFontRefs","family","altName","parseEmbedFontRef","key","Header","Footer","BaseHeaderFooterPart","rootElement","createRootElement","ns","createElement","tagName","createElementNS","createSvgElement","appendChildren","removeAllElements","innerHTML","appendChild","createTextNode","createStyleElement","cssText","appendComment","comment","createComment","htmlDocument","rootSelector","styleMap","renderDefaultStyle","MathMLElement","themePart","renderTheme","stylesPart","processStyles","renderStyles","numberingPart","prodessNumberings","domNumberings","renderNumbering","footnotesPart","footnoteMap","notes","endnotesPart","endnoteMap","settingsPart","defaultTabSize","settings","defaultTabStop","fontTablePart","renderFontTable","sectionElements","renderSections","documentPart","renderWrapper","refreshTabStops","variables","fontScheme","theme","majorFont","latinTypeface","minorFont","colorScheme","entries","colors","styleToString","fontsPart","ref","loadFont","fontData","cssValues","processStyleName","stylesMap","baseStyle","baseValues","styleValues","copyStyleProperties","cssName","numberings","findStyle","processElement","processTable","attrs","getOwnPropertyNames","hasOwnProperty","createSection","paddingLeft","paddingRight","paddingTop","paddingBottom","minHeight","columnCount","columnGap","columnRule","sections","splitBySection","prevProps","currentFootnoteIds","sectProps","sectionElement","renderStyleValues","renderHeaderFooter","contentElement","renderElements","renderNotes","currentEndnoteIds","refs","page","firstOfSection","into","part","findPartByRelId","currentPart","usedHederFooterParts","isPageBreakElement","current","p","pBreakIndex","rBreakIndex","findIndex","bind","breakRun","splitRun","newParagraph","runChildren","newRun","currentSectProps","styleText","rootCounters","numberingClass","listStyleType","valiable","toLowerCase","loadNumberingImage","counter","numberingCounter","levelTextToContent","numFormatToCssValue","defautStyles","subStyles","linkedStyle","subStyle","noteIds","notesMap","renderElement","renderParagraph","renderBookmarkStart","renderRun","renderTable","renderTableRow","renderTableCell","renderHyperlink","renderDrawing","renderImage","renderText","renderDeletedText","renderTab","renderSymbol","renderBreak","renderContainer","Footnote","Endnote","renderFootnoteReference","renderEndnoteReference","renderVmlPicture","VmlElement","renderVmlElement","renderContainerNS","xmlns","renderMmlRadical","renderMmlDelimiter","renderMmlNary","renderInserted","renderDeleted","renderChildren","elems","flatMap","renderClass","renderCommonProperties","classList","add","renderRunProperties","rel","it","textIndent","loadDocumentImage","fontFamily","tabSpan","tabStopClass","stops","findParent","currentTabs","wrapper","tableCellPositions","currentCellPosition","tableVerticalMerges","currentVerticalMerge","renderTableColumns","pop","colElem","rowSpan","colSpan","container","setAttribute","cssStyleText","imageHref","setTimeout","bb","getBBox","Math","ceil","y","base","degree","grouped","supElem","subElem","charElem","ouput","lvl","selectors","numformat","substring","tab","none","decimal","lowerLetter","upperLetter","lowerRoman","upperRoman","clearTimeout","tabsTimeout","pixelToPoint","defaultTab","lengthToPoint","parseFloat","temp","offsetWidth","removeChild","closest","ebb","getBoundingClientRect","pbb","pcs","getComputedStyle","tabStops","sort","lastTab","pWidthPt","marginLeft","pOffset","Array","from","querySelectorAll","nextIdx","indexOf","range","createRange","setStart","setEndBefore","setEndAfter","nextBB","textDecoration","wordSpacing","textDecorationStyle","WmlBaseNote","BaseNotePart","NumberingPart","overrides","abstractId","parseNumberingLevelOverrride","levels","multiLevelType","numberingStyleLink","styleLink","restart","justification","bulletPictureId","paragraphStyle","numberingLevel","parseNumberingBulletPicture","referenceId","abstractNumberings","bulletPictures","xmlString","DOMParser","parseFromString","errorText","getElementsByTagName","Error","XMLSerializer","serializeToString","XmlParser","attrLocalName","attributes","floatAttr","globalXmlParser","SettingsPart","parseNoteProperties","defaultNoteIds","nummeringFormat","footnoteProps","endnoteProps","autoHyphenation","StylesPart","ThemePart","DmlTheme","parseColorScheme","srgbClr","sysClr","parseFontScheme","parseFontInfo","eaTypeface","csTypeface","themeElements","isObject","isArray","si","lastIndexOf","prefix","array","by","reduce","blob","reader","FileReader","onloadend","readAsDataURL","mergeDeep","shift","rule","parseStroke","stroke","parsePoint","parseVmlElement","cx","cy","rx","ry","at","fill","x1","y1","x2","y2","chidren","h","m","topLevelRels","ExtendedProperties","CoreProperties","CustomProperties","WordDocument","_options","_parser","tasks","loadRelationshipPart","partsMap","FontTable","Numbering","Styles","Theme","Footnotes","Endnotes","corePropsPart","extendedPropsPart","Settings","parts","folder","loadResource","blobToURL","Blob","deobfuscate","createObjectURL","basePart","getPathById","outputType","guidKey","trimmed","numbers","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","definition","defineProperty","enumerable","obj","prop","prototype","call","toStringTag","baseURI","self","location"],"sourceRoot":"","sources":["webpack://docx/webpack/universalModuleDefinition","webpack://docx/src/mathml.scss","webpack://docx/node_modules/css-loader/dist/runtime/api.js","webpack://docx/node_modules/css-loader/dist/runtime/getUrl.js","webpack://docx/node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://docx/src/common/open-xml-package.ts","webpack://docx/src/common/part.ts","webpack://docx/src/common/relationship.ts","webpack://docx/src/document-parser.ts","webpack://docx/src/document-props/core-props-part.ts","webpack://docx/src/document-props/core-props.ts","webpack://docx/src/document-props/custom-props-part.ts","webpack://docx/src/document-props/custom-props.ts","webpack://docx/src/document-props/extended-props-part.ts","webpack://docx/src/document-props/extended-props.ts","webpack://docx/src/document/bookmarks.ts","webpack://docx/src/document/border.ts","webpack://docx/src/document/common.ts","webpack://docx/src/document/document-part.ts","webpack://docx/src/document/dom.ts","webpack://docx/src/document/line-spacing.ts","webpack://docx/src/document/paragraph.ts","webpack://docx/src/document/run.ts","webpack://docx/src/document/section.ts","webpack://docx/src/docx-preview.ts","webpack://docx/src/font-table/font-table.ts","webpack://docx/src/font-table/fonts.ts","webpack://docx/src/header-footer/elements.ts","webpack://docx/src/header-footer/parts.ts","webpack://docx/src/html-renderer.ts","webpack://docx/src/javascript.ts","webpack://docx/src/notes/elements.ts","webpack://docx/src/notes/parts.ts","webpack://docx/src/numbering/numbering-part.ts","webpack://docx/src/numbering/numbering.ts","webpack://docx/src/parser/xml-parser.ts","webpack://docx/src/settings/settings-part.ts","webpack://docx/src/settings/settings.ts","webpack://docx/src/styles/styles-part.ts","webpack://docx/src/theme/theme-part.ts","webpack://docx/src/theme/theme.ts","webpack://docx/src/utils.ts","webpack://docx/src/vml/vml.ts","webpack://docx/src/word-document.ts","webpack://docx/external umd {\"root\":\"JSZip\",\"commonjs\":\"jszip\",\"commonjs2\":\"jszip\",\"amd\":\"jszip\"}","webpack://docx/webpack/bootstrap","webpack://docx/webpack/runtime/compat get default export","webpack://docx/webpack/runtime/define property getters","webpack://docx/webpack/runtime/hasOwnProperty shorthand","webpack://docx/webpack/runtime/make namespace object","webpack://docx/webpack/runtime/jsonp chunk loading","webpack://docx/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jszip\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jszip\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"docx\"] = factory(require(\"jszip\"));\n\telse\n\t\troot[\"docx\"] = factory(root[\"JSZip\"]);\n})(globalThis, (__WEBPACK_EXTERNAL_MODULE__626__) => {\nreturn ","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_GET_URL_IMPORT___ from \"../node_modules/css-loader/dist/runtime/getUrl.js\";\nvar ___CSS_LOADER_URL_IMPORT_0___ = new URL(\"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 100%27 preserveAspectRatio=%27none%27%3E%3Cpath d=%27m0,75 l5,0 l5,25 l10,-100%27 stroke=%27black%27 fill=%27none%27 vector-effect=%27non-scaling-stroke%27/%3E%3C/svg%3E\", import.meta.url);\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\nvar ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"@namespace \\\"http://www.w3.org/1998/Math/MathML\\\";math{display:inline-block;line-height:initial}mfrac{display:inline-block;vertical-align:-50%;text-align:center}mfrac>:first-child{border-bottom:solid thin currentColor}mfrac>*{display:block}msub>:nth-child(2){font-size:smaller;vertical-align:sub}msup>:nth-child(2){font-size:smaller;vertical-align:super}munder,mover,munderover{display:inline-flex;flex-flow:column nowrap;vertical-align:middle;text-align:center}munder>:not(:first-child),mover>:not(:first-child),munderover>:not(:first-child){font-size:smaller}munderover>:last-child{order:-1}mroot,msqrt{position:relative;display:inline-block;border-top:solid thin currentColor;margin-top:.5px;vertical-align:middle;margin-left:1ch}mroot:before,msqrt:before{content:\\\"\\\";display:inline-block;position:absolute;width:1ch;left:-1ch;top:-1px;bottom:0;background-image:url(\" + ___CSS_LOADER_URL_REPLACEMENT_0___ + \")}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/mathml.scss\"],\"names\":[],\"mappings\":\"AAAA,+CAAA,CAEA,KACI,oBAAA,CACA,mBAAA,CAGJ,MACI,oBAAA,CACA,mBAAA,CACA,iBAAA,CAEA,mBACI,qCAAA,CAGJ,QACI,aAAA,CAKJ,mBACI,iBAAA,CACA,kBAAA,CAKJ,mBACI,iBAAA,CACA,oBAAA,CAIR,wBACI,mBAAA,CACA,uBAAA,CACA,qBAAA,CACA,iBAAA,CAEA,iFACI,iBAAA,CAKJ,uBAAA,QAAA,CAGJ,YACI,iBAAA,CACA,oBAAA,CACA,kCAAA,CACA,eAAA,CACA,qBAAA,CACA,eAAA,CAEA,0BACI,UAAA,CACA,oBAAA,CACA,iBAAA,CACA,SAAA,CACA,SAAA,CACA,QAAA,CACA,QAAA,CACA,wDAAA\",\"sourcesContent\":[\"@namespace \\\"http://www.w3.org/1998/Math/MathML\\\";\\r\\n\\r\\nmath {\\r\\n    display: inline-block;\\r\\n    line-height: initial;\\r\\n}\\r\\n\\r\\nmfrac {\\r\\n    display: inline-block;\\r\\n    vertical-align: -50%;\\r\\n    text-align: center;\\r\\n\\r\\n    &>:first-child {\\r\\n        border-bottom: solid thin currentColor;\\r\\n    }\\r\\n\\r\\n    &>* {\\r\\n        display: block;\\r\\n    }\\r\\n}\\r\\n\\r\\nmsub {\\r\\n    &>:nth-child(2) {\\r\\n        font-size: smaller;\\r\\n        vertical-align: sub;\\r\\n    }\\r\\n}\\r\\n\\r\\nmsup {\\r\\n    &>:nth-child(2) {\\r\\n        font-size: smaller;\\r\\n        vertical-align: super;\\r\\n    }\\r\\n}\\r\\n\\r\\nmunder, mover, munderover {\\r\\n    display: inline-flex;\\r\\n    flex-flow: column nowrap;\\r\\n    vertical-align: middle;\\r\\n    text-align: center;\\r\\n\\r\\n    &>:not(:first-child) {\\r\\n        font-size: smaller;\\r\\n    }\\r\\n}\\r\\n\\r\\nmunderover {\\r\\n    &>:last-child { order: -1; }\\r\\n}\\r\\n\\r\\nmroot, msqrt {\\r\\n    position: relative;\\r\\n    display: inline-block;\\r\\n    border-top: solid thin currentColor;  \\r\\n    margin-top: 0.5px;\\r\\n    vertical-align: middle;  \\r\\n    margin-left: 1ch; \\r\\n\\r\\n    &:before {\\r\\n        content: \\\"\\\";\\r\\n        display: inline-block;\\r\\n        position: absolute;\\r\\n        width: 1ch;\\r\\n        left: -1ch;\\r\\n        top: -1px;\\r\\n        bottom: 0;\\r\\n        background-image: url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 100' preserveAspectRatio='none'%3E%3Cpath d='m0,75 l5,0 l5,25 l10,-100' stroke='black' fill='none' vector-effect='non-scaling-stroke'/%3E%3C/svg%3E\\\");\\r\\n    }\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___.toString();\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    options = {};\n  }\n\n  if (!url) {\n    return url;\n  }\n\n  url = String(url.__esModule ? url.default : url); // If url is already wrapped in quotes, remove them\n\n  if (/^['\"].*['\"]$/.test(url)) {\n    url = url.slice(1, -1);\n  }\n\n  if (options.hash) {\n    url += options.hash;\n  } // Should url be wrapped?\n  // See https://drafts.csswg.org/css-values-3/#urls\n\n\n  if (/[\"'() \\t\\n]|(%20)/.test(url) || options.needQuotes) {\n    return \"\\\"\".concat(url.replace(/\"/g, '\\\\\"').replace(/\\n/g, \"\\\\n\"), \"\\\"\");\n  }\n\n  return url;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","import * as JSZip from \"jszip\";\r\nimport { parseXmlString, XmlParser } from \"../parser/xml-parser\";\r\nimport { splitPath } from \"../utils\";\r\nimport { parseRelationships, Relationship } from \"./relationship\";\r\n\r\nexport interface OpenXmlPackageOptions {\r\n    trimXmlDeclaration: boolean,\r\n    keepOrigin: boolean,\r\n}\r\n\r\nexport class OpenXmlPackage {\r\n    xmlParser: XmlParser = new XmlParser();\r\n\r\n    constructor(private _zip: JSZip, public options: OpenXmlPackageOptions) {\r\n    }\r\n\r\n    get(path: string): any {\r\n        return this._zip.files[normalizePath(path)];\r\n    }\r\n\r\n    update(path: string, content: any) {\r\n        this._zip.file(path, content);\r\n    }\r\n\r\n    static load(input: Blob | any, options: OpenXmlPackageOptions): Promise<OpenXmlPackage> {\r\n        return JSZip.loadAsync(input).then(zip => new OpenXmlPackage(zip, options));\r\n    }\r\n\r\n    save(type: any = \"blob\"): Promise<any>  {\r\n        return this._zip.generateAsync({ type });\r\n    }\r\n\r\n    load(path: string, type: JSZip.OutputType = \"string\"): Promise<any> {\r\n        return this.get(path)?.async(type) ?? Promise.resolve(null);\r\n    }\r\n\r\n    loadRelationships(path: string = null): Promise<Relationship[]> {\r\n        let relsPath = `_rels/.rels`;\r\n\r\n        if (path != null) {\r\n            const [f, fn] = splitPath(path);\r\n            relsPath = `${f}_rels/${fn}.rels`;\r\n        }\r\n\r\n        return this.load(relsPath)\r\n            .then(txt => txt ? parseRelationships(this.parseXmlDocument(txt).firstElementChild, this.xmlParser) : null);\r\n    }\r\n\r\n    /** @internal */\r\n    parseXmlDocument(txt: string): Document {\r\n        return parseXmlString(txt, this.options.trimXmlDeclaration);\r\n    }\r\n}\r\n\r\nfunction normalizePath(path: string) {\r\n    return path.startsWith('/') ? path.substr(1) : path;\r\n}","import { serializeXmlString } from \"../parser/xml-parser\";\r\nimport { OpenXmlPackage } from \"./open-xml-package\";\r\nimport { Relationship } from \"./relationship\";\r\n\r\nexport class Part {\r\n    protected _xmlDocument: Document;\r\n\r\n    rels: Relationship[];\r\n\r\n    constructor(protected _package: OpenXmlPackage, public path: string) {\r\n    }\r\n\r\n    load(): Promise<any> {\r\n        return Promise.all([\r\n            this._package.loadRelationships(this.path).then(rels => {\r\n                this.rels = rels;\r\n            }),\r\n            this._package.load(this.path).then(text => {\r\n                const xmlDoc = this._package.parseXmlDocument(text);\r\n\r\n                if (this._package.options.keepOrigin) {\r\n                    this._xmlDocument = xmlDoc;\r\n                }\r\n\r\n                this.parseXml(xmlDoc.firstElementChild);\r\n            })\r\n        ]);\r\n    }\r\n\r\n    save() {\r\n        this._package.update(this.path, serializeXmlString(this._xmlDocument));\r\n    }\r\n\r\n    protected parseXml(root: Element) {\r\n    }\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\n\r\nexport interface Relationship {\r\n    id: string,\r\n    type: RelationshipTypes | string,\r\n    target: string\r\n    targetMode: \"\" | \"External\" | string \r\n}\r\n\r\nexport enum RelationshipTypes {\r\n    OfficeDocument = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\r\n    FontTable = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable\",\r\n    Image = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",\r\n    Numbering = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering\",\r\n    Styles = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\r\n    StylesWithEffects = \"http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects\",\r\n    Theme = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\r\n    Settings = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings\",\r\n    WebSettings = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings\",\r\n    Hyperlink = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\r\n    Footnotes = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes\",\r\n\tEndnotes = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes\",\r\n    Footer = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\",\r\n    Header = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\",\r\n    ExtendedProperties = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\",\r\n    CoreProperties = \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\r\n\tCustomProperties = \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties\",\r\n}\r\n\r\nexport function parseRelationships(root: Element, xml: XmlParser): Relationship[] {\r\n    return xml.elements(root).map(e => <Relationship>{\r\n        id: xml.attr(e, \"Id\"),\r\n        type: xml.attr(e, \"Type\"),\r\n        target: xml.attr(e, \"Target\"),\r\n        targetMode: xml.attr(e, \"TargetMode\")\r\n    });\r\n}","import {\r\n\tDomType, WmlTable, IDomNumbering,\r\n\tWmlHyperlink, IDomImage, OpenXmlElement, WmlTableColumn, WmlTableCell,\r\n\tWmlTableRow, NumberingPicBullet, WmlText, WmlSymbol, WmlBreak, WmlNoteReference\r\n} from './document/dom';\r\nimport { DocumentElement } from './document/document';\r\nimport { WmlParagraph, parseParagraphProperties, parseParagraphProperty } from './document/paragraph';\r\nimport { parseSectionProperties } from './document/section';\r\nimport xml from './parser/xml-parser';\r\nimport { parseRunProperties, WmlRun } from './document/run';\r\nimport { parseBookmarkEnd, parseBookmarkStart } from './document/bookmarks';\r\nimport { IDomStyle, IDomSubStyle } from './document/style';\r\nimport { WmlFieldChar, WmlFieldSimple, WmlInstructionText } from './document/fields';\r\nimport { convertLength, LengthUsage, LengthUsageType } from './document/common';\r\nimport { parseVmlElement } from './vml/vml';\r\n\r\nexport var autos = {\r\n\tshd: \"inherit\",\r\n\tcolor: \"black\",\r\n\tborderColor: \"black\",\r\n\thighlight: \"transparent\"\r\n};\r\n\r\nconst supportedNamespaceURIs = [];\r\n\r\nconst mmlTagMap = {\r\n\t\"oMath\": DomType.MmlMath,\r\n\t\"oMathPara\": DomType.MmlMathParagraph,\r\n\t\"f\": DomType.MmlFraction,\r\n\t\"num\": DomType.MmlNumerator,\r\n\t\"den\": DomType.MmlDenominator,\r\n\t\"rad\": DomType.MmlRadical,\r\n\t\"deg\": DomType.MmlDegree,\r\n\t\"e\": DomType.MmlBase,\r\n\t\"sSup\": DomType.MmlSuperscript,\r\n\t\"sSub\": DomType.MmlSubscript,\r\n\t\"sup\": DomType.MmlSuperArgument,\r\n\t\"sub\": DomType.MmlSubArgument,\r\n\t\"d\": DomType.MmlDelimiter,\r\n\t\"nary\": DomType.MmlNary\r\n}\r\n\r\nexport interface DocumentParserOptions {\r\n\tignoreWidth: boolean;\r\n\tdebug: boolean;\r\n}\r\n\r\nexport class DocumentParser {\r\n\toptions: DocumentParserOptions;\r\n\r\n\tconstructor(options?: Partial<DocumentParserOptions>) {\r\n\t\tthis.options = {\r\n\t\t\tignoreWidth: false,\r\n\t\t\tdebug: false,\r\n\t\t\t...options\r\n\t\t};\r\n\t}\r\n\r\n\tparseNotes(xmlDoc: Element, elemName: string, elemClass: any): any[] {\r\n\t\tvar result = [];\r\n\r\n\t\tfor (let el of xml.elements(xmlDoc, elemName)) {\r\n\t\t\tconst node = new elemClass();\r\n\t\t\tnode.id = xml.attr(el, \"id\");\r\n\t\t\tnode.noteType = xml.attr(el, \"type\");\r\n\t\t\tnode.children = this.parseBodyElements(el);\r\n\t\t\tresult.push(node);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseDocumentFile(xmlDoc: Element): DocumentElement {\r\n\t\tvar xbody = xml.element(xmlDoc, \"body\");\r\n\t\tvar background = xml.element(xmlDoc, \"background\");\r\n\t\tvar sectPr = xml.element(xbody, \"sectPr\");\r\n\r\n\t\treturn {\r\n\t\t\ttype: DomType.Document,\r\n\t\t\tchildren: this.parseBodyElements(xbody),\r\n\t\t\tprops: sectPr ? parseSectionProperties(sectPr, xml) : null,\r\n\t\t\tcssStyle: background ? this.parseBackground(background) : {},\r\n\t\t};\r\n\t}\r\n\r\n\tparseBackground(elem: Element): any {\r\n\t\tvar result = {};\r\n\t\tvar color = xmlUtil.colorAttr(elem, \"color\");\r\n\r\n\t\tif (color) {\r\n\t\t\tresult[\"background-color\"] = color;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseBodyElements(element: Element): OpenXmlElement[] {\r\n\t\tvar children = [];\r\n\r\n\t\tfor (let elem of xml.elements(element)) {\r\n\t\t\tswitch (elem.localName) {\r\n\t\t\t\tcase \"p\":\r\n\t\t\t\t\tchildren.push(this.parseParagraph(elem));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tbl\":\r\n\t\t\t\t\tchildren.push(this.parseTable(elem));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"sdt\":\r\n\t\t\t\t\tchildren.push(...this.parseSdt(elem, e => this.parseBodyElements(e)));\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn children;\r\n\t}\r\n\r\n\tparseStylesFile(xstyles: Element): IDomStyle[] {\r\n\t\tvar result = [];\r\n\r\n\t\txmlUtil.foreach(xstyles, n => {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"style\":\r\n\t\t\t\t\tresult.push(this.parseStyle(n));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"docDefaults\":\r\n\t\t\t\t\tresult.push(this.parseDefaultStyles(n));\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseDefaultStyles(node: Element): IDomStyle {\r\n\t\tvar result = <IDomStyle>{\r\n\t\t\tid: null,\r\n\t\t\tname: null,\r\n\t\t\ttarget: null,\r\n\t\t\tbasedOn: null,\r\n\t\t\tstyles: []\r\n\t\t};\r\n\r\n\t\txmlUtil.foreach(node, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"rPrDefault\":\r\n\t\t\t\t\tvar rPr = xml.element(c, \"rPr\");\r\n\r\n\t\t\t\t\tif (rPr)\r\n\t\t\t\t\t\tresult.styles.push({\r\n\t\t\t\t\t\t\ttarget: \"span\",\r\n\t\t\t\t\t\t\tvalues: this.parseDefaultProperties(rPr, {})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"pPrDefault\":\r\n\t\t\t\t\tvar pPr = xml.element(c, \"pPr\");\r\n\r\n\t\t\t\t\tif (pPr)\r\n\t\t\t\t\t\tresult.styles.push({\r\n\t\t\t\t\t\t\ttarget: \"p\",\r\n\t\t\t\t\t\t\tvalues: this.parseDefaultProperties(pPr, {})\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseStyle(node: Element): IDomStyle {\r\n\t\tvar result = <IDomStyle>{\r\n\t\t\tid: xml.attr(node, \"styleId\"),\r\n\t\t\tisDefault: xml.boolAttr(node, \"default\"),\r\n\t\t\tname: null,\r\n\t\t\ttarget: null,\r\n\t\t\tbasedOn: null,\r\n\t\t\tstyles: [],\r\n\t\t\tlinked: null\r\n\t\t};\r\n\r\n\t\tswitch (xml.attr(node, \"type\")) {\r\n\t\t\tcase \"paragraph\": result.target = \"p\"; break;\r\n\t\t\tcase \"table\": result.target = \"table\"; break;\r\n\t\t\tcase \"character\": result.target = \"span\"; break;\r\n\t\t\t//case \"numbering\": result.target = \"p\"; break;\r\n\t\t}\r\n\r\n\t\txmlUtil.foreach(node, n => {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"basedOn\":\r\n\t\t\t\t\tresult.basedOn = xml.attr(n, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"name\":\r\n\t\t\t\t\tresult.name = xml.attr(n, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"link\":\r\n\t\t\t\t\tresult.linked = xml.attr(n, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"next\":\r\n\t\t\t\t\tresult.next = xml.attr(n, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"aliases\":\r\n\t\t\t\t\tresult.aliases = xml.attr(n, \"val\").split(\",\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"pPr\":\r\n\t\t\t\t\tresult.styles.push({\r\n\t\t\t\t\t\ttarget: \"p\",\r\n\t\t\t\t\t\tvalues: this.parseDefaultProperties(n, {})\r\n\t\t\t\t\t});\r\n\t\t\t\t\tresult.paragraphProps = parseParagraphProperties(n, xml);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"rPr\":\r\n\t\t\t\t\tresult.styles.push({\r\n\t\t\t\t\t\ttarget: \"span\",\r\n\t\t\t\t\t\tvalues: this.parseDefaultProperties(n, {})\r\n\t\t\t\t\t});\r\n\t\t\t\t\tresult.runProps = parseRunProperties(n, xml);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblPr\":\r\n\t\t\t\tcase \"tcPr\":\r\n\t\t\t\t\tresult.styles.push({\r\n\t\t\t\t\t\ttarget: \"td\", //TODO: maybe move to processor\r\n\t\t\t\t\t\tvalues: this.parseDefaultProperties(n, {})\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblStylePr\":\r\n\t\t\t\t\tfor (let s of this.parseTableStyle(n))\r\n\t\t\t\t\t\tresult.styles.push(s);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"rsid\":\r\n\t\t\t\tcase \"qFormat\":\r\n\t\t\t\tcase \"hidden\":\r\n\t\t\t\tcase \"semiHidden\":\r\n\t\t\t\tcase \"unhideWhenUsed\":\r\n\t\t\t\tcase \"autoRedefine\":\r\n\t\t\t\tcase \"uiPriority\":\r\n\t\t\t\t\t//TODO: ignore\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.options.debug && console.warn(`DOCX: Unknown style element: ${n.localName}`);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseTableStyle(node: Element): IDomSubStyle[] {\r\n\t\tvar result = [];\r\n\r\n\t\tvar type = xml.attr(node, \"type\");\r\n\t\tvar selector = \"\";\r\n\t\tvar modificator = \"\";\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase \"firstRow\":\r\n\t\t\t\tmodificator = \".first-row\";\r\n\t\t\t\tselector = \"tr.first-row td\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"lastRow\":\r\n\t\t\t\tmodificator = \".last-row\";\r\n\t\t\t\tselector = \"tr.last-row td\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"firstCol\":\r\n\t\t\t\tmodificator = \".first-col\";\r\n\t\t\t\tselector = \"td.first-col\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"lastCol\":\r\n\t\t\t\tmodificator = \".last-col\";\r\n\t\t\t\tselector = \"td.last-col\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"band1Vert\":\r\n\t\t\t\tmodificator = \":not(.no-vband)\";\r\n\t\t\t\tselector = \"td.odd-col\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"band2Vert\":\r\n\t\t\t\tmodificator = \":not(.no-vband)\";\r\n\t\t\t\tselector = \"td.even-col\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"band1Horz\":\r\n\t\t\t\tmodificator = \":not(.no-hband)\";\r\n\t\t\t\tselector = \"tr.odd-row\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"band2Horz\":\r\n\t\t\t\tmodificator = \":not(.no-hband)\";\r\n\t\t\t\tselector = \"tr.even-row\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: return [];\r\n\t\t}\r\n\r\n\t\txmlUtil.foreach(node, n => {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"pPr\":\r\n\t\t\t\t\tresult.push({\r\n\t\t\t\t\t\ttarget: `${selector} p`,\r\n\t\t\t\t\t\tmod: modificator,\r\n\t\t\t\t\t\tvalues: this.parseDefaultProperties(n, {})\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"rPr\":\r\n\t\t\t\t\tresult.push({\r\n\t\t\t\t\t\ttarget: `${selector} span`,\r\n\t\t\t\t\t\tmod: modificator,\r\n\t\t\t\t\t\tvalues: this.parseDefaultProperties(n, {})\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblPr\":\r\n\t\t\t\tcase \"tcPr\":\r\n\t\t\t\t\tresult.push({\r\n\t\t\t\t\t\ttarget: selector, //TODO: maybe move to processor\r\n\t\t\t\t\t\tmod: modificator,\r\n\t\t\t\t\t\tvalues: this.parseDefaultProperties(n, {})\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseNumberingFile(xnums: Element): IDomNumbering[] {\r\n\t\tvar result = [];\r\n\t\tvar mapping = {};\r\n\t\tvar bullets = [];\r\n\r\n\t\txmlUtil.foreach(xnums, n => {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"abstractNum\":\r\n\t\t\t\t\tthis.parseAbstractNumbering(n, bullets)\r\n\t\t\t\t\t\t.forEach(x => result.push(x));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"numPicBullet\":\r\n\t\t\t\t\tbullets.push(this.parseNumberingPicBullet(n));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"num\":\r\n\t\t\t\t\tvar numId = xml.attr(n, \"numId\");\r\n\t\t\t\t\tvar abstractNumId = xml.elementAttr(n, \"abstractNumId\", \"val\");\r\n\t\t\t\t\tmapping[abstractNumId] = numId;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tresult.forEach(x => x.id = mapping[x.id]);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseNumberingPicBullet(elem: Element): NumberingPicBullet {\r\n\t\tvar pict = xml.element(elem, \"pict\");\r\n\t\tvar shape = pict && xml.element(pict, \"shape\");\r\n\t\tvar imagedata = shape && xml.element(shape, \"imagedata\");\r\n\r\n\t\treturn imagedata ? {\r\n\t\t\tid: xml.intAttr(elem, \"numPicBulletId\"),\r\n\t\t\tsrc: xml.attr(imagedata, \"id\"),\r\n\t\t\tstyle: xml.attr(shape, \"style\")\r\n\t\t} : null;\r\n\t}\r\n\r\n\tparseAbstractNumbering(node: Element, bullets: any[]): IDomNumbering[] {\r\n\t\tvar result = [];\r\n\t\tvar id = xml.attr(node, \"abstractNumId\");\r\n\r\n\t\txmlUtil.foreach(node, n => {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"lvl\":\r\n\t\t\t\t\tresult.push(this.parseNumberingLevel(id, n, bullets));\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseNumberingLevel(id: string, node: Element, bullets: any[]): IDomNumbering {\r\n\t\tvar result: IDomNumbering = {\r\n\t\t\tid: id,\r\n\t\t\tlevel: xml.intAttr(node, \"ilvl\"),\r\n\t\t\tpStyleName: undefined,\r\n\t\t\tpStyle: {},\r\n\t\t\trStyle: {},\r\n\t\t\tsuff: \"tab\"\r\n\t\t};\r\n\r\n\t\txmlUtil.foreach(node, n => {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"pPr\":\r\n\t\t\t\t\tthis.parseDefaultProperties(n, result.pStyle);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"rPr\":\r\n\t\t\t\t\tthis.parseDefaultProperties(n, result.rStyle);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"lvlPicBulletId\":\r\n\t\t\t\t\tvar id = xml.intAttr(n, \"val\");\r\n\t\t\t\t\tresult.bullet = bullets.find(x => x.id == id);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"lvlText\":\r\n\t\t\t\t\tresult.levelText = xml.attr(n, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"pStyle\":\r\n\t\t\t\t\tresult.pStyleName = xml.attr(n, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"numFmt\":\r\n\t\t\t\t\tresult.format = xml.attr(n, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"suff\":\r\n\t\t\t\t\tresult.suff = xml.attr(n, \"val\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseSdt(node: Element, parser: Function): OpenXmlElement[] {\r\n\t\tconst sdtContent = xml.element(node, \"sdtContent\");\r\n\t\treturn sdtContent ? parser(sdtContent) : [];\r\n\t}\r\n\r\n\tparseInserted(node: Element, parentParser: Function): OpenXmlElement {\r\n\t\treturn <OpenXmlElement>{ \r\n\t\t\ttype: DomType.Inserted, \r\n\t\t\tchildren: parentParser(node)?.children ?? []\r\n\t\t};\r\n\t}\r\n\r\n\tparseDeleted(node: Element, parentParser: Function): OpenXmlElement {\r\n\t\treturn <OpenXmlElement>{ \r\n\t\t\ttype: DomType.Deleted, \r\n\t\t\tchildren: parentParser(node)?.children ?? []\r\n\t\t};\r\n\t}\r\n\r\n\tparseParagraph(node: Element): OpenXmlElement {\r\n\t\tvar result = <WmlParagraph>{ type: DomType.Paragraph, children: [] };\r\n\r\n\t\tfor (let el of xml.elements(node)) {\r\n\t\t\tswitch (el.localName) {\r\n\t\t\t\tcase \"pPr\":\r\n\t\t\t\t\tthis.parseParagraphProperties(el, result);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"r\":\r\n\t\t\t\t\tresult.children.push(this.parseRun(el, result));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"hyperlink\":\r\n\t\t\t\t\tresult.children.push(this.parseHyperlink(el, result));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"bookmarkStart\":\r\n\t\t\t\t\tresult.children.push(parseBookmarkStart(el, xml));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"bookmarkEnd\":\r\n\t\t\t\t\tresult.children.push(parseBookmarkEnd(el, xml));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"oMath\":\r\n\t\t\t\tcase \"oMathPara\":\r\n\t\t\t\t\tresult.children.push(this.parseMathElement(el));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"sdt\":\r\n\t\t\t\t\tresult.children.push(...this.parseSdt(el, e => this.parseParagraph(e).children));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"ins\":\r\n\t\t\t\t\tresult.children.push(this.parseInserted(el, e => this.parseParagraph(e)));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"del\":\r\n\t\t\t\t\tresult.children.push(this.parseDeleted(el, e => this.parseParagraph(e)));\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseParagraphProperties(elem: Element, paragraph: WmlParagraph) {\r\n\t\tthis.parseDefaultProperties(elem, paragraph.cssStyle = {}, null, c => {\r\n\t\t\tif (parseParagraphProperty(c, paragraph, xml))\r\n\t\t\t\treturn true;\r\n\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"pStyle\":\r\n\t\t\t\t\tparagraph.styleName = xml.attr(c, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"cnfStyle\":\r\n\t\t\t\t\tparagraph.className = values.classNameOfCnfStyle(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"framePr\":\r\n\t\t\t\t\tthis.parseFrame(c, paragraph);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"rPr\":\r\n\t\t\t\t\t//TODO ignore\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\r\n\tparseFrame(node: Element, paragraph: WmlParagraph) {\r\n\t\tvar dropCap = xml.attr(node, \"dropCap\");\r\n\r\n\t\tif (dropCap == \"drop\")\r\n\t\t\tparagraph.cssStyle[\"float\"] = \"left\";\r\n\t}\r\n\r\n\tparseHyperlink(node: Element, parent?: OpenXmlElement): WmlHyperlink {\r\n\t\tvar result: WmlHyperlink = <WmlHyperlink>{ type: DomType.Hyperlink, parent: parent, children: [] };\r\n\t\tvar anchor = xml.attr(node, \"anchor\");\r\n\t\tvar relId = xml.attr(node, \"id\");\r\n\r\n\t\tif (anchor)\r\n\t\t\tresult.href = \"#\" + anchor;\r\n\r\n\t\tif (relId)\r\n\t\t\tresult.id = relId;\r\n\r\n\t\txmlUtil.foreach(node, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"r\":\r\n\t\t\t\t\tresult.children.push(this.parseRun(c, result));\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseRun(node: Element, parent?: OpenXmlElement): WmlRun {\r\n\t\tvar result: WmlRun = <WmlRun>{ type: DomType.Run, parent: parent, children: [] };\r\n\r\n\t\txmlUtil.foreach(node, c => {\r\n\t\t\tc = this.checkAlternateContent(c);\r\n\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"t\":\r\n\t\t\t\t\tresult.children.push(<WmlText>{\r\n\t\t\t\t\t\ttype: DomType.Text,\r\n\t\t\t\t\t\ttext: c.textContent\r\n\t\t\t\t\t});//.replace(\" \", \"\\u00A0\"); // TODO\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"delText\":\r\n\t\t\t\t\tresult.children.push(<WmlText>{\r\n\t\t\t\t\t\ttype: DomType.DeletedText,\r\n\t\t\t\t\t\ttext: c.textContent\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"fldSimple\":\r\n\t\t\t\t\tresult.children.push(<WmlFieldSimple>{\r\n\t\t\t\t\t\ttype: DomType.SimpleField,\r\n\t\t\t\t\t\tinstruction: xml.attr(c, \"instr\"),\r\n\t\t\t\t\t\tlock: xml.boolAttr(c, \"lock\", false),\r\n\t\t\t\t\t\tdirty: xml.boolAttr(c, \"dirty\", false)\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"instrText\":\r\n\t\t\t\t\tresult.fieldRun = true;\r\n\t\t\t\t\tresult.children.push(<WmlInstructionText>{\r\n\t\t\t\t\t\ttype: DomType.Instruction,\r\n\t\t\t\t\t\ttext: c.textContent\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"fldChar\":\r\n\t\t\t\t\tresult.fieldRun = true;\r\n\t\t\t\t\tresult.children.push(<WmlFieldChar>{\r\n\t\t\t\t\t\ttype: DomType.ComplexField,\r\n\t\t\t\t\t\tcharType: xml.attr(c, \"fldCharType\"),\r\n\t\t\t\t\t\tlock: xml.boolAttr(c, \"lock\", false),\r\n\t\t\t\t\t\tdirty: xml.boolAttr(c, \"dirty\", false)\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"noBreakHyphen\":\r\n\t\t\t\t\tresult.children.push({ type: DomType.NoBreakHyphen });\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"br\":\r\n\t\t\t\t\tresult.children.push(<WmlBreak>{\r\n\t\t\t\t\t\ttype: DomType.Break,\r\n\t\t\t\t\t\tbreak: xml.attr(c, \"type\") || \"textWrapping\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"lastRenderedPageBreak\":\r\n\t\t\t\t\tresult.children.push(<WmlBreak>{\r\n\t\t\t\t\t\ttype: DomType.Break,\r\n\t\t\t\t\t\tbreak: \"lastRenderedPageBreak\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"sym\":\r\n\t\t\t\t\tresult.children.push(<WmlSymbol>{\r\n\t\t\t\t\t\ttype: DomType.Symbol,\r\n\t\t\t\t\t\tfont: xml.attr(c, \"font\"),\r\n\t\t\t\t\t\tchar: xml.attr(c, \"char\")\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tab\":\r\n\t\t\t\t\tresult.children.push({ type: DomType.Tab });\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"footnoteReference\":\r\n\t\t\t\t\tresult.children.push(<WmlNoteReference>{\r\n\t\t\t\t\t\ttype: DomType.FootnoteReference,\r\n\t\t\t\t\t\tid: xml.attr(c, \"id\")\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"endnoteReference\":\r\n\t\t\t\t\tresult.children.push(<WmlNoteReference>{\r\n\t\t\t\t\t\ttype: DomType.EndnoteReference,\r\n\t\t\t\t\t\tid: xml.attr(c, \"id\")\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"drawing\":\r\n\t\t\t\t\tlet d = this.parseDrawing(c);\r\n\r\n\t\t\t\t\tif (d)\r\n\t\t\t\t\t\tresult.children = [d];\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"pict\":\r\n\t\t\t\t\tresult.children.push(this.parseVmlPicture(c));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"rPr\":\r\n\t\t\t\t\tthis.parseRunProperties(c, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseMathElement(elem: Element): OpenXmlElement {\r\n\t\tconst propsTag = `${elem.localName}Pr`;\r\n\t\tconst result = { type: mmlTagMap[elem.localName], children: [] } as OpenXmlElement;\r\n\r\n\t\tfor (const el of xml.elements(elem)) {\r\n\t\t\tconst childType = mmlTagMap[el.localName];\r\n\r\n\t\t\tif (childType) {\r\n\t\t\t\tresult.children.push(this.parseMathElement(el));\r\n\t\t\t} else if (el.localName == \"r\") {\r\n\t\t\t\tresult.children.push(this.parseRun(el));\r\n\t\t\t} else if (el.localName == propsTag) {\r\n\t\t\t\tresult.props = this.parseMathProperies(el);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseMathProperies(elem: Element): Record<string, any> {\r\n\t\tconst result: Record<string, any> = {};\r\n\r\n\t\tfor (const el of xml.elements(elem)) {\r\n\t\t\tswitch (el.localName) {\r\n\t\t\t\tcase \"chr\": result.char = xml.attr(el, \"val\"); break;\r\n\t\t\t\tcase \"degHide\": result.hideDegree = xml.boolAttr(el, \"val\"); break;\r\n\t\t\t\tcase \"begChr\": result.beginChar = xml.attr(el, \"val\"); break;\r\n\t\t\t\tcase \"endChr\": result.endChar = xml.attr(el, \"val\"); break;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseRunProperties(elem: Element, run: WmlRun) {\r\n\t\tthis.parseDefaultProperties(elem, run.cssStyle = {}, null, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"rStyle\":\r\n\t\t\t\t\trun.styleName = xml.attr(c, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"vertAlign\":\r\n\t\t\t\t\trun.verticalAlign = values.valueOfVertAlign(c, true);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\r\n\tparseVmlPicture(elem: Element): OpenXmlElement {\r\n\t\tconst result = { type: DomType.VmlPicture, children: [] };\r\n\r\n\t\tfor (const el of xml.elements(elem)) {\r\n\t\t\tconst child = parseVmlElement(el);\r\n\t\t\tchild && result.children.push(child);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tcheckAlternateContent(elem: Element): Element {\r\n\t\tif (elem.localName != 'AlternateContent')\r\n\t\t\treturn elem;\r\n\r\n\t\tvar choice = xml.element(elem, \"Choice\");\r\n\r\n\t\tif (choice) {\r\n\t\t\tvar requires = xml.attr(choice, \"Requires\");\r\n\t\t\tvar namespaceURI = elem.lookupNamespaceURI(requires);\r\n\r\n\t\t\tif (supportedNamespaceURIs.includes(namespaceURI))\r\n\t\t\t\treturn choice.firstElementChild;\r\n\t\t}\r\n\r\n\t\treturn xml.element(elem, \"Fallback\")?.firstElementChild;\r\n\t}\r\n\r\n\tparseDrawing(node: Element): OpenXmlElement {\r\n\t\tfor (var n of xml.elements(node)) {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"inline\":\r\n\t\t\t\tcase \"anchor\":\r\n\t\t\t\t\treturn this.parseDrawingWrapper(n);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tparseDrawingWrapper(node: Element): OpenXmlElement {\r\n\t\tvar result = <OpenXmlElement>{ type: DomType.Drawing, children: [], cssStyle: {} };\r\n\t\tvar isAnchor = node.localName == \"anchor\";\r\n\r\n\t\t//TODO\r\n\t\t// result.style[\"margin-left\"] = xml.sizeAttr(node, \"distL\", SizeType.Emu);\r\n\t\t// result.style[\"margin-top\"] = xml.sizeAttr(node, \"distT\", SizeType.Emu);\r\n\t\t// result.style[\"margin-right\"] = xml.sizeAttr(node, \"distR\", SizeType.Emu);\r\n\t\t// result.style[\"margin-bottom\"] = xml.sizeAttr(node, \"distB\", SizeType.Emu);\r\n\r\n\t\tlet wrapType: \"wrapTopAndBottom\" | \"wrapNone\" | null = null;\r\n\t\tlet simplePos = xml.boolAttr(node, \"simplePos\");\r\n\r\n\t\tlet posX = { relative: \"page\", align: \"left\", offset: \"0\" };\r\n\t\tlet posY = { relative: \"page\", align: \"top\", offset: \"0\" };\r\n\r\n\t\tfor (var n of xml.elements(node)) {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"simplePos\":\r\n\t\t\t\t\tif (simplePos) {\r\n\t\t\t\t\t\tposX.offset = xml.lengthAttr(n, \"x\", LengthUsage.Emu);\r\n\t\t\t\t\t\tposY.offset = xml.lengthAttr(n, \"y\", LengthUsage.Emu);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"extent\":\r\n\t\t\t\t\tresult.cssStyle[\"width\"] = xml.lengthAttr(n, \"cx\", LengthUsage.Emu);\r\n\t\t\t\t\tresult.cssStyle[\"height\"] = xml.lengthAttr(n, \"cy\", LengthUsage.Emu);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"positionH\":\r\n\t\t\t\tcase \"positionV\":\r\n\t\t\t\t\tif (!simplePos) {\r\n\t\t\t\t\t\tlet pos = n.localName == \"positionH\" ? posX : posY;\r\n\t\t\t\t\t\tvar alignNode = xml.element(n, \"align\");\r\n\t\t\t\t\t\tvar offsetNode = xml.element(n, \"posOffset\");\r\n\r\n\t\t\t\t\t\tpos.relative = xml.attr(n, \"relativeFrom\") ?? pos.relative;\r\n\r\n\t\t\t\t\t\tif (alignNode)\r\n\t\t\t\t\t\t\tpos.align = alignNode.textContent;\r\n\r\n\t\t\t\t\t\tif (offsetNode)\r\n\t\t\t\t\t\t\tpos.offset = xmlUtil.sizeValue(offsetNode, LengthUsage.Emu);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"wrapTopAndBottom\":\r\n\t\t\t\t\twrapType = \"wrapTopAndBottom\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"wrapNone\":\r\n\t\t\t\t\twrapType = \"wrapNone\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"graphic\":\r\n\t\t\t\t\tvar g = this.parseGraphic(n);\r\n\r\n\t\t\t\t\tif (g)\r\n\t\t\t\t\t\tresult.children.push(g);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (wrapType == \"wrapTopAndBottom\") {\r\n\t\t\tresult.cssStyle['display'] = 'block';\r\n\r\n\t\t\tif (posX.align) {\r\n\t\t\t\tresult.cssStyle['text-align'] = posX.align;\r\n\t\t\t\tresult.cssStyle['width'] = \"100%\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (wrapType == \"wrapNone\") {\r\n\t\t\tresult.cssStyle['display'] = 'block';\r\n\t\t\tresult.cssStyle['position'] = 'relative';\r\n\t\t\tresult.cssStyle[\"width\"] = \"0px\";\r\n\t\t\tresult.cssStyle[\"height\"] = \"0px\";\r\n\r\n\t\t\tif (posX.offset)\r\n\t\t\t\tresult.cssStyle[\"left\"] = posX.offset;\r\n\t\t\tif (posY.offset)\r\n\t\t\t\tresult.cssStyle[\"top\"] = posY.offset;\r\n\t\t}\r\n\t\telse if (isAnchor && (posX.align == 'left' || posX.align == 'right')) {\r\n\t\t\tresult.cssStyle[\"float\"] = posX.align;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseGraphic(elem: Element): OpenXmlElement {\r\n\t\tvar graphicData = xml.element(elem, \"graphicData\");\r\n\r\n\t\tfor (let n of xml.elements(graphicData)) {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"pic\":\r\n\t\t\t\t\treturn this.parsePicture(n);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tparsePicture(elem: Element): IDomImage {\r\n\t\tvar result = <IDomImage>{ type: DomType.Image, src: \"\", cssStyle: {} };\r\n\t\tvar blipFill = xml.element(elem, \"blipFill\");\r\n\t\tvar blip = xml.element(blipFill, \"blip\");\r\n\r\n\t\tresult.src = xml.attr(blip, \"embed\");\r\n\r\n\t\tvar spPr = xml.element(elem, \"spPr\");\r\n\t\tvar xfrm = xml.element(spPr, \"xfrm\");\r\n\r\n\t\tresult.cssStyle[\"position\"] = \"relative\";\r\n\r\n\t\tfor (var n of xml.elements(xfrm)) {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"ext\":\r\n\t\t\t\t\tresult.cssStyle[\"width\"] = xml.lengthAttr(n, \"cx\", LengthUsage.Emu);\r\n\t\t\t\t\tresult.cssStyle[\"height\"] = xml.lengthAttr(n, \"cy\", LengthUsage.Emu);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"off\":\r\n\t\t\t\t\tresult.cssStyle[\"left\"] = xml.lengthAttr(n, \"x\", LengthUsage.Emu);\r\n\t\t\t\t\tresult.cssStyle[\"top\"] = xml.lengthAttr(n, \"y\", LengthUsage.Emu);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseTable(node: Element): WmlTable {\r\n\t\tvar result: WmlTable = { type: DomType.Table, children: [] };\r\n\r\n\t\txmlUtil.foreach(node, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"tr\":\r\n\t\t\t\t\tresult.children.push(this.parseTableRow(c));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblGrid\":\r\n\t\t\t\t\tresult.columns = this.parseTableColumns(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblPr\":\r\n\t\t\t\t\tthis.parseTableProperties(c, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseTableColumns(node: Element): WmlTableColumn[] {\r\n\t\tvar result = [];\r\n\r\n\t\txmlUtil.foreach(node, n => {\r\n\t\t\tswitch (n.localName) {\r\n\t\t\t\tcase \"gridCol\":\r\n\t\t\t\t\tresult.push({ width: xml.lengthAttr(n, \"w\") });\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseTableProperties(elem: Element, table: WmlTable) {\r\n\t\ttable.cssStyle = {};\r\n\t\ttable.cellStyle = {};\r\n\r\n\t\tthis.parseDefaultProperties(elem, table.cssStyle, table.cellStyle, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"tblStyle\":\r\n\t\t\t\t\ttable.styleName = xml.attr(c, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblLook\":\r\n\t\t\t\t\ttable.className = values.classNameOftblLook(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblpPr\":\r\n\t\t\t\t\tthis.parseTablePosition(c, table);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblStyleColBandSize\":\r\n\t\t\t\t\ttable.colBandSize = xml.intAttr(c, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblStyleRowBandSize\":\r\n\t\t\t\t\ttable.rowBandSize = xml.intAttr(c, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tswitch (table.cssStyle[\"text-align\"]) {\r\n\t\t\tcase \"center\":\r\n\t\t\t\tdelete table.cssStyle[\"text-align\"];\r\n\t\t\t\ttable.cssStyle[\"margin-left\"] = \"auto\";\r\n\t\t\t\ttable.cssStyle[\"margin-right\"] = \"auto\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"right\":\r\n\t\t\t\tdelete table.cssStyle[\"text-align\"];\r\n\t\t\t\ttable.cssStyle[\"margin-left\"] = \"auto\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tparseTablePosition(node: Element, table: WmlTable) {\r\n\t\tvar topFromText = xml.lengthAttr(node, \"topFromText\");\r\n\t\tvar bottomFromText = xml.lengthAttr(node, \"bottomFromText\");\r\n\t\tvar rightFromText = xml.lengthAttr(node, \"rightFromText\");\r\n\t\tvar leftFromText = xml.lengthAttr(node, \"leftFromText\");\r\n\r\n\t\ttable.cssStyle[\"float\"] = 'left';\r\n\t\ttable.cssStyle[\"margin-bottom\"] = values.addSize(table.cssStyle[\"margin-bottom\"], bottomFromText);\r\n\t\ttable.cssStyle[\"margin-left\"] = values.addSize(table.cssStyle[\"margin-left\"], leftFromText);\r\n\t\ttable.cssStyle[\"margin-right\"] = values.addSize(table.cssStyle[\"margin-right\"], rightFromText);\r\n\t\ttable.cssStyle[\"margin-top\"] = values.addSize(table.cssStyle[\"margin-top\"], topFromText);\r\n\t}\r\n\r\n\tparseTableRow(node: Element): WmlTableRow {\r\n\t\tvar result: WmlTableRow = { type: DomType.Row, children: [] };\r\n\r\n\t\txmlUtil.foreach(node, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"tc\":\r\n\t\t\t\t\tresult.children.push(this.parseTableCell(c));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"trPr\":\r\n\t\t\t\t\tthis.parseTableRowProperties(c, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseTableRowProperties(elem: Element, row: WmlTableRow) {\r\n\t\trow.cssStyle = this.parseDefaultProperties(elem, {}, null, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"cnfStyle\":\r\n\t\t\t\t\trow.className = values.classNameOfCnfStyle(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblHeader\":\r\n\t\t\t\t\trow.isHeader = xml.boolAttr(c, \"val\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\r\n\tparseTableCell(node: Element): OpenXmlElement {\r\n\t\tvar result: WmlTableCell = { type: DomType.Cell, children: [] };\r\n\r\n\t\txmlUtil.foreach(node, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"tbl\":\r\n\t\t\t\t\tresult.children.push(this.parseTable(c));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"p\":\r\n\t\t\t\t\tresult.children.push(this.parseParagraph(c));\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tcPr\":\r\n\t\t\t\t\tthis.parseTableCellProperties(c, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tparseTableCellProperties(elem: Element, cell: WmlTableCell) {\r\n\t\tcell.cssStyle = this.parseDefaultProperties(elem, {}, null, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"gridSpan\":\r\n\t\t\t\t\tcell.span = xml.intAttr(c, \"val\", null);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"vMerge\":\r\n\t\t\t\t\tcell.verticalMerge = xml.attr(c, \"val\") ?? \"continue\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"cnfStyle\":\r\n\t\t\t\t\tcell.className = values.classNameOfCnfStyle(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\r\n\tparseDefaultProperties(elem: Element, style: Record<string, string> = null, childStyle: Record<string, string> = null, handler: (prop: Element) => boolean = null): Record<string, string> {\r\n\t\tstyle = style || {};\r\n\r\n\t\txmlUtil.foreach(elem, c => {\r\n\t\t\tif (handler?.(c))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"jc\":\r\n\t\t\t\t\tstyle[\"text-align\"] = values.valueOfJc(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"textAlignment\":\r\n\t\t\t\t\tstyle[\"vertical-align\"] = values.valueOfTextAlignment(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"color\":\r\n\t\t\t\t\tstyle[\"color\"] = xmlUtil.colorAttr(c, \"val\", null, autos.color);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"sz\":\r\n\t\t\t\t\tstyle[\"font-size\"] = style[\"min-height\"] = xml.lengthAttr(c, \"val\", LengthUsage.FontSize);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"shd\":\r\n\t\t\t\t\tstyle[\"background-color\"] = xmlUtil.colorAttr(c, \"fill\", null, autos.shd);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"highlight\":\r\n\t\t\t\t\tstyle[\"background-color\"] = xmlUtil.colorAttr(c, \"val\", null, autos.highlight);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"vertAlign\":\r\n\t\t\t\t\t//TODO\r\n\t\t\t\t\t// style.verticalAlign = values.valueOfVertAlign(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"position\":\r\n\t\t\t\t\tstyle.verticalAlign = xml.lengthAttr(c, \"val\", LengthUsage.FontSize);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tcW\":\r\n\t\t\t\t\tif (this.options.ignoreWidth)\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblW\":\r\n\t\t\t\t\tstyle[\"width\"] = values.valueOfSize(c, \"w\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"trHeight\":\r\n\t\t\t\t\tthis.parseTrHeight(c, style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"strike\":\r\n\t\t\t\t\tstyle[\"text-decoration\"] = xml.boolAttr(c, \"val\", true) ? \"line-through\" : \"none\"\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"b\":\r\n\t\t\t\t\tstyle[\"font-weight\"] = xml.boolAttr(c, \"val\", true) ? \"bold\" : \"normal\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"i\":\r\n\t\t\t\t\tstyle[\"font-style\"] = xml.boolAttr(c, \"val\", true) ? \"italic\" : \"normal\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"caps\":\r\n\t\t\t\t\tstyle[\"text-transform\"] = xml.boolAttr(c, \"val\", true) ? \"uppercase\" : \"none\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"smallCaps\":\r\n\t\t\t\t\tstyle[\"text-transform\"] = xml.boolAttr(c, \"val\", true) ? \"lowercase\" : \"none\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"u\":\r\n\t\t\t\t\tthis.parseUnderline(c, style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"ind\":\r\n\t\t\t\tcase \"tblInd\":\r\n\t\t\t\t\tthis.parseIndentation(c, style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"rFonts\":\r\n\t\t\t\t\tthis.parseFont(c, style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblBorders\":\r\n\t\t\t\t\tthis.parseBorderProperties(c, childStyle || style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblCellSpacing\":\r\n\t\t\t\t\tstyle[\"border-spacing\"] = values.valueOfMargin(c);\r\n\t\t\t\t\tstyle[\"border-collapse\"] = \"separate\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"pBdr\":\r\n\t\t\t\t\tthis.parseBorderProperties(c, style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"bdr\":\r\n\t\t\t\t\tstyle[\"border\"] = values.valueOfBorder(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tcBorders\":\r\n\t\t\t\t\tthis.parseBorderProperties(c, style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"vanish\":\r\n\t\t\t\t\tif (xml.boolAttr(c, \"val\", true))\r\n\t\t\t\t\t\tstyle[\"display\"] = \"none\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"kern\":\r\n\t\t\t\t\t//TODO\r\n\t\t\t\t\t//style['letter-spacing'] = xml.lengthAttr(elem, 'val', LengthUsage.FontSize);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"noWrap\":\r\n\t\t\t\t\t//TODO\r\n\t\t\t\t\t//style[\"white-space\"] = \"nowrap\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblCellMar\":\r\n\t\t\t\tcase \"tcMar\":\r\n\t\t\t\t\tthis.parseMarginProperties(c, childStyle || style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tblLayout\":\r\n\t\t\t\t\tstyle[\"table-layout\"] = values.valueOfTblLayout(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"vAlign\":\r\n\t\t\t\t\tstyle[\"vertical-align\"] = values.valueOfTextAlignment(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"spacing\":\r\n\t\t\t\t\tif (elem.localName == \"pPr\")\r\n\t\t\t\t\t\tthis.parseSpacing(c, style);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"wordWrap\":\r\n\t\t\t\t\tif (xml.boolAttr(c, \"val\")) //TODO: test with examples\r\n\t\t\t\t\t\tstyle[\"overflow-wrap\"] = \"break-word\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"bCs\":\r\n\t\t\t\tcase \"iCs\":\r\n\t\t\t\tcase \"szCs\":\r\n\t\t\t\tcase \"tabs\": //ignore - tabs is parsed by other parser\r\n\t\t\t\tcase \"outlineLvl\": //TODO\r\n\t\t\t\tcase \"contextualSpacing\": //TODO\r\n\t\t\t\tcase \"tblStyleColBandSize\": //TODO\r\n\t\t\t\tcase \"tblStyleRowBandSize\": //TODO\r\n\t\t\t\tcase \"webHidden\": //TODO - maybe web-hidden should be implemented\r\n\t\t\t\tcase \"pageBreakBefore\": //TODO - maybe ignore \r\n\t\t\t\tcase \"suppressLineNumbers\": //TODO - maybe ignore\r\n\t\t\t\tcase \"keepLines\": //TODO - maybe ignore\r\n\t\t\t\tcase \"keepNext\": //TODO - maybe ignore\r\n\t\t\t\tcase \"lang\":\r\n\t\t\t\tcase \"widowControl\": //TODO - maybe ignore \r\n\t\t\t\tcase \"bidi\": //TODO - maybe ignore\r\n\t\t\t\tcase \"rtl\": //TODO - maybe ignore\r\n\t\t\t\tcase \"noProof\": //ignore spellcheck\r\n\t\t\t\t\t//TODO ignore\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tif (this.options.debug)\r\n\t\t\t\t\t\tconsole.warn(`DOCX: Unknown document element: ${elem.localName}.${c.localName}`);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn style;\r\n\t}\r\n\r\n\tparseUnderline(node: Element, style: Record<string, string>) {\r\n\t\tvar val = xml.attr(node, \"val\");\r\n\r\n\t\tif (val == null)\r\n\t\t\treturn;\r\n\r\n\t\tswitch (val) {\r\n\t\t\tcase \"dash\":\r\n\t\t\tcase \"dashDotDotHeavy\":\r\n\t\t\tcase \"dashDotHeavy\":\r\n\t\t\tcase \"dashedHeavy\":\r\n\t\t\tcase \"dashLong\":\r\n\t\t\tcase \"dashLongHeavy\":\r\n\t\t\tcase \"dotDash\":\r\n\t\t\tcase \"dotDotDash\":\r\n\t\t\t\tstyle[\"text-decoration-style\"] = \"dashed\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"dotted\":\r\n\t\t\tcase \"dottedHeavy\":\r\n\t\t\t\tstyle[\"text-decoration-style\"] = \"dotted\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"double\":\r\n\t\t\t\tstyle[\"text-decoration-style\"] = \"double\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"single\":\r\n\t\t\tcase \"thick\":\r\n\t\t\t\tstyle[\"text-decoration\"] = \"underline\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"wave\":\r\n\t\t\tcase \"wavyDouble\":\r\n\t\t\tcase \"wavyHeavy\":\r\n\t\t\t\tstyle[\"text-decoration-style\"] = \"wavy\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"words\":\r\n\t\t\t\tstyle[\"text-decoration\"] = \"underline\";\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"none\":\r\n\t\t\t\tstyle[\"text-decoration\"] = \"none\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tvar col = xmlUtil.colorAttr(node, \"color\");\r\n\r\n\t\tif (col)\r\n\t\t\tstyle[\"text-decoration-color\"] = col;\r\n\t}\r\n\r\n\tparseFont(node: Element, style: Record<string, string>) {\r\n\t\tvar ascii = xml.attr(node, \"ascii\");\r\n\t\tvar asciiTheme = values.themeValue(node, \"asciiTheme\");\r\n\r\n\t\tvar fonts = [ascii, asciiTheme].filter(x => x).join(', ');\r\n\r\n\t\tif (fonts.length > 0)\r\n\t\t\tstyle[\"font-family\"] = fonts;\r\n\t}\r\n\r\n\tparseIndentation(node: Element, style: Record<string, string>) {\r\n\t\tvar firstLine = xml.lengthAttr(node, \"firstLine\");\r\n\t\tvar hanging = xml.lengthAttr(node, \"hanging\");\r\n\t\tvar left = xml.lengthAttr(node, \"left\");\r\n\t\tvar start = xml.lengthAttr(node, \"start\");\r\n\t\tvar right = xml.lengthAttr(node, \"right\");\r\n\t\tvar end = xml.lengthAttr(node, \"end\");\r\n\r\n\t\tif (firstLine) style[\"text-indent\"] = firstLine;\r\n\t\tif (hanging) style[\"text-indent\"] = `-${hanging}`;\r\n\t\tif (left || start) style[\"margin-left\"] = left || start;\r\n\t\tif (right || end) style[\"margin-right\"] = right || end;\r\n\t}\r\n\r\n\tparseSpacing(node: Element, style: Record<string, string>) {\r\n\t\tvar before = xml.lengthAttr(node, \"before\");\r\n\t\tvar after = xml.lengthAttr(node, \"after\");\r\n\t\tvar line = xml.intAttr(node, \"line\", null);\r\n\t\tvar lineRule = xml.attr(node, \"lineRule\");\r\n\r\n\t\tif (before) style[\"margin-top\"] = before;\r\n\t\tif (after) style[\"margin-bottom\"] = after;\r\n\r\n\t\tif (line !== null) {\r\n\t\t\tswitch (lineRule) {\r\n\t\t\t\tcase \"auto\":\r\n\t\t\t\t\tstyle[\"line-height\"] = `${(line / 240).toFixed(2)}`;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"atLeast\":\r\n\t\t\t\t\tstyle[\"line-height\"] = `calc(100% + ${line / 20}pt)`;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tstyle[\"line-height\"] = style[\"min-height\"] = `${line / 20}pt`\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tparseMarginProperties(node: Element, output: Record<string, string>) {\r\n\t\txmlUtil.foreach(node, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"left\":\r\n\t\t\t\t\toutput[\"padding-left\"] = values.valueOfMargin(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"right\":\r\n\t\t\t\t\toutput[\"padding-right\"] = values.valueOfMargin(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"top\":\r\n\t\t\t\t\toutput[\"padding-top\"] = values.valueOfMargin(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"bottom\":\r\n\t\t\t\t\toutput[\"padding-bottom\"] = values.valueOfMargin(c);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tparseTrHeight(node: Element, output: Record<string, string>) {\r\n\t\tswitch (xml.attr(node, \"hRule\")) {\r\n\t\t\tcase \"exact\":\r\n\t\t\t\toutput[\"height\"] = xml.lengthAttr(node, \"val\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"atLeast\":\r\n\t\t\tdefault:\r\n\t\t\t\toutput[\"height\"] = xml.lengthAttr(node, \"val\");\r\n\t\t\t\t// min-height doesn't work for tr\r\n\t\t\t\t//output[\"min-height\"] = xml.sizeAttr(node, \"val\");  \r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tparseBorderProperties(node: Element, output: Record<string, string>) {\r\n\t\txmlUtil.foreach(node, c => {\r\n\t\t\tswitch (c.localName) {\r\n\t\t\t\tcase \"start\":\r\n\t\t\t\tcase \"left\":\r\n\t\t\t\t\toutput[\"border-left\"] = values.valueOfBorder(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"end\":\r\n\t\t\t\tcase \"right\":\r\n\t\t\t\t\toutput[\"border-right\"] = values.valueOfBorder(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"top\":\r\n\t\t\t\t\toutput[\"border-top\"] = values.valueOfBorder(c);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"bottom\":\r\n\t\t\t\t\toutput[\"border-bottom\"] = values.valueOfBorder(c);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nconst knownColors = ['black', 'blue', 'cyan', 'darkBlue', 'darkCyan', 'darkGray', 'darkGreen', 'darkMagenta', 'darkRed', 'darkYellow', 'green', 'lightGray', 'magenta', 'none', 'red', 'white', 'yellow'];\r\n\r\nclass xmlUtil {\r\n\tstatic foreach(node: Element, cb: (n: Element) => void) {\r\n\t\tfor (var i = 0; i < node.childNodes.length; i++) {\r\n\t\t\tlet n = node.childNodes[i];\r\n\r\n\t\t\tif (n.nodeType == Node.ELEMENT_NODE)\r\n\t\t\t\tcb(<Element>n);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic colorAttr(node: Element, attrName: string, defValue: string = null, autoColor: string = 'black') {\r\n\t\tvar v = xml.attr(node, attrName);\r\n\r\n\t\tif (v) {\r\n\t\t\tif (v == \"auto\") {\r\n\t\t\t\treturn autoColor;\r\n\t\t\t} else if (knownColors.includes(v)) {\r\n\t\t\t\treturn v;\r\n\t\t\t}\r\n\r\n\t\t\treturn `#${v}`;\r\n\t\t}\r\n\r\n\t\tvar themeColor = xml.attr(node, \"themeColor\");\r\n\r\n\t\treturn themeColor ? `var(--docx-${themeColor}-color)` : defValue;\r\n\t}\r\n\r\n\tstatic sizeValue(node: Element, type: LengthUsageType = LengthUsage.Dxa) {\r\n\t\treturn convertLength(node.textContent, type);\r\n\t}\r\n}\r\n\r\nclass values {\r\n\tstatic themeValue(c: Element, attr: string) {\r\n\t\tvar val = xml.attr(c, attr);\r\n\t\treturn val ? `var(--docx-${val}-font)` : null;\r\n\t}\r\n\r\n\tstatic valueOfSize(c: Element, attr: string) {\r\n\t\tvar type = LengthUsage.Dxa;\r\n\r\n\t\tswitch (xml.attr(c, \"type\")) {\r\n\t\t\tcase \"dxa\": break;\r\n\t\t\tcase \"pct\": type = LengthUsage.Percent; break;\r\n\t\t\tcase \"auto\": return \"auto\";\r\n\t\t}\r\n\r\n\t\treturn xml.lengthAttr(c, attr, type);\r\n\t}\r\n\r\n\tstatic valueOfMargin(c: Element) {\r\n\t\treturn xml.lengthAttr(c, \"w\");\r\n\t}\r\n\r\n\tstatic valueOfBorder(c: Element) {\r\n\t\tvar type = xml.attr(c, \"val\");\r\n\r\n\t\tif (type == \"nil\")\r\n\t\t\treturn \"none\";\r\n\r\n\t\tvar color = xmlUtil.colorAttr(c, \"color\");\r\n\t\tvar size = xml.lengthAttr(c, \"sz\", LengthUsage.Border);\r\n\r\n\t\treturn `${size} solid ${color == \"auto\" ? autos.borderColor : color}`;\r\n\t}\r\n\r\n\tstatic valueOfTblLayout(c: Element) {\r\n\t\tvar type = xml.attr(c, \"val\");\r\n\t\treturn type == \"fixed\" ? \"fixed\" : \"auto\";\r\n\t}\r\n\r\n\tstatic classNameOfCnfStyle(c: Element) {\r\n\t\tconst val = xml.attr(c, \"val\");\r\n\t\tconst classes = [\r\n\t\t\t'first-row', 'last-row', 'first-col', 'last-col',\r\n\t\t\t'odd-col', 'even-col', 'odd-row', 'even-row',\r\n\t\t\t'ne-cell', 'nw-cell', 'se-cell', 'sw-cell'\r\n\t\t];\r\n\r\n\t\treturn classes.filter((_, i) => val[i] == '1').join(' ');\r\n\t}\r\n\r\n\tstatic valueOfJc(c: Element) {\r\n\t\tvar type = xml.attr(c, \"val\");\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase \"start\":\r\n\t\t\tcase \"left\": return \"left\";\r\n\t\t\tcase \"center\": return \"center\";\r\n\t\t\tcase \"end\":\r\n\t\t\tcase \"right\": return \"right\";\r\n\t\t\tcase \"both\": return \"justify\";\r\n\t\t}\r\n\r\n\t\treturn type;\r\n\t}\r\n\r\n\tstatic valueOfVertAlign(c: Element, asTagName: boolean = false) {\r\n\t\tvar type = xml.attr(c, \"val\");\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase \"subscript\": return \"sub\";\r\n\t\t\tcase \"superscript\": return asTagName ? \"sup\" : \"super\";\r\n\t\t}\r\n\r\n\t\treturn asTagName ? null : type;\r\n\t}\r\n\r\n\tstatic valueOfTextAlignment(c: Element) {\r\n\t\tvar type = xml.attr(c, \"val\");\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase \"auto\":\r\n\t\t\tcase \"baseline\": return \"baseline\";\r\n\t\t\tcase \"top\": return \"top\";\r\n\t\t\tcase \"center\": return \"middle\";\r\n\t\t\tcase \"bottom\": return \"bottom\";\r\n\t\t}\r\n\r\n\t\treturn type;\r\n\t}\r\n\r\n\tstatic addSize(a: string, b: string): string {\r\n\t\tif (a == null) return b;\r\n\t\tif (b == null) return a;\r\n\r\n\t\treturn `calc(${a} + ${b})`; //TODO\r\n\t}\r\n\r\n\tstatic classNameOftblLook(c: Element) {\r\n\t\tconst val = xml.hexAttr(c, \"val\", 0);\r\n\t\tlet className = \"\";\r\n\r\n\t\tif (xml.boolAttr(c, \"firstRow\") || (val & 0x0020)) className += \" first-row\";\r\n\t\tif (xml.boolAttr(c, \"lastRow\") || (val & 0x0040)) className += \" last-row\";\r\n\t\tif (xml.boolAttr(c, \"firstColumn\") || (val & 0x0080)) className += \" first-col\";\r\n\t\tif (xml.boolAttr(c, \"lastColumn\") || (val & 0x0100)) className += \" last-col\";\r\n\t\tif (xml.boolAttr(c, \"noHBand\") || (val & 0x0200)) className += \" no-hband\";\r\n\t\tif (xml.boolAttr(c, \"noVBand\") || (val & 0x0400)) className += \" no-vband\";\r\n\r\n\t\treturn className.trim();\r\n\t}\r\n}","import { Part } from \"../common/part\";\r\nimport { CorePropsDeclaration, parseCoreProps } from \"./core-props\";\r\n\r\nexport class CorePropsPart extends Part {\r\n    props: CorePropsDeclaration;\r\n\r\n    parseXml(root: Element) {\r\n        this.props = parseCoreProps(root, this._package.xmlParser);\r\n    }\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\n\r\nexport interface CorePropsDeclaration {\r\n    title: string,\r\n    description: string,\r\n    subject: string,\r\n    creator: string,\r\n    keywords: string,\r\n    language: string,\r\n    lastModifiedBy: string,\r\n    revision: number,\r\n}\r\n\r\nexport function parseCoreProps(root: Element, xmlParser: XmlParser): CorePropsDeclaration {\r\n    const result = <CorePropsDeclaration>{};\r\n\r\n    for (let el of xmlParser.elements(root)) {\r\n        switch (el.localName) {\r\n            case \"title\": result.title = el.textContent; break;\r\n            case \"description\": result.description = el.textContent; break;\r\n            case \"subject\": result.subject = el.textContent; break;\r\n            case \"creator\": result.creator = el.textContent; break;\r\n            case \"keywords\": result.keywords = el.textContent; break;\r\n            case \"language\": result.language = el.textContent; break;\r\n            case \"lastModifiedBy\": result.lastModifiedBy = el.textContent; break;\r\n            case \"revision\": el.textContent && (result.revision = parseInt(el.textContent)); break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}","import { Part } from \"../common/part\";\r\nimport { CustomProperty, parseCustomProps } from \"./custom-props\";\r\n\r\nexport class CustomPropsPart extends Part {\r\n    props: CustomProperty[];\r\n\r\n    parseXml(root: Element) {\r\n        this.props = parseCustomProps(root, this._package.xmlParser);\r\n    }\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\n\r\nexport interface CustomProperty {\r\n\tformatId: string;\r\n\tname: string;\r\n\ttype: string;\r\n\tvalue: string;\r\n}\r\n\r\nexport function parseCustomProps(root: Element, xml: XmlParser): CustomProperty[] {\r\n\treturn xml.elements(root, \"property\").map(e => {\r\n\t\tconst firstChild = e.firstChild;\r\n\r\n\t\treturn {\r\n\t\t\tformatId: xml.attr(e, \"fmtid\"),\r\n\t\t\tname: xml.attr(e, \"name\"),\r\n\t\t\ttype: firstChild.nodeName,\r\n\t\t\tvalue: firstChild.textContent\r\n\t\t};\r\n\t});\r\n}","import { Part } from \"../common/part\";\r\nimport { ExtendedPropsDeclaration, parseExtendedProps } from \"./extended-props\";\r\n\r\nexport class ExtendedPropsPart extends Part {\r\n    props: ExtendedPropsDeclaration;\r\n\r\n    parseXml(root: Element) {\r\n        this.props = parseExtendedProps(root, this._package.xmlParser);\r\n    }\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\n\r\nexport interface ExtendedPropsDeclaration {\r\n    template: string,\r\n    totalTime: number,\r\n    pages: number,\r\n    words: number,\r\n    characters: number,\r\n    application: string,\r\n    lines: number,\r\n    paragraphs: number,\r\n    company: string,\r\n    appVersion: string\r\n}\r\n\r\nexport function parseExtendedProps(root: Element, xmlParser: XmlParser): ExtendedPropsDeclaration {\r\n    const result = <ExtendedPropsDeclaration>{\r\n\r\n    };\r\n\r\n    for (let el of xmlParser.elements(root)) {\r\n        switch (el.localName) {\r\n            case \"Template\":\r\n                result.template = el.textContent;\r\n                break;\r\n            case \"Pages\":\r\n                result.pages = safeParseToInt(el.textContent);\r\n                break;\r\n            case \"Words\":\r\n                result.words = safeParseToInt(el.textContent);\r\n                break;\r\n            case \"Characters\":\r\n                result.characters = safeParseToInt(el.textContent);\r\n                break;\r\n            case \"Application\":\r\n                result.application = el.textContent;\r\n                break;\r\n            case \"Lines\":\r\n                result.lines = safeParseToInt(el.textContent);\r\n                break;\r\n            case \"Paragraphs\":\r\n                result.paragraphs = safeParseToInt(el.textContent);\r\n                break;\r\n            case \"Company\":\r\n                result.company = el.textContent;\r\n                break;\r\n            case \"AppVersion\":\r\n                result.appVersion = el.textContent;\r\n                break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction safeParseToInt(value: string): number {\r\n    if (typeof value === 'undefined')\r\n        return;\r\n    return parseInt(value);\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\nimport { DomType, OpenXmlElement } from \"./dom\";\r\n\r\nexport interface WmlBookmarkStart extends OpenXmlElement {\r\n    id: string;\r\n    name: string;\r\n    colFirst: number;\r\n    colLast: number;\r\n}\r\n\r\nexport interface WmlBookmarkEnd extends OpenXmlElement {\r\n    id: string;\r\n}\r\n\r\nexport function parseBookmarkStart(elem: Element, xml: XmlParser): WmlBookmarkStart {\r\n    return {\r\n        type: DomType.BookmarkStart,\r\n        id: xml.attr(elem, \"id\"),\r\n        name: xml.attr(elem, \"name\"),\r\n        colFirst: xml.intAttr(elem, \"colFirst\"),\r\n        colLast: xml.intAttr(elem, \"colLast\")\r\n    }\r\n}\r\n\r\nexport function parseBookmarkEnd(elem: Element, xml: XmlParser): WmlBookmarkEnd {\r\n    return {\r\n        type: DomType.BookmarkEnd,\r\n        id: xml.attr(elem, \"id\")\r\n    }\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\nimport { Length, LengthUsage } from \"./common\";\r\n\r\nexport interface Border {\r\n    color: string;\r\n    type: string;\r\n    size: Length;\r\n    frame: boolean;\r\n    shadow: boolean;\r\n    offset: Length;\r\n}\r\n\r\nexport interface Borders {\r\n    top: Border;\r\n    left: Border;\r\n    right: Border;\r\n    bottom: Border;\r\n}\r\n\r\nexport function parseBorder(elem: Element, xml: XmlParser): Border {\r\n    return {\r\n        type: xml.attr(elem, \"val\"),\r\n        color: xml.attr(elem, \"color\"),\r\n        size: xml.lengthAttr(elem, \"sz\", LengthUsage.Border),\r\n        offset: xml.lengthAttr(elem, \"space\", LengthUsage.Point),\r\n        frame: xml.boolAttr(elem, 'frame'),\r\n        shadow: xml.boolAttr(elem, 'shadow')\r\n    };\r\n}\r\n\r\nexport function parseBorders(elem: Element, xml: XmlParser): Borders {\r\n    var result = <Borders>{};\r\n\r\n    for (let e of xml.elements(elem)) {\r\n        switch (e.localName) {\r\n            case \"left\": result.left = parseBorder(e, xml); break;\r\n            case \"top\": result.top = parseBorder(e, xml); break;\r\n            case \"right\": result.right = parseBorder(e, xml); break;\r\n            case \"bottom\": result.bottom = parseBorder(e, xml); break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\n\r\nexport const ns = {\r\n    wordml: \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\",\r\n    drawingml: \"http://schemas.openxmlformats.org/drawingml/2006/main\",\r\n    picture: \"http://schemas.openxmlformats.org/drawingml/2006/picture\",\r\n\tcompatibility: \"http://schemas.openxmlformats.org/markup-compatibility/2006\",\r\n\tmath: \"http://schemas.openxmlformats.org/officeDocument/2006/math\"\r\n}\r\n\r\nexport type LengthType = \"px\" | \"pt\" | \"%\" | \"\";\r\nexport type Length = string;\r\n\r\nexport interface Font {\r\n    name: string;\r\n    family: string;\r\n}\r\n\r\nexport interface CommonProperties {\r\n    fontSize: Length;\r\n    color: string;\r\n}\r\n\r\nexport type LengthUsageType = { mul: number, unit: LengthType };\r\n\r\nexport const LengthUsage: Record<string, LengthUsageType> = {\r\n    Dxa: { mul: 0.05, unit: \"pt\" }, //twips\r\n    Emu: { mul: 1 / 12700, unit: \"pt\" },\r\n    FontSize: { mul: 0.5, unit: \"pt\" },\r\n    Border: { mul: 0.125, unit: \"pt\" },\r\n    Point: { mul: 1, unit: \"pt\" },\r\n    Percent: { mul: 0.02, unit: \"%\" },\r\n    LineHeight: { mul: 1 / 240, unit: \"\" },\r\n    VmlEmu: { mul: 1 / 12700, unit: \"\" },\r\n}\r\n\r\nexport function convertLength(val: string, usage: LengthUsageType = LengthUsage.Dxa): string {\r\n    //\"simplified\" docx documents use pt's as units\r\n    if (val == null || /.+(p[xt]|[%])$/.test(val)) {\r\n        return val;\r\n    }\r\n\r\n\treturn `${(parseInt(val) * usage.mul).toFixed(2)}${usage.unit}`;\r\n}\r\n\r\nexport function convertBoolean(v: string, defaultValue = false): boolean {\r\n    switch (v) {\r\n        case \"1\": return true;\r\n        case \"0\": return false;\r\n        case \"on\": return true;\r\n        case \"off\": return false;\r\n        case \"true\": return true;\r\n        case \"false\": return false;\r\n        default: return defaultValue;\r\n    }\r\n}\r\n\r\nexport function convertPercentage(val: string): number {\r\n    return val ? parseInt(val) / 100 : null;\r\n}\r\n\r\nexport function parseCommonProperty(elem: Element, props: CommonProperties, xml: XmlParser): boolean {\r\n    if(elem.namespaceURI != ns.wordml)\r\n        return false;\r\n\r\n    switch(elem.localName) {\r\n        case \"color\": \r\n            props.color = xml.attr(elem, \"val\");\r\n            break;\r\n\r\n        case \"sz\":\r\n            props.fontSize = xml.lengthAttr(elem, \"val\", LengthUsage.FontSize);\r\n            break;\r\n\r\n        default:\r\n            return false;\r\n    }\r\n\r\n    return true;\r\n}","import { OpenXmlPackage } from \"../common/open-xml-package\";\r\nimport { Part } from \"../common/part\";\r\nimport { DocumentParser } from \"../document-parser\";\r\nimport { DocumentElement } from \"./document\";\r\n\r\nexport class DocumentPart extends Part {\r\n    private _documentParser: DocumentParser;\r\n\r\n    constructor(pkg: OpenXmlPackage, path: string, parser: DocumentParser) {\r\n        super(pkg, path);\r\n        this._documentParser = parser;\r\n    }\r\n    \r\n    body: DocumentElement\r\n\r\n    parseXml(root: Element) {\r\n        this.body = this._documentParser.parseDocumentFile(root);\r\n    }\r\n}","export enum DomType {\r\n    Document = \"document\",\r\n    Paragraph = \"paragraph\",\r\n    Run = \"run\",\r\n    Break = \"break\",\r\n    NoBreakHyphen = \"noBreakHyphen\",\r\n    Table = \"table\",\r\n    Row = \"row\",\r\n    Cell = \"cell\",\r\n    Hyperlink = \"hyperlink\",\r\n    Drawing = \"drawing\",\r\n    Image = \"image\",\r\n    Text = \"text\",\r\n    Tab = \"tab\",\r\n    Symbol = \"symbol\",\r\n    BookmarkStart = \"bookmarkStart\",\r\n    BookmarkEnd = \"bookmarkEnd\",\r\n    Footer = \"footer\",\r\n    Header = \"header\",\r\n    FootnoteReference = \"footnoteReference\", \r\n\tEndnoteReference = \"endnoteReference\",\r\n    Footnote = \"footnote\",\r\n    Endnote = \"endnote\",\r\n    SimpleField = \"simpleField\",\r\n    ComplexField = \"complexField\",\r\n    Instruction = \"instruction\",\r\n\tVmlPicture = \"vmlPicture\",\r\n\tMmlMath = \"mmlMath\",\r\n\tMmlMathParagraph = \"mmlMathParagraph\",\r\n\tMmlFraction = \"mmlFraction\",\r\n\tMmlNumerator = \"mmlNumerator\",\r\n\tMmlDenominator = \"mmlDenominator\",\r\n\tMmlRadical = \"mmlRadical\",\r\n\tMmlBase = \"mmlBase\",\r\n\tMmlDegree = \"mmlDegree\",\r\n\tMmlSuperscript = \"mmlSuperscript\",\r\n\tMmlSubscript = \"mmlSubscript\",\r\n\tMmlSubArgument = \"mmlSubArgument\",\r\n\tMmlSuperArgument = \"mmlSuperArgument\",\r\n\tMmlNary = \"mmlNary\",\r\n\tMmlDelimiter = \"mmlDelimiter\",\r\n\tVmlElement = \"vmlElement\",\r\n\tInserted = \"inserted\",\r\n\tDeleted = \"deleted\",\r\n\tDeletedText = \"deletedText\"\r\n}\r\n\r\nexport interface OpenXmlElement {\r\n    type: DomType;\r\n    children?: OpenXmlElement[];\r\n    cssStyle?: Record<string, string>;\r\n    props?: Record<string, any>;\r\n    \r\n\tstyleName?: string; //style name\r\n\tclassName?: string; //class mods\r\n\r\n    parent?: OpenXmlElement;\r\n}\r\n\r\nexport interface WmlHyperlink extends OpenXmlElement {\r\n\tid?: string;\r\n    href?: string;\r\n}\r\n\r\nexport interface WmlNoteReference extends OpenXmlElement {\r\n    id: string;\r\n}\r\n\r\nexport interface WmlBreak extends OpenXmlElement{\r\n    break: \"page\" | \"lastRenderedPageBreak\" | \"textWrapping\";\r\n}\r\n\r\nexport interface WmlText extends OpenXmlElement{\r\n    text: string;\r\n}\r\n\r\nexport interface WmlSymbol extends OpenXmlElement {\r\n    font: string;\r\n    char: string;\r\n}\r\n\r\nexport interface WmlTable extends OpenXmlElement {\r\n    columns?: WmlTableColumn[];\r\n    cellStyle?: Record<string, string>;\r\n\r\n\tcolBandSize?: number;\r\n\trowBandSize?: number;\r\n}\r\n\r\nexport interface WmlTableRow extends OpenXmlElement {\r\n\tisHeader?: boolean;\r\n}\r\n\r\nexport interface WmlTableCell extends OpenXmlElement {\r\n\tverticalMerge?: 'restart' | 'continue' | string;\r\n    span?: number;\r\n}\r\n\r\nexport interface IDomImage extends OpenXmlElement {\r\n    src: string;\r\n}\r\n\r\nexport interface WmlTableColumn {\r\n    width?: string;\r\n}\r\n\r\nexport interface IDomNumbering {\r\n    id: string;\r\n    level: number;\r\n    pStyleName: string;\r\n    pStyle: Record<string, string>;\r\n    rStyle: Record<string, string>;\r\n    levelText?: string;\r\n    suff: string;\r\n    format?: string;\r\n    bullet?: NumberingPicBullet;\r\n}\r\n\r\nexport interface NumberingPicBullet {\r\n    id: number;\r\n    src: string;\r\n    style?: string;\r\n}\r\n","import { XmlParser } from \"../parser/xml-parser\";\r\nimport { Length } from \"./common\";\r\n\r\nexport interface LineSpacing {\r\n    after: Length;\r\n    before: Length;\r\n    line: number;\r\n    lineRule: \"atLeast\" | \"exactly\" | \"auto\";\r\n}\r\n\r\nexport function parseLineSpacing(elem: Element, xml: XmlParser): LineSpacing {\r\n    return {\r\n        before: xml.lengthAttr(elem, \"before\"),\r\n        after: xml.lengthAttr(elem, \"after\"),\r\n        line: xml.intAttr(elem, \"line\"),\r\n        lineRule: xml.attr(elem, \"lineRule\")\r\n    } as LineSpacing;\r\n}","import { OpenXmlElement } from \"./dom\";\r\nimport { CommonProperties, Length, ns, parseCommonProperty } from \"./common\";\r\nimport { Borders } from \"./border\";\r\nimport { parseSectionProperties, SectionProperties } from \"./section\";\r\nimport { LineSpacing, parseLineSpacing } from \"./line-spacing\";\r\nimport { XmlParser } from \"../parser/xml-parser\";\r\nimport { parseRunProperties, RunProperties } from \"./run\";\r\n\r\nexport interface WmlParagraph extends OpenXmlElement, ParagraphProperties {\r\n}\r\n\r\nexport interface ParagraphProperties extends CommonProperties {\r\n    sectionProps: SectionProperties;\r\n    tabs: ParagraphTab[];\r\n    numbering: ParagraphNumbering;\r\n\r\n    border: Borders;\r\n    textAlignment: \"auto\" | \"baseline\" | \"bottom\" | \"center\" | \"top\" | string;\r\n    lineSpacing: LineSpacing;\r\n    keepLines: boolean;\r\n    keepNext: boolean;\r\n    pageBreakBefore: boolean;\r\n    outlineLevel: number;\r\n\tstyleName?: string;\r\n\r\n    runProps: RunProperties;\r\n}\r\n\r\nexport interface ParagraphTab {\r\n    style: \"bar\" | \"center\" | \"clear\" | \"decimal\" | \"end\" | \"num\" | \"start\" | \"left\" | \"right\";\r\n    leader: \"none\" | \"dot\" | \"heavy\" | \"hyphen\" | \"middleDot\" | \"underscore\";\r\n    position: Length;\r\n}\r\n\r\nexport interface ParagraphNumbering {\r\n    id: string;\r\n    level: number;\r\n}\r\n\r\nexport function parseParagraphProperties(elem: Element, xml: XmlParser): ParagraphProperties {\r\n    let result = <ParagraphProperties>{};\r\n\r\n    for(let el of xml.elements(elem)) {\r\n        parseParagraphProperty(el, result, xml);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseParagraphProperty(elem: Element, props: ParagraphProperties, xml: XmlParser) {\r\n    if (elem.namespaceURI != ns.wordml)\r\n        return false;\r\n\r\n    if(parseCommonProperty(elem, props, xml))\r\n        return true;\r\n\r\n    switch (elem.localName) {\r\n        case \"tabs\":\r\n            props.tabs = parseTabs(elem, xml);\r\n            break;\r\n\r\n        case \"sectPr\":\r\n            props.sectionProps = parseSectionProperties(elem, xml);\r\n            break;\r\n\r\n        case \"numPr\":\r\n            props.numbering = parseNumbering(elem, xml);\r\n            break;\r\n        \r\n        case \"spacing\":\r\n            props.lineSpacing = parseLineSpacing(elem, xml);\r\n            return false; // TODO\r\n            break;\r\n\r\n        case \"textAlignment\":\r\n            props.textAlignment = xml.attr(elem, \"val\");\r\n            return false; //TODO\r\n            break;\r\n\r\n        case \"keepNext\":\r\n            props.keepLines = xml.boolAttr(elem, \"val\", true);\r\n            break;\r\n    \r\n        case \"keepNext\":\r\n            props.keepNext = xml.boolAttr(elem, \"val\", true);\r\n            break;\r\n        \r\n        case \"pageBreakBefore\":\r\n            props.pageBreakBefore = xml.boolAttr(elem, \"val\", true);\r\n            break;\r\n        \r\n        case \"outlineLvl\":\r\n            props.outlineLevel = xml.intAttr(elem, \"val\");\r\n            break;\r\n\r\n        case \"pStyle\":\r\n            props.styleName = xml.attr(elem, \"val\");\r\n            break;\r\n\r\n        case \"rPr\":\r\n            props.runProps = parseRunProperties(elem, xml);\r\n            break;\r\n        \r\n        default:\r\n            return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nexport function parseTabs(elem: Element, xml: XmlParser): ParagraphTab[] {\r\n    return xml.elements(elem, \"tab\")\r\n        .map(e => <ParagraphTab>{\r\n            position: xml.lengthAttr(e, \"pos\"),\r\n            leader: xml.attr(e, \"leader\"),\r\n            style: xml.attr(e, \"val\")\r\n        });\r\n}\r\n\r\nexport function parseNumbering(elem: Element, xml: XmlParser): ParagraphNumbering {\r\n    var result = <ParagraphNumbering>{};\r\n\r\n    for (let e of xml.elements(elem)) {\r\n        switch (e.localName) {\r\n            case \"numId\":\r\n                result.id = xml.attr(e, \"val\");\r\n                break;\r\n\r\n            case \"ilvl\":\r\n                result.level = xml.intAttr(e, \"val\");\r\n                break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\nimport { CommonProperties, parseCommonProperty } from \"./common\";\r\nimport { OpenXmlElement } from \"./dom\";\r\n\r\nexport interface WmlRun extends OpenXmlElement, RunProperties {\r\n    id?: string;\r\n    verticalAlign?: string;\r\n\tfieldRun?: boolean;  \r\n}\r\n\r\nexport interface RunProperties extends CommonProperties {\r\n\r\n}\r\n\r\nexport function parseRunProperties(elem: Element, xml: XmlParser): RunProperties {\r\n    let result = <RunProperties>{};\r\n\r\n    for(let el of xml.elements(elem)) {\r\n        parseRunProperty(el, result, xml);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseRunProperty(elem: Element, props: RunProperties, xml: XmlParser) {\r\n    if (parseCommonProperty(elem, props, xml))\r\n        return true;\r\n\r\n    return false;\r\n}","import globalXmlParser, { XmlParser } from \"../parser/xml-parser\";\r\nimport { Borders, parseBorders } from \"./border\";\r\nimport { Length } from \"./common\";\r\n\r\nexport interface Column {\r\n    space: Length;\r\n    width: Length;\r\n}\r\n\r\nexport interface Columns {\r\n    space: Length;\r\n    numberOfColumns: number;\r\n    separator: boolean;\r\n    equalWidth: boolean;\r\n    columns: Column[];\r\n}\r\n\r\nexport interface PageSize {\r\n    width: Length, \r\n    height: Length, \r\n    orientation: \"landscape\" | string \r\n}\r\n\r\nexport interface PageNumber {\r\n    start: number;\r\n    chapSep: \"colon\" | \"emDash\" | \"endash\" | \"hyphen\" | \"period\" | string;\r\n    chapStyle: string;\r\n    format: \"none\" | \"cardinalText\" | \"decimal\" | \"decimalEnclosedCircle\" | \"decimalEnclosedFullstop\" \r\n        | \"decimalEnclosedParen\" | \"decimalZero\" | \"lowerLetter\" | \"lowerRoman\"\r\n        | \"ordinalText\" | \"upperLetter\" | \"upperRoman\" | string;\r\n}\r\n\r\nexport interface PageMargins {\r\n    top: Length;\r\n    right: Length;\r\n    bottom: Length;\r\n    left: Length;\r\n    header: Length;\r\n    footer: Length;\r\n    gutter: Length;\r\n}\r\n\r\nexport enum SectionType {\r\n    Continuous = \"continuous\",\r\n    NextPage = \"nextPage\", \r\n    NextColumn = \"nextColumn\",\r\n    EvenPage = \"evenPage\",\r\n    OddPage = \"oddPage\",\r\n}\r\n\r\nexport interface FooterHeaderReference {\r\n    id: string;\r\n    type: string | \"first\" | \"even\" | \"default\";\r\n}\r\n\r\nexport interface SectionProperties {\r\n    type: SectionType | string;\r\n    pageSize: PageSize,\r\n    pageMargins: PageMargins,\r\n    pageBorders: Borders;\r\n    pageNumber: PageNumber;\r\n    columns: Columns;\r\n    footerRefs: FooterHeaderReference[];\r\n    headerRefs: FooterHeaderReference[];\r\n    titlePage: boolean;\r\n}\r\n\r\nexport function parseSectionProperties(elem: Element, xml: XmlParser = globalXmlParser): SectionProperties {\r\n    var section = <SectionProperties>{};\r\n\r\n    for (let e of xml.elements(elem)) {\r\n        switch (e.localName) {\r\n            case \"pgSz\":\r\n                section.pageSize = {\r\n                    width: xml.lengthAttr(e, \"w\"),\r\n                    height: xml.lengthAttr(e, \"h\"),\r\n                    orientation: xml.attr(e, \"orient\")\r\n                }\r\n                break;\r\n\r\n            case \"type\":\r\n                section.type = xml.attr(e, \"val\");\r\n                break;\r\n\r\n            case \"pgMar\":\r\n                section.pageMargins = {\r\n                    left: xml.lengthAttr(e, \"left\"),\r\n                    right: xml.lengthAttr(e, \"right\"),\r\n                    top: xml.lengthAttr(e, \"top\"),\r\n                    bottom: xml.lengthAttr(e, \"bottom\"),\r\n                    header: xml.lengthAttr(e, \"header\"),\r\n                    footer: xml.lengthAttr(e, \"footer\"),\r\n                    gutter: xml.lengthAttr(e, \"gutter\"),\r\n                };\r\n                break;\r\n\r\n            case \"cols\":\r\n                section.columns = parseColumns(e, xml);\r\n                break;\r\n\r\n            case \"headerReference\":\r\n                (section.headerRefs ?? (section.headerRefs = [])).push(parseFooterHeaderReference(e, xml)); \r\n                break;\r\n            \r\n            case \"footerReference\":\r\n                (section.footerRefs ?? (section.footerRefs = [])).push(parseFooterHeaderReference(e, xml)); \r\n                break;\r\n\r\n            case \"titlePg\":\r\n                section.titlePage = xml.boolAttr(e, \"val\", true);\r\n                break;\r\n\r\n            case \"pgBorders\":\r\n                section.pageBorders = parseBorders(e, xml);\r\n                break;\r\n\r\n            case \"pgNumType\":\r\n                section.pageNumber = parsePageNumber(e, xml);\r\n                break;\r\n        }\r\n    }\r\n\r\n    return section;\r\n}\r\n\r\nfunction parseColumns(elem: Element, xml: XmlParser): Columns {\r\n    return {\r\n        numberOfColumns: xml.intAttr(elem, \"num\"),\r\n        space: xml.lengthAttr(elem, \"space\"),\r\n        separator: xml.boolAttr(elem, \"sep\"),\r\n        equalWidth: xml.boolAttr(elem, \"equalWidth\", true),\r\n        columns: xml.elements(elem, \"col\")\r\n            .map(e => <Column>{\r\n                width: xml.lengthAttr(e, \"w\"),\r\n                space: xml.lengthAttr(e, \"space\")\r\n            })\r\n    };\r\n}\r\n\r\nfunction parsePageNumber(elem: Element, xml: XmlParser): PageNumber {\r\n    return {\r\n        chapSep: xml.attr(elem, \"chapSep\"),\r\n        chapStyle: xml.attr(elem, \"chapStyle\"),\r\n        format: xml.attr(elem, \"fmt\"),\r\n        start: xml.intAttr(elem, \"start\")\r\n    };\r\n}\r\n\r\nfunction parseFooterHeaderReference(elem: Element, xml: XmlParser): FooterHeaderReference {\r\n    return {\r\n        id: xml.attr(elem, \"id\"),\r\n        type: xml.attr(elem, \"type\"),\r\n    }\r\n}","import { WordDocument } from './word-document';\r\nimport { DocumentParser } from './document-parser';\r\nimport { HtmlRenderer } from './html-renderer';\r\n\r\nexport interface Options {\r\n    inWrapper: boolean;\r\n    ignoreWidth: boolean;\r\n    ignoreHeight: boolean;\r\n    ignoreFonts: boolean;\r\n    breakPages: boolean;\r\n    debug: boolean;\r\n    experimental: boolean;\r\n    className: string;\r\n    trimXmlDeclaration: boolean;\r\n    renderHeaders: boolean;\r\n    renderFooters: boolean;\r\n    renderFootnotes: boolean;\r\n\trenderEndnotes: boolean;\r\n    ignoreLastRenderedPageBreak: boolean;\r\n\tuseBase64URL: boolean;\r\n\tuseMathMLPolyfill: boolean;\r\n\trenderChanges: boolean;\r\n}\r\n\r\nexport const defaultOptions: Options = {\r\n    ignoreHeight: false,\r\n    ignoreWidth: false,\r\n    ignoreFonts: false,\r\n    breakPages: true,\r\n    debug: false,\r\n    experimental: false,\r\n    className: \"docx\",\r\n    inWrapper: true,\r\n    trimXmlDeclaration: true,\r\n    ignoreLastRenderedPageBreak: true,\r\n    renderHeaders: true,\r\n    renderFooters: true,\r\n    renderFootnotes: true,\r\n\trenderEndnotes: true,\r\n\tuseBase64URL: false,\r\n\tuseMathMLPolyfill: false,\r\n\trenderChanges: false\r\n}\r\n\r\nexport function praseAsync(data: Blob | any, userOptions: Partial<Options> = null): Promise<any>  {\r\n    const ops = { ...defaultOptions, ...userOptions };\r\n    return WordDocument.load(data, new DocumentParser(ops), ops);\r\n}\r\n\r\nexport function renderAsync(data: Blob | any, bodyContainer: HTMLElement, styleContainer: HTMLElement = null, userOptions: Partial<Options> = null): Promise<any> {\r\n    const ops = { ...defaultOptions, ...userOptions };\r\n    const renderer = new HtmlRenderer(window.document);\r\n\r\n    return WordDocument\r\n        .load(data, new DocumentParser(ops), ops)\r\n        .then(doc => {\r\n            renderer.render(doc, bodyContainer, styleContainer, ops);\r\n            return doc;\r\n        });\r\n}","import { Part } from \"../common/part\";\r\nimport { FontDeclaration, parseFonts } from \"./fonts\";\r\n\r\nexport class FontTablePart extends Part {\r\n    fonts: FontDeclaration[];\r\n\r\n    parseXml(root: Element) {\r\n        this.fonts = parseFonts(root, this._package.xmlParser);\r\n    }\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\n\r\nconst embedFontTypeMap = {\r\n    embedRegular: 'regular',\r\n    embedBold: 'bold',\r\n    embedItalic: 'italic',\r\n    embedBoldItalic: 'boldItalic',\r\n}\r\n\r\nexport interface FontDeclaration {\r\n    name: string,\r\n    altName: string,\r\n    family: string,\r\n    embedFontRefs: EmbedFontRef[];\r\n}\r\n\r\nexport interface EmbedFontRef {\r\n    id: string;\r\n    key: string;\r\n    type: 'regular' | 'bold' | 'italic' | 'boldItalic';\r\n}\r\n\r\nexport function parseFonts(root: Element, xml: XmlParser): FontDeclaration[] {\r\n    return xml.elements(root).map(el => parseFont(el, xml));\r\n}\r\n\r\nexport function parseFont(elem: Element, xml: XmlParser): FontDeclaration {\r\n    let result = <FontDeclaration>{\r\n        name: xml.attr(elem, \"name\"),\r\n        embedFontRefs: []\r\n    };\r\n\r\n    for (let el of xml.elements(elem)) {\r\n        switch (el.localName) {\r\n            case \"family\":\r\n                result.family = xml.attr(el, \"val\");\r\n                break;\r\n\r\n            case \"altName\":\r\n                result.altName = xml.attr(el, \"val\");\r\n                break;\r\n\r\n            case \"embedRegular\":\r\n            case \"embedBold\":\r\n            case \"embedItalic\":\r\n            case \"embedBoldItalic\":\r\n                result.embedFontRefs.push(parseEmbedFontRef(el, xml));\r\n                break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseEmbedFontRef(elem: Element, xml: XmlParser): EmbedFontRef {\r\n    return { \r\n        id: xml.attr(elem, \"id\"), \r\n        key: xml.attr(elem, \"fontKey\"),\r\n        type: embedFontTypeMap[elem.localName]\r\n    };\r\n}","import { DomType, OpenXmlElement } from \"../document/dom\";\r\n\r\nexport class WmlHeader implements OpenXmlElement {\r\n    type: DomType = DomType.Header;\r\n    children?: OpenXmlElement[] = [];\r\n    cssStyle?: Record<string, string> = {};\r\n    className?: string;\r\n    parent?: OpenXmlElement;\r\n}\r\n\r\nexport class WmlFooter implements OpenXmlElement {\r\n    type: DomType = DomType.Footer;\r\n    children?: OpenXmlElement[] = [];\r\n    cssStyle?: Record<string, string> = {};\r\n    className?: string;\r\n    parent?: OpenXmlElement;\r\n}","import { OpenXmlPackage } from \"../common/open-xml-package\";\r\nimport { Part } from \"../common/part\";\r\nimport { DocumentParser } from \"../document-parser\";\r\nimport { OpenXmlElement } from \"../document/dom\";\r\nimport { WmlHeader, WmlFooter } from \"./elements\";\r\n\r\nexport abstract class BaseHeaderFooterPart<T extends OpenXmlElement = OpenXmlElement> extends Part {\r\n    rootElement: T;\r\n\r\n    private _documentParser: DocumentParser;\r\n\r\n    constructor(pkg: OpenXmlPackage, path: string, parser: DocumentParser) {\r\n        super(pkg, path);\r\n        this._documentParser = parser;\r\n    }\r\n\r\n    parseXml(root: Element) {\r\n        this.rootElement = this.createRootElement();\r\n        this.rootElement.children = this._documentParser.parseBodyElements(root);\r\n    }\r\n\r\n    protected abstract createRootElement(): T;\r\n}\r\n\r\nexport class HeaderPart extends BaseHeaderFooterPart<WmlHeader> {\r\n    protected createRootElement(): WmlHeader {\r\n        return new WmlHeader();\r\n    }\r\n}\r\n\r\nexport class FooterPart extends BaseHeaderFooterPart<WmlFooter> {\r\n    protected createRootElement(): WmlFooter {\r\n        return new WmlFooter();\r\n    }\r\n}","import { WordDocument } from './word-document';\r\nimport {\r\n\tDomType, WmlTable, IDomNumbering,\r\n\tWmlHyperlink, IDomImage, OpenXmlElement, WmlTableColumn, WmlTableCell, WmlText, WmlSymbol, WmlBreak, WmlNoteReference\r\n} from './document/dom';\r\nimport { CommonProperties } from './document/common';\r\nimport { Options } from './docx-preview';\r\nimport { DocumentElement } from './document/document';\r\nimport { WmlParagraph } from './document/paragraph';\r\nimport { asArray, escapeClassName, isString, keyBy, mergeDeep } from './utils';\r\nimport { computePixelToPoint, updateTabStop } from './javascript';\r\nimport { FontTablePart } from './font-table/font-table';\r\nimport { FooterHeaderReference, SectionProperties } from './document/section';\r\nimport { WmlRun, RunProperties } from './document/run';\r\nimport { WmlBookmarkStart } from './document/bookmarks';\r\nimport { IDomStyle } from './document/style';\r\nimport { WmlBaseNote, WmlFootnote } from './notes/elements';\r\nimport { ThemePart } from './theme/theme-part';\r\nimport { BaseHeaderFooterPart } from './header-footer/parts';\r\nimport { Part } from './common/part';\r\nimport mathMLCSS from \"./mathml.scss\";\r\nimport { VmlElement } from './vml/vml';\r\n\r\nconst ns = {\r\n\tsvg: \"http://www.w3.org/2000/svg\",\r\n\tmathML: \"http://www.w3.org/1998/Math/MathML\"\r\n}\r\n\r\ninterface CellPos {\r\n\tcol: number;\r\n\trow: number;\r\n}\r\n\r\ntype CellVerticalMergeType = Record<number, HTMLTableCellElement>;\r\n\r\nexport class HtmlRenderer {\r\n\r\n\tclassName: string = \"docx\";\r\n\trootSelector: string;\r\n\tdocument: WordDocument;\r\n\toptions: Options;\r\n\tstyleMap: Record<string, IDomStyle> = {};\r\n\tcurrentPart: Part = null;\r\n\r\n\ttableVerticalMerges: CellVerticalMergeType[] = [];\r\n\tcurrentVerticalMerge: CellVerticalMergeType = null;\r\n\ttableCellPositions: CellPos[] = [];\r\n\tcurrentCellPosition: CellPos = null;\r\n\r\n\tfootnoteMap: Record<string, WmlFootnote> = {};\r\n\tendnoteMap: Record<string, WmlFootnote> = {};\r\n\tcurrentFootnoteIds: string[];\r\n\tcurrentEndnoteIds: string[] = [];\r\n\tusedHederFooterParts: any[] = [];\r\n\r\n\tdefaultTabSize: string;\r\n\tcurrentTabs: any[] = [];\r\n\ttabsTimeout: any = 0;\r\n\r\n\tconstructor(public htmlDocument: Document) {\r\n\t}\r\n\r\n\trender(document: WordDocument, bodyContainer: HTMLElement, styleContainer: HTMLElement = null, options: Options) {\r\n\t\tthis.document = document;\r\n\t\tthis.options = options;\r\n\t\tthis.className = options.className;\r\n\t\tthis.rootSelector = options.inWrapper ? `.${this.className}-wrapper` : ':root';\r\n\t\tthis.styleMap = null;\r\n\r\n\t\tstyleContainer = styleContainer || bodyContainer;\r\n\r\n\t\tremoveAllElements(styleContainer);\r\n\t\tremoveAllElements(bodyContainer);\r\n\r\n\t\tappendComment(styleContainer, \"docxjs library predefined styles\");\r\n\t\tstyleContainer.appendChild(this.renderDefaultStyle());\r\n\r\n\t\tif (!window.MathMLElement && options.useMathMLPolyfill) {\r\n\t\t\tappendComment(styleContainer, \"docxjs mathml polyfill styles\");\r\n\t\t\tstyleContainer.appendChild(createStyleElement(mathMLCSS));\r\n\t\t} \r\n\r\n\t\tif (document.themePart) {\r\n\t\t\tappendComment(styleContainer, \"docxjs document theme values\");\r\n\t\t\tthis.renderTheme(document.themePart, styleContainer);\r\n\t\t}\r\n\r\n\t\tif (document.stylesPart != null) {\r\n\t\t\tthis.styleMap = this.processStyles(document.stylesPart.styles);\r\n\r\n\t\t\tappendComment(styleContainer, \"docxjs document styles\");\r\n\t\t\tstyleContainer.appendChild(this.renderStyles(document.stylesPart.styles));\r\n\t\t}\r\n\r\n\t\tif (document.numberingPart) {\r\n\t\t\tthis.prodessNumberings(document.numberingPart.domNumberings);\r\n\r\n\t\t\tappendComment(styleContainer, \"docxjs document numbering styles\");\r\n\t\t\tstyleContainer.appendChild(this.renderNumbering(document.numberingPart.domNumberings, styleContainer));\r\n\t\t\t//styleContainer.appendChild(this.renderNumbering2(document.numberingPart, styleContainer));\r\n\t\t}\r\n\r\n\t\tif (document.footnotesPart) {\r\n\t\t\tthis.footnoteMap = keyBy(document.footnotesPart.notes, x => x.id);\r\n\t\t}\r\n\r\n\t\tif (document.endnotesPart) {\r\n\t\t\tthis.endnoteMap = keyBy(document.endnotesPart.notes, x => x.id);\r\n\t\t}\r\n\r\n\t\tif (document.settingsPart) {\r\n\t\t\tthis.defaultTabSize = document.settingsPart.settings?.defaultTabStop;\r\n\t\t}\r\n\r\n\t\tif (!options.ignoreFonts && document.fontTablePart)\r\n\t\t\tthis.renderFontTable(document.fontTablePart, styleContainer);\r\n\r\n\t\tvar sectionElements = this.renderSections(document.documentPart.body);\r\n\r\n\t\tif (this.options.inWrapper) {\r\n\t\t\tbodyContainer.appendChild(this.renderWrapper(sectionElements));\r\n\t\t} else {\r\n\t\t\tappendChildren(bodyContainer, sectionElements);\r\n\t\t}\r\n\r\n\t\tthis.refreshTabStops();\r\n\t}\r\n\r\n\trenderTheme(themePart: ThemePart, styleContainer: HTMLElement) {\r\n\t\tconst variables = {};\r\n\t\tconst fontScheme = themePart.theme?.fontScheme;\r\n\r\n\t\tif (fontScheme) {\r\n\t\t\tif (fontScheme.majorFont) {\r\n\t\t\t\tvariables['--docx-majorHAnsi-font'] = fontScheme.majorFont.latinTypeface;\r\n\t\t\t}\r\n\r\n\t\t\tif (fontScheme.minorFont) {\r\n\t\t\t\tvariables['--docx-minorHAnsi-font'] = fontScheme.minorFont.latinTypeface;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst colorScheme = themePart.theme?.colorScheme;\r\n\r\n\t\tif (colorScheme) {\r\n\t\t\tfor (let [k, v] of Object.entries(colorScheme.colors)) {\r\n\t\t\t\tvariables[`--docx-${k}-color`] = `#${v}`;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst cssText = this.styleToString(`.${this.className}`, variables);\r\n\t\tstyleContainer.appendChild(createStyleElement(cssText));\r\n\t}\r\n\r\n\trenderFontTable(fontsPart: FontTablePart, styleContainer: HTMLElement) {\r\n\t\tfor (let f of fontsPart.fonts) {\r\n\t\t\tfor (let ref of f.embedFontRefs) {\r\n\t\t\t\tthis.document.loadFont(ref.id, ref.key).then(fontData => {\r\n\t\t\t\t\tconst cssValues = {\r\n\t\t\t\t\t\t'font-family': f.name,\r\n\t\t\t\t\t\t'src': `url(${fontData})`\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (ref.type == \"bold\" || ref.type == \"boldItalic\") {\r\n\t\t\t\t\t\tcssValues['font-weight'] = 'bold';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (ref.type == \"italic\" || ref.type == \"boldItalic\") {\r\n\t\t\t\t\t\tcssValues['font-style'] = 'italic';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tappendComment(styleContainer, `docxjs ${f.name} font`);\r\n\t\t\t\t\tconst cssText = this.styleToString(\"@font-face\", cssValues);\r\n\t\t\t\t\tstyleContainer.appendChild(createStyleElement(cssText));\r\n\t\t\t\t\tthis.refreshTabStops();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprocessStyleName(className: string): string {\r\n\t\treturn className ? `${this.className}_${escapeClassName(className)}` : this.className;\r\n\t}\r\n\r\n\tprocessStyles(styles: IDomStyle[]) {\r\n\t\tconst stylesMap = keyBy(styles.filter(x => x.id != null), x => x.id);\r\n\r\n\t\tfor (const style of styles.filter(x => x.basedOn)) {\r\n\t\t\tvar baseStyle = stylesMap[style.basedOn];\r\n\r\n\t\t\tif (baseStyle) {\r\n\t\t\t\tstyle.paragraphProps = mergeDeep(style.paragraphProps, baseStyle.paragraphProps);\r\n\t\t\t\tstyle.runProps = mergeDeep(style.runProps, baseStyle.runProps);\r\n\r\n\t\t\t\tfor (const baseValues of baseStyle.styles) {\r\n\t\t\t\t\tconst styleValues = style.styles.find(x => x.target == baseValues.target);\r\n\r\n\t\t\t\t\tif (styleValues) {\r\n\t\t\t\t\t\tthis.copyStyleProperties(baseValues.values, styleValues.values);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstyle.styles.push({ ...baseValues, values: { ...baseValues.values } });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (this.options.debug)\r\n\t\t\t\tconsole.warn(`Can't find base style ${style.basedOn}`);\r\n\t\t}\r\n\r\n\t\tfor (let style of styles) {\r\n\t\t\tstyle.cssName = this.processStyleName(style.id);\r\n\t\t}\r\n\r\n\t\treturn stylesMap;\r\n\t}\r\n\r\n\tprodessNumberings(numberings: IDomNumbering[]) {\r\n\t\tfor (let num of numberings.filter(n => n.pStyleName)) {\r\n\t\t\tconst style = this.findStyle(num.pStyleName);\r\n\r\n\t\t\tif (style?.paragraphProps?.numbering) {\r\n\t\t\t\tstyle.paragraphProps.numbering.level = num.level;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprocessElement(element: OpenXmlElement) {\r\n\t\tif (element.children) {\r\n\t\t\tfor (var e of element.children) {\r\n\t\t\t\te.parent = element;\r\n\r\n\t\t\t\tif (e.type == DomType.Table) {\r\n\t\t\t\t\tthis.processTable(e);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.processElement(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprocessTable(table: WmlTable) {\r\n\t\tfor (var r of table.children) {\r\n\t\t\tfor (var c of r.children) {\r\n\t\t\t\tc.cssStyle = this.copyStyleProperties(table.cellStyle, c.cssStyle, [\r\n\t\t\t\t\t\"border-left\", \"border-right\", \"border-top\", \"border-bottom\",\r\n\t\t\t\t\t\"padding-left\", \"padding-right\", \"padding-top\", \"padding-bottom\"\r\n\t\t\t\t]);\r\n\r\n\t\t\t\tthis.processElement(c);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcopyStyleProperties(input: Record<string, string>, output: Record<string, string>, attrs: string[] = null): Record<string, string> {\r\n\t\tif (!input)\r\n\t\t\treturn output;\r\n\r\n\t\tif (output == null) output = {};\r\n\t\tif (attrs == null) attrs = Object.getOwnPropertyNames(input);\r\n\r\n\t\tfor (var key of attrs) {\r\n\t\t\tif (input.hasOwnProperty(key) && !output.hasOwnProperty(key))\r\n\t\t\t\toutput[key] = input[key];\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\t}\r\n\r\n\tcreateSection(className: string, props: SectionProperties) {\r\n\t\tvar elem = this.createElement(\"section\", { className });\r\n\r\n\t\tif (props) {\r\n\t\t\tif (props.pageMargins) {\r\n\t\t\t\telem.style.paddingLeft = props.pageMargins.left;\r\n\t\t\t\telem.style.paddingRight = props.pageMargins.right;\r\n\t\t\t\telem.style.paddingTop = props.pageMargins.top;\r\n\t\t\t\telem.style.paddingBottom = props.pageMargins.bottom;\r\n\t\t\t}\r\n\r\n\t\t\tif (props.pageSize) {\r\n\t\t\t\tif (!this.options.ignoreWidth)\r\n\t\t\t\t\telem.style.width = props.pageSize.width;\r\n\t\t\t\tif (!this.options.ignoreHeight)\r\n\t\t\t\t\telem.style.minHeight = props.pageSize.height;\r\n\t\t\t}\r\n\r\n\t\t\tif (props.columns && props.columns.numberOfColumns) {\r\n\t\t\t\telem.style.columnCount = `${props.columns.numberOfColumns}`;\r\n\t\t\t\telem.style.columnGap = props.columns.space;\r\n\r\n\t\t\t\tif (props.columns.separator) {\r\n\t\t\t\t\telem.style.columnRule = \"1px solid black\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn elem;\r\n\t}\r\n\r\n\trenderSections(document: DocumentElement): HTMLElement[] {\r\n\t\tconst result = [];\r\n\r\n\t\tthis.processElement(document);\r\n\t\tconst sections = this.splitBySection(document.children);\r\n\t\tlet prevProps = null;\r\n\r\n\t\tfor (let i = 0, l = sections.length; i < l; i++) {\r\n\t\t\tthis.currentFootnoteIds = [];\r\n\r\n\t\t\tconst section = sections[i];\r\n\t\t\tconst props = section.sectProps || document.props;\r\n\t\t\tconst sectionElement = this.createSection(this.className, props);\r\n\t\t\tthis.renderStyleValues(document.cssStyle, sectionElement);\r\n\r\n\t\t\tthis.options.renderHeaders && this.renderHeaderFooter(props.headerRefs, props,\r\n\t\t\t\tresult.length, prevProps != props, sectionElement);\r\n\r\n\t\t\tvar contentElement = this.createElement(\"article\");\r\n\t\t\tthis.renderElements(section.elements, contentElement);\r\n\t\t\tsectionElement.appendChild(contentElement);\r\n\r\n\t\t\tif (this.options.renderFootnotes) {\r\n\t\t\t\tthis.renderNotes(this.currentFootnoteIds, this.footnoteMap, sectionElement);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.options.renderEndnotes && i == l - 1) {\r\n\t\t\t\tthis.renderNotes(this.currentEndnoteIds, this.endnoteMap, sectionElement);\r\n\t\t\t}\r\n\r\n\t\t\tthis.options.renderFooters && this.renderHeaderFooter(props.footerRefs, props,\r\n\t\t\t\tresult.length, prevProps != props, sectionElement);\r\n\r\n\t\t\tresult.push(sectionElement);\r\n\t\t\tprevProps = props;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderHeaderFooter(refs: FooterHeaderReference[], props: SectionProperties, page: number, firstOfSection: boolean, into: HTMLElement) {\r\n\t\tif (!refs) return;\r\n\r\n\t\tvar ref = (props.titlePage && firstOfSection ? refs.find(x => x.type == \"first\") : null)\r\n\t\t\t?? (page % 2 == 1 ? refs.find(x => x.type == \"even\") : null)\r\n\t\t\t?? refs.find(x => x.type == \"default\");\r\n\r\n\t\tvar part = ref && this.document.findPartByRelId(ref.id, this.document.documentPart) as BaseHeaderFooterPart;\r\n\r\n\t\tif (part) {\r\n\t\t\tthis.currentPart = part;\r\n\t\t\tif (!this.usedHederFooterParts.includes(part.path)) {\r\n\t\t\t\tthis.processElement(part.rootElement);\r\n\t\t\t\tthis.usedHederFooterParts.push(part.path);\r\n\t\t\t}\r\n\t\t\tthis.renderElements([part.rootElement], into);\r\n\t\t\tthis.currentPart = null;\r\n\t\t}\r\n\t}\r\n\r\n\tisPageBreakElement(elem: OpenXmlElement): boolean {\r\n\t\tif (elem.type != DomType.Break)\r\n\t\t\treturn false;\r\n\r\n\t\tif ((elem as WmlBreak).break == \"lastRenderedPageBreak\")\r\n\t\t\treturn !this.options.ignoreLastRenderedPageBreak;\r\n\r\n\t\treturn (elem as WmlBreak).break == \"page\";\r\n\t}\r\n\r\n\tsplitBySection(elements: OpenXmlElement[]): { sectProps: SectionProperties, elements: OpenXmlElement[] }[] {\r\n\t\tvar current = { sectProps: null, elements: [] };\r\n\t\tvar result = [current];\r\n\r\n\t\tfor (let elem of elements) {\r\n\t\t\tif (elem.type == DomType.Paragraph) {\r\n\t\t\t\tconst s = this.findStyle((elem as WmlParagraph).styleName);\r\n\r\n\t\t\t\tif (s?.paragraphProps?.pageBreakBefore) {\r\n\t\t\t\t\tcurrent.sectProps = sectProps;\r\n\t\t\t\t\tcurrent = { sectProps: null, elements: [] };\r\n\t\t\t\t\tresult.push(current);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcurrent.elements.push(elem);\r\n\r\n\t\t\tif (elem.type == DomType.Paragraph) {\r\n\t\t\t\tconst p = elem as WmlParagraph;\r\n\r\n\t\t\t\tvar sectProps = p.sectionProps;\r\n\t\t\t\tvar pBreakIndex = -1;\r\n\t\t\t\tvar rBreakIndex = -1;\r\n\r\n\t\t\t\tif (this.options.breakPages && p.children) {\r\n\t\t\t\t\tpBreakIndex = p.children.findIndex(r => {\r\n\t\t\t\t\t\trBreakIndex = r.children?.findIndex(this.isPageBreakElement.bind(this)) ?? -1;\r\n\t\t\t\t\t\treturn rBreakIndex != -1;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (sectProps || pBreakIndex != -1) {\r\n\t\t\t\t\tcurrent.sectProps = sectProps;\r\n\t\t\t\t\tcurrent = { sectProps: null, elements: [] };\r\n\t\t\t\t\tresult.push(current);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (pBreakIndex != -1) {\r\n\t\t\t\t\tlet breakRun = p.children[pBreakIndex];\r\n\t\t\t\t\tlet splitRun = rBreakIndex < breakRun.children.length - 1;\r\n\r\n\t\t\t\t\tif (pBreakIndex < p.children.length - 1 || splitRun) {\r\n\t\t\t\t\t\tvar children = elem.children;\r\n\t\t\t\t\t\tvar newParagraph = { ...elem, children: children.slice(pBreakIndex) };\r\n\t\t\t\t\t\telem.children = children.slice(0, pBreakIndex);\r\n\t\t\t\t\t\tcurrent.elements.push(newParagraph);\r\n\r\n\t\t\t\t\t\tif (splitRun) {\r\n\t\t\t\t\t\t\tlet runChildren = breakRun.children;\r\n\t\t\t\t\t\t\tlet newRun = { ...breakRun, children: runChildren.slice(0, rBreakIndex) };\r\n\t\t\t\t\t\t\telem.children.push(newRun);\r\n\t\t\t\t\t\t\tbreakRun.children = runChildren.slice(rBreakIndex);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet currentSectProps = null;\r\n\r\n\t\tfor (let i = result.length - 1; i >= 0; i--) {\r\n\t\t\tif (result[i].sectProps == null) {\r\n\t\t\t\tresult[i].sectProps = currentSectProps;\r\n\t\t\t} else {\r\n\t\t\t\tcurrentSectProps = result[i].sectProps\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderWrapper(children: HTMLElement[]) {\r\n\t\treturn this.createElement(\"div\", { className: `${this.className}-wrapper` }, children);\r\n\t}\r\n\r\n\trenderDefaultStyle() {\r\n\t\tvar c = this.className;\r\n\t\tvar styleText = `\r\n.${c}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \r\n.${c}-wrapper>section.${c} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }\r\n.${c} { color: black; }\r\nsection.${c} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\r\nsection.${c}>article { margin-bottom: auto; }\r\n.${c} table { border-collapse: collapse; }\r\n.${c} table td, .${c} table th { vertical-align: top; }\r\n.${c} p { margin: 0pt; min-height: 1em; }\r\n.${c} span { white-space: pre-wrap; overflow-wrap: break-word; }\r\n.${c} a { color: inherit; text-decoration: inherit; }\r\n`;\r\n\r\n\t\treturn createStyleElement(styleText);\r\n\t}\r\n\r\n\t// renderNumbering2(numberingPart: NumberingPartProperties, container: HTMLElement): HTMLElement {\r\n\t//     let css = \"\";\r\n\t//     const numberingMap = keyBy(numberingPart.abstractNumberings, x => x.id);\r\n\t//     const bulletMap = keyBy(numberingPart.bulletPictures, x => x.id);\r\n\t//     const topCounters = [];\r\n\r\n\t//     for(let num of numberingPart.numberings) {\r\n\t//         const absNum = numberingMap[num.abstractId];\r\n\r\n\t//         for(let lvl of absNum.levels) {\r\n\t//             const className = this.numberingClass(num.id, lvl.level);\r\n\t//             let listStyleType = \"none\";\r\n\r\n\t//             if(lvl.text && lvl.format == 'decimal') {\r\n\t//                 const counter = this.numberingCounter(num.id, lvl.level);\r\n\r\n\t//                 if (lvl.level > 0) {\r\n\t//                     css += this.styleToString(`p.${this.numberingClass(num.id, lvl.level - 1)}`, {\r\n\t//                         \"counter-reset\": counter\r\n\t//                     });\r\n\t//                 } else {\r\n\t//                     topCounters.push(counter);\r\n\t//                 }\r\n\r\n\t//                 css += this.styleToString(`p.${className}:before`, {\r\n\t//                     \"content\": this.levelTextToContent(lvl.text, num.id),\r\n\t//                     \"counter-increment\": counter\r\n\t//                 });\r\n\t//             } else if(lvl.bulletPictureId) {\r\n\t//                 let pict = bulletMap[lvl.bulletPictureId];\r\n\t//                 let variable = `--${this.className}-${pict.referenceId}`.toLowerCase();\r\n\r\n\t//                 css += this.styleToString(`p.${className}:before`, {\r\n\t//                     \"content\": \"' '\",\r\n\t//                     \"display\": \"inline-block\",\r\n\t//                     \"background\": `var(${variable})`\r\n\t//                 }, pict.style);\r\n\r\n\t//                 this.document.loadNumberingImage(pict.referenceId).then(data => {\r\n\t//                     var text = `.${this.className}-wrapper { ${variable}: url(${data}) }`;\r\n\t//                     container.appendChild(createStyleElement(text));\r\n\t//                 });\r\n\t//             } else {\r\n\t//                 listStyleType = this.numFormatToCssValue(lvl.format);\r\n\t//             }\r\n\r\n\t//             css += this.styleToString(`p.${className}`, {\r\n\t//                 \"display\": \"list-item\",\r\n\t//                 \"list-style-position\": \"inside\",\r\n\t//                 \"list-style-type\": listStyleType,\r\n\t//                 //TODO\r\n\t//                 //...num.style\r\n\t//             });\r\n\t//         }\r\n\t//     }\r\n\r\n\t//     if (topCounters.length > 0) {\r\n\t//         css += this.styleToString(`.${this.className}-wrapper`, {\r\n\t//             \"counter-reset\": topCounters.join(\" \")\r\n\t//         });\r\n\t//     }\r\n\r\n\t//     return createStyleElement(css);\r\n\t// }\r\n\r\n\trenderNumbering(numberings: IDomNumbering[], styleContainer: HTMLElement) {\r\n\t\tvar styleText = \"\";\r\n\t\tvar rootCounters = [];\r\n\r\n\t\tfor (var num of numberings) {\r\n\t\t\tvar selector = `p.${this.numberingClass(num.id, num.level)}`;\r\n\t\t\tvar listStyleType = \"none\";\r\n\r\n\t\t\tif (num.bullet) {\r\n\t\t\t\tlet valiable = `--${this.className}-${num.bullet.src}`.toLowerCase();\r\n\r\n\t\t\t\tstyleText += this.styleToString(`${selector}:before`, {\r\n\t\t\t\t\t\"content\": \"' '\",\r\n\t\t\t\t\t\"display\": \"inline-block\",\r\n\t\t\t\t\t\"background\": `var(${valiable})`\r\n\t\t\t\t}, num.bullet.style);\r\n\r\n\t\t\t\tthis.document.loadNumberingImage(num.bullet.src).then(data => {\r\n\t\t\t\t\tvar text = `${this.rootSelector} { ${valiable}: url(${data}) }`;\r\n\t\t\t\t\tstyleContainer.appendChild(createStyleElement(text));\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse if (num.levelText) {\r\n\t\t\t\tlet counter = this.numberingCounter(num.id, num.level);\r\n\r\n\t\t\t\tif (num.level > 0) {\r\n\t\t\t\t\tstyleText += this.styleToString(`p.${this.numberingClass(num.id, num.level - 1)}`, {\r\n\t\t\t\t\t\t\"counter-reset\": counter\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\trootCounters.push(counter);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstyleText += this.styleToString(`${selector}:before`, {\r\n\t\t\t\t\t\"content\": this.levelTextToContent(num.levelText, num.suff, num.id, this.numFormatToCssValue(num.format)),\r\n\t\t\t\t\t\"counter-increment\": counter,\r\n\t\t\t\t\t...num.rStyle,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlistStyleType = this.numFormatToCssValue(num.format);\r\n\t\t\t}\r\n\r\n\t\t\tstyleText += this.styleToString(selector, {\r\n\t\t\t\t\"display\": \"list-item\",\r\n\t\t\t\t\"list-style-position\": \"inside\",\r\n\t\t\t\t\"list-style-type\": listStyleType,\r\n\t\t\t\t...num.pStyle\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (rootCounters.length > 0) {\r\n\t\t\tstyleText += this.styleToString(this.rootSelector, {\r\n\t\t\t\t\"counter-reset\": rootCounters.join(\" \")\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn createStyleElement(styleText);\r\n\t}\r\n\r\n\trenderStyles(styles: IDomStyle[]): HTMLElement {\r\n\t\tvar styleText = \"\";\r\n\t\tconst stylesMap = this.styleMap;\r\n\t\tconst defautStyles = keyBy(styles.filter(s => s.isDefault), s => s.target);\r\n\r\n\t\tfor (const style of styles) {\r\n\t\t\tvar subStyles = style.styles;\r\n\r\n\t\t\tif (style.linked) {\r\n\t\t\t\tvar linkedStyle = style.linked && stylesMap[style.linked];\r\n\r\n\t\t\t\tif (linkedStyle)\r\n\t\t\t\t\tsubStyles = subStyles.concat(linkedStyle.styles);\r\n\t\t\t\telse if (this.options.debug)\r\n\t\t\t\t\tconsole.warn(`Can't find linked style ${style.linked}`);\r\n\t\t\t}\r\n\r\n\t\t\tfor (const subStyle of subStyles) {\r\n\t\t\t\t//TODO temporary disable modificators until test it well\r\n\t\t\t\tvar selector = `${style.target ?? ''}.${style.cssName}`; //${subStyle.mod ?? ''} \r\n\r\n\t\t\t\tif (style.target != subStyle.target)\r\n\t\t\t\t\tselector += ` ${subStyle.target}`;\r\n\r\n\t\t\t\tif (defautStyles[style.target] == style)\r\n\t\t\t\t\tselector = `.${this.className} ${style.target}, ` + selector;\r\n\r\n\t\t\t\tstyleText += this.styleToString(selector, subStyle.values);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn createStyleElement(styleText);\r\n\t}\r\n\r\n\trenderNotes(noteIds: string[], notesMap: Record<string, WmlBaseNote>, into: HTMLElement) {\r\n\t\tvar notes = noteIds.map(id => notesMap[id]).filter(x => x);\r\n\r\n\t\tif (notes.length > 0) {\r\n\t\t\tvar result = this.createElement(\"ol\", null, this.renderElements(notes));\r\n\t\t\tinto.appendChild(result);\r\n\t\t}\r\n\t}\r\n\r\n\trenderElement(elem: OpenXmlElement): Node | Node[] {\r\n\t\tswitch (elem.type) {\r\n\t\t\tcase DomType.Paragraph:\r\n\t\t\t\treturn this.renderParagraph(elem as WmlParagraph);\r\n\r\n\t\t\tcase DomType.BookmarkStart:\r\n\t\t\t\treturn this.renderBookmarkStart(elem as WmlBookmarkStart);\r\n\r\n\t\t\tcase DomType.BookmarkEnd:\r\n\t\t\t\treturn null; //ignore bookmark end\r\n\r\n\t\t\tcase DomType.Run:\r\n\t\t\t\treturn this.renderRun(elem as WmlRun);\r\n\r\n\t\t\tcase DomType.Table:\r\n\t\t\t\treturn this.renderTable(elem);\r\n\r\n\t\t\tcase DomType.Row:\r\n\t\t\t\treturn this.renderTableRow(elem);\r\n\r\n\t\t\tcase DomType.Cell:\r\n\t\t\t\treturn this.renderTableCell(elem);\r\n\r\n\t\t\tcase DomType.Hyperlink:\r\n\t\t\t\treturn this.renderHyperlink(elem);\r\n\r\n\t\t\tcase DomType.Drawing:\r\n\t\t\t\treturn this.renderDrawing(elem);\r\n\r\n\t\t\tcase DomType.Image:\r\n\t\t\t\treturn this.renderImage(elem as IDomImage);\r\n\r\n\t\t\tcase DomType.Text:\r\n\t\t\t\treturn this.renderText(elem as WmlText);\r\n\r\n\t\t\tcase DomType.Text:\r\n\t\t\t\treturn this.renderText(elem as WmlText);\r\n\r\n\t\t\tcase DomType.DeletedText:\r\n\t\t\t\treturn this.renderDeletedText(elem as WmlText);\r\n\t\r\n\t\t\tcase DomType.Tab:\r\n\t\t\t\treturn this.renderTab(elem);\r\n\r\n\t\t\tcase DomType.Symbol:\r\n\t\t\t\treturn this.renderSymbol(elem as WmlSymbol);\r\n\r\n\t\t\tcase DomType.Break:\r\n\t\t\t\treturn this.renderBreak(elem as WmlBreak);\r\n\r\n\t\t\tcase DomType.Footer:\r\n\t\t\t\treturn this.renderContainer(elem, \"footer\");\r\n\r\n\t\t\tcase DomType.Header:\r\n\t\t\t\treturn this.renderContainer(elem, \"header\");\r\n\r\n\t\t\tcase DomType.Footnote:\r\n\t\t\tcase DomType.Endnote:\r\n\t\t\t\treturn this.renderContainer(elem, \"li\");\r\n\r\n\t\t\tcase DomType.FootnoteReference:\r\n\t\t\t\treturn this.renderFootnoteReference(elem as WmlNoteReference);\r\n\r\n\t\t\tcase DomType.EndnoteReference:\r\n\t\t\t\treturn this.renderEndnoteReference(elem as WmlNoteReference);\r\n\r\n\t\t\tcase DomType.NoBreakHyphen:\r\n\t\t\t\treturn this.createElement(\"wbr\");\r\n\r\n\t\t\tcase DomType.VmlPicture:\r\n\t\t\t\treturn this.renderVmlPicture(elem);\r\n\r\n\t\t\tcase DomType.VmlElement:\r\n\t\t\t\treturn this.renderVmlElement(elem as VmlElement);\r\n\t\r\n\t\t\tcase DomType.MmlMath:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"math\", { xmlns: ns.mathML });\r\n\t\r\n\t\t\tcase DomType.MmlMathParagraph:\r\n\t\t\t\treturn this.renderContainer(elem, \"span\");\r\n\r\n\t\t\tcase DomType.MmlFraction:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"mfrac\");\r\n\r\n\t\t\tcase DomType.MmlNumerator:\r\n\t\t\tcase DomType.MmlDenominator:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"mrow\");\r\n\r\n\t\t\tcase DomType.MmlRadical:\r\n\t\t\t\treturn this.renderMmlRadical(elem);\r\n\r\n\t\t\tcase DomType.MmlDegree:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"mn\");\r\n\r\n\t\t\tcase DomType.MmlSuperscript:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"msup\");\r\n\r\n\t\t\tcase DomType.MmlSubscript:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"msub\");\r\n\t\r\n\t\t\tcase DomType.MmlBase:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"mrow\");\r\n\r\n\t\t\tcase DomType.MmlSuperArgument:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"mn\");\r\n\r\n\t\t\tcase DomType.MmlSubArgument:\r\n\t\t\t\treturn this.renderContainerNS(elem, ns.mathML, \"mn\");\r\n\r\n\t\t\tcase DomType.MmlDelimiter:\r\n\t\t\t\treturn this.renderMmlDelimiter(elem);\r\n\r\n\t\t\tcase DomType.MmlNary:\r\n\t\t\t\treturn this.renderMmlNary(elem);\r\n\r\n\t\t\tcase DomType.Inserted:\r\n\t\t\t\treturn this.renderInserted(elem);\r\n\r\n\t\t\tcase DomType.Deleted:\r\n\t\t\t\treturn this.renderDeleted(elem);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\trenderChildren(elem: OpenXmlElement, into?: Element): Node[] {\r\n\t\treturn this.renderElements(elem.children, into);\r\n\t}\r\n\r\n\trenderElements(elems: OpenXmlElement[], into?: Element): Node[] {\r\n\t\tif (elems == null)\r\n\t\t\treturn null;\r\n\r\n\t\tvar result = elems.flatMap(e => this.renderElement(e)).filter(e => e != null);\r\n\r\n\t\tif (into)\r\n\t\t\tappendChildren(into, result);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderContainer(elem: OpenXmlElement, tagName: keyof HTMLElementTagNameMap, props?: Record<string, any>) {\r\n\t\treturn this.createElement(tagName, props, this.renderChildren(elem));\r\n\t}\r\n\r\n\trenderContainerNS(elem: OpenXmlElement, ns: string, tagName: string, props?: Record<string, any>) {\r\n\t\treturn createElementNS(ns, tagName, props, this.renderChildren(elem));\r\n\t}\r\n\r\n\trenderParagraph(elem: WmlParagraph) {\r\n\t\tvar result = this.createElement(\"p\");\r\n\r\n\t\tconst style = this.findStyle(elem.styleName);\r\n\t\telem.tabs ??= style?.paragraphProps?.tabs;  //TODO\r\n\r\n\t\tthis.renderClass(elem, result);\r\n\t\tthis.renderChildren(elem, result);\r\n\t\tthis.renderStyleValues(elem.cssStyle, result);\r\n\t\tthis.renderCommonProperties(result.style, elem);\r\n\r\n\t\tconst numbering = elem.numbering ?? style?.paragraphProps?.numbering;\r\n\r\n\t\tif (numbering) {\r\n\t\t\tresult.classList.add(this.numberingClass(numbering.id, numbering.level));\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderRunProperties(style: any, props: RunProperties) {\r\n\t\tthis.renderCommonProperties(style, props);\r\n\t}\r\n\r\n\trenderCommonProperties(style: any, props: CommonProperties) {\r\n\t\tif (props == null)\r\n\t\t\treturn;\r\n\r\n\t\tif (props.color) {\r\n\t\t\tstyle[\"color\"] = props.color;\r\n\t\t}\r\n\r\n\t\tif (props.fontSize) {\r\n\t\t\tstyle[\"font-size\"] = props.fontSize;\r\n\t\t}\r\n\t}\r\n\r\n\trenderHyperlink(elem: WmlHyperlink) {\r\n\t\tvar result = this.createElement(\"a\");\r\n\r\n\t\tthis.renderChildren(elem, result);\r\n\t\tthis.renderStyleValues(elem.cssStyle, result);\r\n\r\n\t\tif (elem.href) {\r\n\t\t\tresult.href = elem.href;\r\n\t\t} else if(elem.id) {\r\n\t\t\tconst rel = this.document.documentPart.rels\r\n\t\t\t\t.find(it => it.id == elem.id && it.targetMode === \"External\");\r\n\t\t\tresult.href = rel?.target;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderDrawing(elem: OpenXmlElement) {\r\n\t\tvar result = this.createElement(\"div\");\r\n\r\n\t\tresult.style.display = \"inline-block\";\r\n\t\tresult.style.position = \"relative\";\r\n\t\tresult.style.textIndent = \"0px\";\r\n\r\n\t\tthis.renderChildren(elem, result);\r\n\t\tthis.renderStyleValues(elem.cssStyle, result);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderImage(elem: IDomImage) {\r\n\t\tlet result = this.createElement(\"img\");\r\n\r\n\t\tthis.renderStyleValues(elem.cssStyle, result);\r\n\r\n\t\tif (this.document) {\r\n\t\t\tthis.document.loadDocumentImage(elem.src, this.currentPart).then(x => {\r\n\t\t\t\tresult.src = x;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderText(elem: WmlText) {\r\n\t\treturn this.htmlDocument.createTextNode(elem.text);\r\n\t}\r\n\r\n\trenderDeletedText(elem: WmlText) {\r\n\t\treturn this.options.renderEndnotes ? this.htmlDocument.createTextNode(elem.text) : null;\r\n\t}\r\n\r\n\trenderBreak(elem: WmlBreak) {\r\n\t\tif (elem.break == \"textWrapping\") {\r\n\t\t\treturn this.createElement(\"br\");\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\trenderInserted(elem: OpenXmlElement): Node | Node[] {\r\n\t\tif (this.options.renderChanges)\r\n\t\t\treturn this.renderContainer(elem, \"ins\");\r\n\r\n\t\treturn this.renderChildren(elem);\r\n\t}\r\n\r\n\trenderDeleted(elem: OpenXmlElement): Node {\r\n\t\tif (this.options.renderChanges)\r\n\t\t\treturn this.renderContainer(elem, \"del\");\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\trenderSymbol(elem: WmlSymbol) {\r\n\t\tvar span = this.createElement(\"span\");\r\n\t\tspan.style.fontFamily = elem.font;\r\n\t\tspan.innerHTML = `&#x${elem.char};`\r\n\t\treturn span;\r\n\t}\r\n\r\n\trenderFootnoteReference(elem: WmlNoteReference) {\r\n\t\tvar result = this.createElement(\"sup\");\r\n\t\tthis.currentFootnoteIds.push(elem.id);\r\n\t\tresult.textContent = `${this.currentFootnoteIds.length}`;\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderEndnoteReference(elem: WmlNoteReference) {\r\n\t\tvar result = this.createElement(\"sup\");\r\n\t\tthis.currentEndnoteIds.push(elem.id);\r\n\t\tresult.textContent = `${this.currentEndnoteIds.length}`;\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderTab(elem: OpenXmlElement) {\r\n\t\tvar tabSpan = this.createElement(\"span\");\r\n\r\n\t\ttabSpan.innerHTML = \"&emsp;\";//\"&nbsp;\";\r\n\r\n\t\tif (this.options.experimental) {\r\n\t\t\ttabSpan.className = this.tabStopClass();\r\n\t\t\tvar stops = findParent<WmlParagraph>(elem, DomType.Paragraph)?.tabs;\r\n\t\t\tthis.currentTabs.push({ stops, span: tabSpan });\r\n\t\t}\r\n\r\n\t\treturn tabSpan;\r\n\t}\r\n\r\n\trenderBookmarkStart(elem: WmlBookmarkStart): HTMLElement {\r\n\t\tvar result = this.createElement(\"span\");\r\n\t\tresult.id = elem.name;\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderRun(elem: WmlRun) {\r\n\t\tif (elem.fieldRun)\r\n\t\t\treturn null;\r\n\r\n\t\tconst result = this.createElement(\"span\");\r\n\r\n\t\tif (elem.id)\r\n\t\t\tresult.id = elem.id;\r\n\r\n\t\tthis.renderClass(elem, result);\r\n\t\tthis.renderStyleValues(elem.cssStyle, result);\r\n\r\n\t\tif (elem.verticalAlign) {\r\n\t\t\tconst wrapper = this.createElement(elem.verticalAlign as any);\r\n\t\t\tthis.renderChildren(elem, wrapper);\r\n\t\t\tresult.appendChild(wrapper);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.renderChildren(elem, result);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderTable(elem: WmlTable) {\r\n\t\tlet result = this.createElement(\"table\");\r\n\r\n\t\tthis.tableCellPositions.push(this.currentCellPosition);\r\n\t\tthis.tableVerticalMerges.push(this.currentVerticalMerge);\r\n\t\tthis.currentVerticalMerge = {};\r\n\t\tthis.currentCellPosition = { col: 0, row: 0 };\r\n\r\n\t\tif (elem.columns)\r\n\t\t\tresult.appendChild(this.renderTableColumns(elem.columns));\r\n\r\n\t\tthis.renderClass(elem, result);\r\n\t\tthis.renderChildren(elem, result);\r\n\t\tthis.renderStyleValues(elem.cssStyle, result);\r\n\r\n\t\tthis.currentVerticalMerge = this.tableVerticalMerges.pop();\r\n\t\tthis.currentCellPosition = this.tableCellPositions.pop();\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderTableColumns(columns: WmlTableColumn[]) {\r\n\t\tlet result = this.createElement(\"colgroup\");\r\n\r\n\t\tfor (let col of columns) {\r\n\t\t\tlet colElem = this.createElement(\"col\");\r\n\r\n\t\t\tif (col.width)\r\n\t\t\t\tcolElem.style.width = col.width;\r\n\r\n\t\t\tresult.appendChild(colElem);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderTableRow(elem: OpenXmlElement) {\r\n\t\tlet result = this.createElement(\"tr\");\r\n\r\n\t\tthis.currentCellPosition.col = 0;\r\n\r\n\t\tthis.renderClass(elem, result);\r\n\t\tthis.renderChildren(elem, result);\r\n\t\tthis.renderStyleValues(elem.cssStyle, result);\r\n\r\n\t\tthis.currentCellPosition.row++;\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderTableCell(elem: WmlTableCell) {\r\n\t\tlet result = this.createElement(\"td\");\r\n\r\n\t\tif (elem.verticalMerge) {\r\n\t\t\tconst key = this.currentCellPosition.col;\r\n\r\n\t\t\tif (elem.verticalMerge == \"restart\") {\r\n\t\t\t\tthis.currentVerticalMerge[key] = result;\r\n\t\t\t\tresult.rowSpan = 1;\r\n\t\t\t} else if (this.currentVerticalMerge[key]) {\r\n\t\t\t\tthis.currentVerticalMerge[key].rowSpan += 1;\r\n\t\t\t\tresult.style.display = \"none\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.renderClass(elem, result);\r\n\t\tthis.renderChildren(elem, result);\r\n\t\tthis.renderStyleValues(elem.cssStyle, result);\r\n\r\n\t\tif (elem.span)\r\n\t\t\tresult.colSpan = elem.span;\r\n\r\n\t\tthis.currentCellPosition.col++;\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderVmlPicture(elem: OpenXmlElement) {\r\n\t\tvar result = createElement(\"div\");\r\n\t\tthis.renderChildren(elem, result);\r\n\t\treturn result;\r\n\t}\r\n\r\n\trenderVmlElement(elem: VmlElement): SVGElement {\r\n\t\tvar container = createSvgElement(\"svg\");\r\n\r\n\t\tcontainer.setAttribute(\"style\", elem.cssStyleText);\r\n\r\n\t\tconst result = createSvgElement(elem.tagName as any);\r\n\t\tObject.entries(elem.attrs).forEach(([k, v]) => result.setAttribute(k, v));\r\n\r\n\t\tif (elem.imageHref?.id) {\r\n\t\t\tthis.document?.loadDocumentImage(elem.imageHref.id, this.currentPart)\r\n\t\t\t\t.then(x => result.setAttribute(\"href\", x));\r\n\t\t}\r\n\t\t\r\n\t\tcontainer.appendChild(result);\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tconst bb = (container.firstElementChild as any).getBBox();\r\n\r\n\t\t\tcontainer.setAttribute(\"width\", `${Math.ceil(bb.x +  bb.width)}`);\r\n\t\t\tcontainer.setAttribute(\"height\", `${Math.ceil(bb.y + bb.height)}`);\r\n\t\t}, 0);\r\n\r\n\t\treturn container;\r\n\t}\r\n\r\n\trenderMmlRadical(elem: OpenXmlElement): HTMLElement {\r\n\t\tconst base = elem.children.find(el => el.type == DomType.MmlBase);\r\n\r\n\t\tif (elem.props?.hideDegree) {\r\n\t\t\treturn createElementNS(ns.mathML, \"msqrt\", null, this.renderElements([base]));\r\n\t\t}\r\n\r\n\t\tconst degree = elem.children.find(el => el.type == DomType.MmlDegree);\r\n\t\treturn createElementNS(ns.mathML, \"mroot\", null, this.renderElements([base, degree]));\r\n\t}\r\n\r\n\trenderMmlDelimiter(elem: OpenXmlElement): HTMLElement {\t\t\r\n\t\tconst children = [];\r\n\r\n\t\tchildren.push(createElementNS(ns.mathML, \"mo\", null, [elem.props.beginChar ?? '(']));\r\n\t\tchildren.push(...this.renderElements(elem.children));\r\n\t\tchildren.push(createElementNS(ns.mathML, \"mo\", null, [elem.props.endChar ?? ')']));\r\n\r\n\t\treturn createElementNS(ns.mathML, \"mrow\", null, children);\r\n\t}\r\n\r\n\trenderMmlNary(elem: OpenXmlElement): HTMLElement {\t\t\r\n\t\tconst children = [];\r\n\t\tconst grouped = keyBy(elem.children, x => x.type);\r\n\r\n\t\tconst sup = grouped[DomType.MmlSuperArgument];\r\n\t\tconst sub = grouped[DomType.MmlSubArgument];\r\n\t\tconst supElem = sup ? createElementNS(ns.mathML, \"mo\", null, asArray(this.renderElement(sup))) : null;\r\n\t\tconst subElem = sub ? createElementNS(ns.mathML, \"mo\", null, asArray(this.renderElement(sub))) : null;\r\n\r\n\t\tif (elem.props?.char) {\r\n\t\t\tconst charElem = createElementNS(ns.mathML, \"mo\", null, [elem.props.char]);\r\n\r\n\t\t\tif (supElem || subElem) {\r\n\t\t\t\tchildren.push(createElementNS(ns.mathML, \"munderover\", null, [charElem, subElem, supElem]));\r\n\t\t\t} else if(supElem) {\r\n\t\t\t\tchildren.push(createElementNS(ns.mathML, \"mover\", null, [charElem, supElem]));\r\n\t\t\t} else if(subElem) {\r\n\t\t\t\tchildren.push(createElementNS(ns.mathML, \"munder\", null, [charElem, subElem]));\r\n\t\t\t} else {\r\n\t\t\t\tchildren.push(charElem);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tchildren.push(...this.renderElements(grouped[DomType.MmlBase].children));\r\n\r\n\t\treturn createElementNS(ns.mathML, \"mrow\", null, children);\r\n\t}\r\n\r\n\trenderStyleValues(style: Record<string, string>, ouput: HTMLElement) {\r\n\t\tObject.assign(ouput.style, style);\r\n\t}\r\n\r\n\trenderClass(input: OpenXmlElement, ouput: HTMLElement) {\r\n\t\tif (input.className)\r\n\t\t\touput.className = input.className;\r\n\r\n\t\tif (input.styleName)\r\n\t\t\touput.classList.add(this.processStyleName(input.styleName));\r\n\t}\r\n\r\n\tfindStyle(styleName: string) {\r\n\t\treturn styleName && this.styleMap?.[styleName];\r\n\t}\r\n\r\n\tnumberingClass(id: string, lvl: number) {\r\n\t\treturn `${this.className}-num-${id}-${lvl}`;\r\n\t}\r\n\r\n\ttabStopClass() {\r\n\t\treturn `${this.className}-tab-stop`;\r\n\t}\r\n\r\n\tstyleToString(selectors: string, values: Record<string, string>, cssText: string = null) {\r\n\t\tlet result = `${selectors} {\\r\\n`;\r\n\r\n\t\tfor (const key in values) {\r\n\t\t\tresult += `  ${key}: ${values[key]};\\r\\n`;\r\n\t\t}\r\n\r\n\t\tif (cssText)\r\n\t\t\tresult += cssText;\r\n\r\n\t\treturn result + \"}\\r\\n\";\r\n\t}\r\n\r\n\tnumberingCounter(id: string, lvl: number) {\r\n\t\treturn `${this.className}-num-${id}-${lvl}`;\r\n\t}\r\n\r\n\tlevelTextToContent(text: string, suff: string, id: string, numformat: string) {\r\n\t\tconst suffMap = {\r\n\t\t\t\"tab\": \"\\\\9\",\r\n\t\t\t\"space\": \"\\\\a0\",\r\n\t\t};\r\n\r\n\t\tvar result = text.replace(/%\\d*/g, s => {\r\n\t\t\tlet lvl = parseInt(s.substring(1), 10) - 1;\r\n\t\t\treturn `\"counter(${this.numberingCounter(id, lvl)}, ${numformat})\"`;\r\n\t\t});\r\n\r\n\t\treturn `\"${result}${suffMap[suff] ?? \"\"}\"`;\r\n\t}\r\n\r\n\tnumFormatToCssValue(format: string) {\r\n\t\tvar mapping = {\r\n\t\t\t\"none\": \"none\",\r\n\t\t\t\"bullet\": \"disc\",\r\n\t\t\t\"decimal\": \"decimal\",\r\n\t\t\t\"lowerLetter\": \"lower-alpha\",\r\n\t\t\t\"upperLetter\": \"upper-alpha\",\r\n\t\t\t\"lowerRoman\": \"lower-roman\",\r\n\t\t\t\"upperRoman\": \"upper-roman\",\r\n\t\t};\r\n\r\n\t\treturn mapping[format] || format;\r\n\t}\r\n\r\n\trefreshTabStops() {\r\n\t\tif (!this.options.experimental)\r\n\t\t\treturn;\r\n\r\n\t\tclearTimeout(this.tabsTimeout);\r\n\r\n\t\tthis.tabsTimeout = setTimeout(() => {\r\n\t\t\tconst pixelToPoint = computePixelToPoint();\r\n\r\n\t\t\tfor (let tab of this.currentTabs) {\r\n\t\t\t\tupdateTabStop(tab.span, tab.stops, this.defaultTabSize, pixelToPoint);\r\n\t\t\t}\r\n\t\t}, 500);\r\n\t}\r\n\r\n\tcreateElement = createElement;\r\n}\r\n\r\ntype ChildType = Node | string;\r\n\r\nfunction createElement<T extends keyof HTMLElementTagNameMap>(\r\n\ttagName: T,\r\n\tprops?: Partial<Record<keyof HTMLElementTagNameMap[T], any>>,\r\n\tchildren?: ChildType[]\r\n): HTMLElementTagNameMap[T] {\r\n\treturn createElementNS(undefined, tagName, props, children);\r\n}\r\n\r\nfunction createSvgElement<T extends keyof SVGElementTagNameMap>(\r\n\ttagName: T,\r\n\tprops?: Partial<Record<keyof SVGElementTagNameMap[T], any>>,\r\n\tchildren?: ChildType[]\r\n): SVGElementTagNameMap[T] {\r\n\treturn createElementNS(ns.svg, tagName, props, children);\r\n}\r\n\r\nfunction createElementNS(ns: string, tagName: string, props?: Partial<Record<any, any>>, children?: ChildType[]): any {\r\n\tvar result = ns ? document.createElementNS(ns, tagName) : document.createElement(tagName);\r\n\tObject.assign(result, props);\r\n\tchildren && appendChildren(result, children);\r\n\treturn result;\r\n}\r\n\r\nfunction removeAllElements(elem: HTMLElement) {\r\n\telem.innerHTML = '';\r\n}\r\n\r\nfunction appendChildren(elem: Element, children: (Node | string)[]) {\r\n\tchildren.forEach(c => elem.appendChild(isString(c) ? document.createTextNode(c) : c));\r\n}\r\n\r\nfunction createStyleElement(cssText: string) {\r\n\treturn createElement(\"style\", { innerHTML: cssText });\r\n}\r\n\r\nfunction appendComment(elem: HTMLElement, comment: string) {\r\n\telem.appendChild(document.createComment(comment));\r\n}\r\n\r\nfunction findParent<T extends OpenXmlElement>(elem: OpenXmlElement, type: DomType): T {\r\n\tvar parent = elem.parent;\r\n\r\n\twhile (parent != null && parent.type != type)\r\n\t\tparent = parent.parent;\r\n\r\n\treturn <T>parent;\r\n}\r\n","import { Length } from \"./document/common\";\r\nimport { ParagraphTab } from \"./document/paragraph\";\r\n\r\ninterface TabStop {\r\n\tpos: number;\r\n\tleader: string;\r\n\tstyle: string;\r\n}\r\n\r\nconst defaultTab: TabStop = { pos: 0, leader: \"none\", style: \"left\" };\r\nconst maxTabs = 50;\r\n\r\nexport function computePixelToPoint(container: HTMLElement = document.body) {\r\n\tconst temp = document.createElement(\"div\");\r\n\ttemp.style.width = '100pt';\r\n\t\r\n\tcontainer.appendChild(temp);\r\n\tconst result = 100 / temp.offsetWidth;\r\n\tcontainer.removeChild(temp);\r\n\r\n\treturn result\r\n}\r\n\r\nexport function updateTabStop(elem: HTMLElement, tabs: ParagraphTab[], defaultTabSize: Length, pixelToPoint: number = 72 / 96) {\r\n    const p = elem.closest(\"p\");\r\n\r\n    const ebb = elem.getBoundingClientRect();\r\n    const pbb = p.getBoundingClientRect();\r\n    const pcs = getComputedStyle(p);\r\n\r\n\tconst tabStops = tabs?.length > 0 ? tabs.map(t => ({\r\n\t\tpos: lengthToPoint(t.position),\r\n\t\tleader: t.leader,\r\n\t\tstyle: t.style\r\n\t})).sort((a, b) => a.pos - b.pos) : [defaultTab];\r\n\r\n\tconst lastTab = tabStops[tabStops.length - 1];\r\n\tconst pWidthPt = pbb.width * pixelToPoint;\r\n\tconst size = lengthToPoint(defaultTabSize);\r\n    let pos = lastTab.pos + size;\r\n\r\n    if (pos < pWidthPt) {\r\n        for (; pos < pWidthPt && tabStops.length < maxTabs; pos += size) {\r\n            tabStops.push({ ...defaultTab, pos: pos });\r\n        }\r\n    }\r\n\r\n    const marginLeft = parseFloat(pcs.marginLeft);\r\n    const pOffset = pbb.left + marginLeft;\r\n    const left = (ebb.left - pOffset) * pixelToPoint;\r\n    const tab = tabStops.find(t => t.style != \"clear\" && t.pos > left);\r\n\r\n    if(tab == null)\r\n        return;\r\n\r\n    let width: number = 1;\r\n\r\n    if (tab.style == \"right\" || tab.style == \"center\") {\r\n\t\tconst tabStops = Array.from(p.querySelectorAll(`.${elem.className}`));\r\n\t\tconst nextIdx = tabStops.indexOf(elem) + 1;\r\n        const range = document.createRange();\r\n        range.setStart(elem, 1);\r\n\r\n\t\tif (nextIdx < tabStops.length) {\r\n\t\t\trange.setEndBefore(tabStops[nextIdx]);\r\n\t\t} else {\r\n\t\t\trange.setEndAfter(p);\r\n\t\t}\r\n\r\n\t\tconst mul = tab.style == \"center\" ? 0.5 : 1;\r\n        const nextBB = range.getBoundingClientRect();\r\n\t\tconst offset = nextBB.left + mul * nextBB.width - (pbb.left - marginLeft);\r\n\r\n\t\twidth = tab.pos - offset * pixelToPoint;\r\n    } else {\r\n        width = tab.pos - left;\r\n    }\r\n\r\n    elem.innerHTML = \"&nbsp;\";\r\n    elem.style.textDecoration = \"inherit\";\r\n    elem.style.wordSpacing = `${width.toFixed(0)}pt`;\r\n\r\n    switch (tab.leader) {\r\n        case \"dot\":\r\n        case \"middleDot\":\r\n            elem.style.textDecoration = \"underline\";\r\n            elem.style.textDecorationStyle = \"dotted\";\r\n            break;\r\n\r\n        case \"hyphen\":\r\n        case \"heavy\":\r\n        case \"underscore\":\r\n            elem.style.textDecoration = \"underline\";\r\n            break;\r\n    }\r\n}\r\n\r\nfunction lengthToPoint(length: Length): number {\r\n\treturn parseFloat(length);\r\n}","import { DomType, OpenXmlElement } from \"../document/dom\";\r\n\r\nexport abstract class WmlBaseNote implements OpenXmlElement {\r\n    id: string;\r\n\ttype: DomType;\r\n\tnoteType: string;\r\n    children?: OpenXmlElement[] = [];\r\n    cssStyle?: Record<string, string> = {};\r\n    className?: string;\r\n    parent?: OpenXmlElement;\r\n}\r\n\r\nexport class WmlFootnote extends WmlBaseNote {\r\n\ttype = DomType.Footnote\r\n}\r\n\r\nexport class WmlEndnote extends WmlBaseNote {\r\n\ttype = DomType.Endnote\r\n}","import { OpenXmlPackage } from \"../common/open-xml-package\";\r\nimport { Part } from \"../common/part\";\r\nimport { DocumentParser } from \"../document-parser\";\r\nimport { WmlBaseNote, WmlEndnote, WmlFootnote } from \"./elements\";\r\n\r\nexport class BaseNotePart<T extends WmlBaseNote> extends Part {\r\n    protected _documentParser: DocumentParser;\r\n\r\n    notes: T[]\r\n\r\n    constructor(pkg: OpenXmlPackage, path: string, parser: DocumentParser) {\r\n        super(pkg, path);\r\n        this._documentParser = parser;\r\n    }\r\n}\r\n\r\nexport class FootnotesPart extends BaseNotePart<WmlFootnote> {\r\n    constructor(pkg: OpenXmlPackage, path: string, parser: DocumentParser) {\r\n        super(pkg, path, parser);\r\n    }\r\n\r\n    parseXml(root: Element) {\r\n        this.notes = this._documentParser.parseNotes(root, \"footnote\", WmlFootnote);\r\n    }\r\n}\r\n\r\nexport class EndnotesPart extends BaseNotePart<WmlEndnote> {\r\n    constructor(pkg: OpenXmlPackage, path: string, parser: DocumentParser) {\r\n        super(pkg, path, parser);\r\n    }\r\n\r\n    parseXml(root: Element) {\r\n        this.notes = this._documentParser.parseNotes(root, \"endnote\", WmlEndnote);\r\n    }\r\n}","import { OpenXmlPackage } from \"../common/open-xml-package\";\r\nimport { Part } from \"../common/part\";\r\nimport { DocumentParser } from \"../document-parser\";\r\nimport { IDomNumbering } from \"../document/dom\";\r\nimport { AbstractNumbering, Numbering, NumberingBulletPicture, NumberingPartProperties, parseNumberingPart } from \"./numbering\";\r\n\r\nexport class NumberingPart extends Part implements NumberingPartProperties {\r\n    private _documentParser: DocumentParser;\r\n\r\n    constructor(pkg: OpenXmlPackage, path: string, parser: DocumentParser) {\r\n        super(pkg, path);\r\n        this._documentParser = parser;\r\n    }\r\n\r\n    numberings: Numbering[];\r\n    abstractNumberings: AbstractNumbering[];\r\n    bulletPictures: NumberingBulletPicture[];\r\n    \r\n    domNumberings: IDomNumbering[];\r\n\r\n    parseXml(root: Element) {\r\n        Object.assign(this, parseNumberingPart(root, this._package.xmlParser));\r\n        this.domNumberings = this._documentParser.parseNumberingFile(root);  \r\n    }\r\n}","import { NumberingPicBullet } from \"../document/dom\";\r\nimport { ParagraphProperties, parseParagraphProperties } from \"../document/paragraph\";\r\nimport { parseRunProperties, RunProperties } from \"../document/run\";\r\nimport { XmlParser } from \"../parser/xml-parser\";\r\n\r\nexport interface NumberingPartProperties {\r\n    numberings: Numbering[];\r\n    abstractNumberings: AbstractNumbering[];\r\n    bulletPictures: NumberingBulletPicture[];\r\n}\r\n\r\nexport interface Numbering {\r\n    id: string;\r\n    abstractId: string;\r\n    overrides: NumberingLevelOverride[];\r\n}\r\n\r\nexport interface NumberingLevelOverride {\r\n    level: number;\r\n    start: number;\r\n    numberingLevel: NumberingLevel;\r\n}\r\n\r\nexport interface AbstractNumbering {\r\n    id: string;\r\n    name: string;\r\n    multiLevelType: \"singleLevel\" | \"multiLevel\" | \"hybridMultilevel\" | string;\r\n    levels: NumberingLevel[];\r\n    numberingStyleLink: string;\r\n    styleLink: string;\r\n}\r\n\r\nexport interface NumberingLevel {\r\n    level: number;\r\n    start: string;\r\n    restart: number;\r\n    format: 'lowerRoman' | 'lowerLetter' | string;\r\n    text: string;\r\n    justification: string;\r\n    bulletPictureId: string;\r\n    paragraphStyle: string;\r\n    paragraphProps: ParagraphProperties;\r\n    runProps: RunProperties;\r\n}\r\n\r\nexport interface NumberingBulletPicture {\r\n    id: string;\r\n    referenceId: string;\r\n    style: string;\r\n}\r\n\r\nexport function parseNumberingPart(elem: Element, xml: XmlParser): NumberingPartProperties {\r\n    let result: NumberingPartProperties = {\r\n        numberings: [],\r\n        abstractNumberings: [],\r\n        bulletPictures: []\r\n    }\r\n    \r\n    for (let e of xml.elements(elem)) {\r\n        switch (e.localName) {\r\n            case \"num\":\r\n                result.numberings.push(parseNumbering(e, xml));\r\n                break;\r\n            case \"abstractNum\":\r\n                result.abstractNumberings.push(parseAbstractNumbering(e, xml));\r\n                break;\r\n            case \"numPicBullet\":\r\n                result.bulletPictures.push(parseNumberingBulletPicture(e, xml));\r\n                break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseNumbering(elem: Element, xml: XmlParser): Numbering {\r\n    let result = <Numbering>{\r\n        id: xml.attr(elem, 'numId'),\r\n        overrides: []\r\n    };\r\n\r\n    for (let e of xml.elements(elem)) {\r\n        switch (e.localName) {\r\n            case \"abstractNumId\":\r\n                result.abstractId = xml.attr(e, \"val\");\r\n                break;\r\n            case \"lvlOverride\":\r\n                result.overrides.push(parseNumberingLevelOverrride(e, xml));\r\n                break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseAbstractNumbering(elem: Element, xml: XmlParser): AbstractNumbering {\r\n    let result = <AbstractNumbering>{\r\n        id: xml.attr(elem, 'abstractNumId'),\r\n        levels: []\r\n    };\r\n\r\n    for (let e of xml.elements(elem)) {\r\n        switch (e.localName) {\r\n            case \"name\":\r\n                result.name = xml.attr(e, \"val\");\r\n                break;\r\n            case \"multiLevelType\":\r\n                result.multiLevelType = xml.attr(e, \"val\");\r\n                break;\r\n            case \"numStyleLink\":\r\n                result.numberingStyleLink = xml.attr(e, \"val\");\r\n                break;\r\n            case \"styleLink\":\r\n                result.styleLink = xml.attr(e, \"val\");\r\n                break;\r\n            case \"lvl\":\r\n                result.levels.push(parseNumberingLevel(e, xml));\r\n                break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseNumberingLevel(elem: Element, xml: XmlParser): NumberingLevel {\r\n    let result = <NumberingLevel>{\r\n        level: xml.intAttr(elem, 'ilvl')\r\n    };\r\n\r\n    for (let e of xml.elements(elem)) {\r\n        switch (e.localName) {\r\n            case \"start\":\r\n                result.start = xml.attr(e, \"val\");\r\n                break;\r\n            case \"lvlRestart\":\r\n                result.restart = xml.intAttr(e, \"val\");\r\n                break;\r\n            case \"numFmt\":\r\n                result.format = xml.attr(e, \"val\");\r\n                break;\r\n            case \"lvlText\":\r\n                result.text = xml.attr(e, \"val\");\r\n                break;\r\n            case \"lvlJc\":\r\n                result.justification = xml.attr(e, \"val\");\r\n                break;\r\n            case \"lvlPicBulletId\":\r\n                result.bulletPictureId = xml.attr(e, \"val\");\r\n                break;\r\n            case \"pStyle\":\r\n                result.paragraphStyle = xml.attr(e, \"val\");\r\n                break;\r\n            case \"pPr\":\r\n                result.paragraphProps = parseParagraphProperties(e, xml);\r\n                break;\r\n            case \"rPr\":\r\n                result.runProps = parseRunProperties(e, xml);\r\n                break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseNumberingLevelOverrride(elem: Element, xml: XmlParser): NumberingLevelOverride {\r\n    let result = <NumberingLevelOverride>{\r\n        level: xml.intAttr(elem, 'ilvl')\r\n    };\r\n\r\n    for (let e of xml.elements(elem)) {\r\n        switch (e.localName) {\r\n            case \"startOverride\":\r\n                result.start = xml.intAttr(e, \"val\");\r\n                break;\r\n            case \"lvl\":\r\n                result.numberingLevel = parseNumberingLevel(e, xml);\r\n                break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseNumberingBulletPicture(elem: Element, xml: XmlParser): NumberingBulletPicture {\r\n    //TODO\r\n    var pict = xml.element(elem, \"pict\");\r\n    var shape = pict && xml.element(pict, \"shape\");\r\n    var imagedata = shape && xml.element(shape, \"imagedata\");\r\n\r\n    return imagedata ? {\r\n        id: xml.attr(elem, \"numPicBulletId\"),\r\n        referenceId: xml.attr(imagedata, \"id\"),\r\n        style: xml.attr(shape, \"style\")\r\n    } : null;\r\n}","import { Length,  LengthUsage, LengthUsageType, convertLength, convertBoolean  } from \"../document/common\";\r\n\r\nexport function parseXmlString(xmlString: string, trimXmlDeclaration: boolean = false): Document {\r\n    if (trimXmlDeclaration)\r\n        xmlString = xmlString.replace(/<[?].*[?]>/, \"\");\r\n    \r\n    const result = new DOMParser().parseFromString(xmlString, \"application/xml\");  \r\n    const errorText = hasXmlParserError(result);\r\n\r\n    if (errorText)\r\n        throw new Error(errorText);\r\n\r\n    return result;\r\n}\r\n\r\nfunction hasXmlParserError(doc: Document) {\r\n    return doc.getElementsByTagName(\"parsererror\")[0]?.textContent;\r\n}\r\n\r\nexport function serializeXmlString(elem: Node): string {\r\n    return new XMLSerializer().serializeToString(elem);\r\n}\r\n\r\nexport class XmlParser {\r\n    elements(elem: Element, localName: string = null): Element[] {\r\n        const result = [];\r\n\r\n        for (let i = 0, l = elem.childNodes.length; i < l; i++) {\r\n            let c = elem.childNodes.item(i);\r\n\r\n            if (c.nodeType == 1 && (localName == null || (c as Element).localName == localName))\r\n                result.push(c);\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    element(elem: Element, localName: string): Element {\r\n        for (let i = 0, l = elem.childNodes.length; i < l; i++) {\r\n            let c = elem.childNodes.item(i);\r\n\r\n            if (c.nodeType == 1 && (c as Element).localName == localName)\r\n                return c as Element;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    elementAttr(elem: Element, localName: string, attrLocalName: string): string {\r\n        var el = this.element(elem, localName);\r\n        return el ? this.attr(el, attrLocalName) : undefined;\r\n    }\r\n\r\n\tattrs(elem: Element) {\r\n\t\treturn Array.from(elem.attributes);\r\n\t}\r\n\r\n    attr(elem: Element, localName: string): string {\r\n        for (let i = 0, l = elem.attributes.length; i < l; i++) {\r\n            let a = elem.attributes.item(i);\r\n\r\n            if (a.localName == localName)\r\n                return a.value;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    intAttr(node: Element, attrName: string, defaultValue: number = null): number {\r\n        var val = this.attr(node, attrName);\r\n        return val ? parseInt(val) : defaultValue;\r\n    }\r\n\r\n\thexAttr(node: Element, attrName: string, defaultValue: number = null): number {\r\n        var val = this.attr(node, attrName);\r\n        return val ? parseInt(val, 16) : defaultValue;\r\n    }\r\n\r\n    floatAttr(node: Element, attrName: string, defaultValue: number = null): number {\r\n        var val = this.attr(node, attrName);\r\n        return val ? parseFloat(val) : defaultValue;\r\n    }\r\n\r\n    boolAttr(node: Element, attrName: string, defaultValue: boolean = null) {\r\n        return convertBoolean(this.attr(node, attrName), defaultValue);\r\n    }\r\n\r\n    lengthAttr(node: Element, attrName: string, usage: LengthUsageType = LengthUsage.Dxa): Length {\r\n        return convertLength(this.attr(node, attrName), usage);\r\n    }\r\n}\r\n\r\nconst globalXmlParser = new XmlParser();\r\n\r\nexport default globalXmlParser;","import { OpenXmlPackage } from \"../common/open-xml-package\";\r\nimport { Part } from \"../common/part\";\r\nimport { WmlSettings, parseSettings } from \"./settings\";\r\n\r\nexport class SettingsPart extends Part {\r\n\tsettings: WmlSettings;\r\n\r\n\tconstructor(pkg: OpenXmlPackage, path: string) {\r\n\t\tsuper(pkg, path);\r\n\t}\r\n\r\n\tparseXml(root: Element) {\r\n\t\tthis.settings = parseSettings(root, this._package.xmlParser);\r\n\t}\r\n}","import { DocumentParser } from \"../document-parser\";\r\nimport { Length } from \"../document/common\";\r\nimport { XmlParser } from \"../parser/xml-parser\";\r\n\r\nexport interface WmlSettings {\r\n\tdefaultTabStop: Length;\r\n\tfootnoteProps: NoteProperties;\r\n\tendnoteProps: NoteProperties;\r\n\tautoHyphenation: boolean;\r\n}\r\n\r\nexport interface NoteProperties {\r\n\tnummeringFormat: string;\r\n\tdefaultNoteIds: string[];\r\n}\r\n\r\nexport function parseSettings(elem: Element, xml: XmlParser) {\r\n\tvar result = {} as WmlSettings; \r\n\r\n\tfor (let el of xml.elements(elem)) {\r\n\t\tswitch(el.localName) {\r\n\t\t\tcase \"defaultTabStop\": result.defaultTabStop = xml.lengthAttr(el, \"val\"); break;\r\n\t\t\tcase \"footnotePr\": result.footnoteProps = parseNoteProperties(el, xml); break;\r\n\t\t\tcase \"endnotePr\": result.endnoteProps = parseNoteProperties(el, xml); break;\r\n\t\t\tcase \"autoHyphenation\": result.autoHyphenation = xml.boolAttr(el, \"val\"); break;\r\n\t\t}\r\n\t}\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseNoteProperties(elem: Element, xml: XmlParser) {\r\n\tvar result = {\r\n\t\tdefaultNoteIds: []\r\n\t} as NoteProperties; \r\n\r\n\tfor (let el of xml.elements(elem)) {\r\n\t\tswitch(el.localName) {\r\n\t\t\tcase \"numFmt\": \r\n\t\t\t\tresult.nummeringFormat = xml.attr(el, \"val\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"footnote\": \r\n\t\t\tcase \"endnote\": \r\n\t\t\t\tresult.defaultNoteIds.push(xml.attr(el, \"id\"));\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n    return result;\r\n}","import { OpenXmlPackage } from \"../common/open-xml-package\";\r\nimport { Part } from \"../common/part\";\r\nimport { DocumentParser } from \"../document-parser\";\r\nimport { IDomStyle } from \"../document/style\";\r\n\r\nexport class StylesPart extends Part {\r\n    styles: IDomStyle[];\r\n\r\n    private _documentParser: DocumentParser;\r\n\r\n    constructor(pkg: OpenXmlPackage, path: string, parser: DocumentParser) {\r\n        super(pkg, path);\r\n        this._documentParser = parser;\r\n    }\r\n\r\n    parseXml(root: Element) {\r\n        this.styles = this._documentParser.parseStylesFile(root);     \r\n    }\r\n}","import { OpenXmlPackage } from \"../common/open-xml-package\";\r\nimport { Part } from \"../common/part\";\r\nimport { DmlTheme, parseTheme } from \"./theme\";\r\n\r\nexport class ThemePart extends Part {\r\n    theme: DmlTheme;\r\n\r\n    constructor(pkg: OpenXmlPackage, path: string) {\r\n        super(pkg, path);\r\n    }\r\n\r\n    parseXml(root: Element) {\r\n        this.theme = parseTheme(root, this._package.xmlParser);\r\n    }\r\n}","import { XmlParser } from \"../parser/xml-parser\";\r\n\r\nexport class DmlTheme {\r\n    colorScheme: DmlColorScheme;\r\n    fontScheme: DmlFontScheme;\r\n}\r\n\r\nexport interface DmlColorScheme {\r\n    name: string;\r\n    colors: Record<string, string>;\r\n}\r\n\r\nexport interface DmlFontScheme {\r\n    name: string;\r\n    majorFont: DmlFormInfo,\r\n    minorFont: DmlFormInfo\r\n}\r\n\r\nexport interface DmlFormInfo {\r\n    latinTypeface: string;\r\n    eaTypeface: string;\r\n    csTypeface: string;\r\n}\r\n\r\nexport function parseTheme(elem: Element, xml: XmlParser) {\r\n    var result = new DmlTheme();\r\n    var themeElements = xml.element(elem, \"themeElements\");\r\n\r\n    for (let el of xml.elements(themeElements)) {\r\n        switch(el.localName) {\r\n            case \"clrScheme\": result.colorScheme = parseColorScheme(el, xml); break;\r\n            case \"fontScheme\": result.fontScheme = parseFontScheme(el, xml); break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseColorScheme(elem: Element, xml: XmlParser) {\r\n    var result: DmlColorScheme = { \r\n        name: xml.attr(elem, \"name\"),\r\n        colors: {}\r\n    };\r\n\r\n    for (let el of xml.elements(elem)) {\r\n        var srgbClr = xml.element(el, \"srgbClr\");\r\n        var sysClr = xml.element(el, \"sysClr\");\r\n\r\n        if (srgbClr) {\r\n            result.colors[el.localName] = xml.attr(srgbClr, \"val\");\r\n        }\r\n        else if (sysClr) {\r\n            result.colors[el.localName] = xml.attr(sysClr, \"lastClr\");\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseFontScheme(elem: Element, xml: XmlParser) {\r\n    var result: DmlFontScheme = { \r\n        name: xml.attr(elem, \"name\"),\r\n    } as DmlFontScheme;\r\n\r\n    for (let el of xml.elements(elem)) {\r\n        switch (el.localName) {\r\n            case \"majorFont\": result.majorFont = parseFontInfo(el, xml); break;\r\n            case \"minorFont\": result.minorFont = parseFontInfo(el, xml); break;\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function parseFontInfo(elem: Element, xml: XmlParser): DmlFormInfo {\r\n    return {\r\n        latinTypeface: xml.elementAttr(elem, \"latin\", \"typeface\"),\r\n        eaTypeface: xml.elementAttr(elem, \"ea\", \"typeface\"),\r\n        csTypeface: xml.elementAttr(elem, \"cs\", \"typeface\"),\r\n    };\r\n}","export function escapeClassName(className: string) {\r\n\treturn className?.replace(/[ .]+/g, '-').replace(/[&]+/g, 'and').toLowerCase();\r\n}\r\n\r\nexport function splitPath(path: string): [string, string] {\r\n    let si = path.lastIndexOf('/') + 1;\r\n    let folder = si == 0 ? \"\" : path.substring(0, si);\r\n    let fileName = si == 0 ? path : path.substring(si);\r\n\r\n    return [folder, fileName];\r\n}\r\n\r\nexport function resolvePath(path: string, base: string): string {\r\n    try {\r\n        const prefix = \"http://docx/\";\r\n        const url = new URL(path, prefix + base).toString();\r\n        return url.substring(prefix.length);\r\n    } catch {\r\n        return `${base}${path}`;\r\n    }\r\n}\r\n\r\nexport function keyBy<T = any>(array: T[], by: (x: T) => any): Record<any, T> {\r\n    return array.reduce((a, x) => {\r\n        a[by(x)] = x;\r\n        return a;\r\n    }, {});\r\n}\r\n\r\nexport function blobToBase64(blob: Blob): any {\r\n\treturn new Promise((resolve, _) => {\r\n\t\tconst reader = new FileReader();\r\n\t\treader.onloadend = () => resolve(reader.result);\r\n\t\treader.readAsDataURL(blob);\r\n\t});\r\n}\r\n\r\nexport function isObject(item) {\r\n    return item && typeof item === 'object' && !Array.isArray(item);\r\n}\r\n\r\nexport function isString(item: unknown): item is string {\r\n    return item && typeof item === 'string' || item instanceof String;\r\n}\r\n\r\nexport function mergeDeep(target, ...sources) {\r\n    if (!sources.length) \r\n        return target;\r\n    \r\n    const source = sources.shift();\r\n\r\n    if (isObject(target) && isObject(source)) {\r\n        for (const key in source) {\r\n            if (isObject(source[key])) {\r\n                const val = target[key] ?? (target[key] = {});\r\n                mergeDeep(val, source[key]);\r\n            } else {\r\n                target[key] = source[key];\r\n            }\r\n        }\r\n    }\r\n\r\n    return mergeDeep(target, ...sources);\r\n}\r\n\r\nexport function parseCssRules(text: string): Record<string, string> {\r\n\tconst result: Record<string, string> = {};\r\n\r\n\tfor (const rule of text.split(';')) {\r\n\t\tconst [key, val] = rule.split(':');\r\n\t\tresult[key] = val;\r\n\t}\r\n\r\n\treturn result\r\n}\r\n\r\nexport function formatCssRules(style: Record<string, string>): string {\r\n\treturn Object.entries(style).map((k, v) => `${k}: ${v}`).join(';');\r\n}\r\n\r\nexport function asArray<T>(val: T | T[]): T[] {\r\n\treturn Array.isArray(val) ? val : [val];\r\n}","import { convertLength, LengthUsage } from '../document/common';\r\nimport { DomType, OpenXmlElement } from '../document/dom';\r\nimport xml from '../parser/xml-parser';\r\nimport { formatCssRules, parseCssRules } from '../utils';\r\n\r\nexport class VmlElement implements OpenXmlElement {\r\n\ttype: DomType = DomType.VmlElement;\r\n\ttagName: string;\r\n\tcssStyleText?: string;\r\n\tattrs: Record<string, string> = {};\r\n\tchidren: VmlElement[] = [];\r\n\twrapType?: string;\r\n\timageHref?: {\r\n\t\tid: string,\r\n\t\ttitle: string\r\n\t}\r\n}\r\n\r\nexport function parseVmlElement(elem: Element): VmlElement {\r\n\tvar result = new VmlElement();\r\n\r\n\tswitch (elem.localName) {\r\n\t\tcase \"rect\":\r\n\t\t\tresult.tagName = \"rect\"; \r\n\t\t\tObject.assign(result.attrs, { width: '100%', height: '100%' });\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"oval\":\r\n\t\t\tresult.tagName = \"ellipse\"; \r\n\t\t\tObject.assign(result.attrs, { cx: \"50%\", cy: \"50%\", rx: \"50%\", ry: \"50%\" });\r\n\t\t\tbreak;\r\n\t\r\n\t\tcase \"line\":\r\n\t\t\tresult.tagName = \"line\"; \r\n\t\t\tbreak;\r\n\r\n\t\tcase \"shape\":\r\n\t\t\tresult.tagName = \"g\"; \r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault:\r\n\t\t\treturn null;\r\n\t}\r\n\r\n\tfor (const at of xml.attrs(elem)) {\r\n\t\tswitch(at.localName) {\r\n\t\t\tcase \"style\": \r\n\t\t\t\tresult.cssStyleText = at.value;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"fillcolor\": \r\n\t\t\t\tresult.attrs.fill = at.value; \r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase \"from\":\r\n\t\t\t\tconst [x1, y1] = parsePoint(at.value);\r\n\t\t\t\tObject.assign(result.attrs, { x1, y1 });\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"to\":\r\n\t\t\t\tconst [x2, y2] = parsePoint(at.value);\r\n\t\t\t\tObject.assign(result.attrs, { x2, y2 });\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tfor (const el of xml.elements(elem)) {\r\n\t\tswitch (el.localName) {\r\n\t\t\tcase \"stroke\": \r\n\t\t\t\tObject.assign(result.attrs, parseStroke(el));\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"fill\": \r\n\t\t\t\tObject.assign(result.attrs, parseFill(el));\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"imagedata\":\r\n\t\t\t\tresult.tagName = \"image\";\r\n\t\t\t\tObject.assign(result.attrs, { width: '100%', height: '100%' });\r\n\t\t\t\tresult.imageHref = {\r\n\t\t\t\t\tid: xml.attr(el, \"id\"),\r\n\t\t\t\t\ttitle: xml.attr(el, \"title\"),\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tconst child = parseVmlElement(el);\r\n\t\t\t\tchild && result.chidren.push(child);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction parseStroke(el: Element): Record<string, string> {\r\n\treturn {\r\n\t\t'stroke': xml.attr(el, \"color\"),\r\n\t\t'stroke-width': xml.lengthAttr(el, \"weight\", LengthUsage.Emu) ?? '1px'\r\n\t};\r\n}\r\n\r\nfunction parseFill(el: Element): Record<string, string> {\r\n\treturn {\r\n\t\t//'fill': xml.attr(el, \"color2\")\r\n\t};\r\n}\r\n\r\nfunction parsePoint(val: string): string[] {\r\n\treturn val.split(\",\");\r\n}\r\n\r\nfunction convertPath(path: string): string {\r\n\treturn path.replace(/([mlxe])|([-\\d]+)|([,])/g, (m) => {\r\n\t\tif (/[-\\d]/.test(m)) return convertLength(m,  LengthUsage.VmlEmu);\r\n\t\tif (/[ml,]/.test(m)) return m;\r\n\r\n\t\treturn '';\r\n\t});\r\n}","import { OutputType } from \"jszip\";\r\n\r\nimport { DocumentParser } from './document-parser';\r\nimport { Relationship, RelationshipTypes } from './common/relationship';\r\nimport { Part } from './common/part';\r\nimport { FontTablePart } from './font-table/font-table';\r\nimport { OpenXmlPackage } from './common/open-xml-package';\r\nimport { DocumentPart } from './document/document-part';\r\nimport { blobToBase64, resolvePath, splitPath } from './utils';\r\nimport { NumberingPart } from './numbering/numbering-part';\r\nimport { StylesPart } from './styles/styles-part';\r\nimport { FooterPart, HeaderPart } from \"./header-footer/parts\";\r\nimport { ExtendedPropsPart } from \"./document-props/extended-props-part\";\r\nimport { CorePropsPart } from \"./document-props/core-props-part\";\r\nimport { ThemePart } from \"./theme/theme-part\";\r\nimport { EndnotesPart, FootnotesPart } from \"./notes/parts\";\r\nimport { SettingsPart } from \"./settings/settings-part\";\r\nimport { CustomPropsPart } from \"./document-props/custom-props-part\";\r\n\r\nconst topLevelRels = [\r\n\t{ type: RelationshipTypes.OfficeDocument, target: \"word/document.xml\" },\r\n\t{ type: RelationshipTypes.ExtendedProperties, target: \"docProps/app.xml\" },\r\n\t{ type: RelationshipTypes.CoreProperties, target: \"docProps/core.xml\" },\r\n\t{ type: RelationshipTypes.CustomProperties, target: \"docProps/custom.xml\" },\r\n];\r\n\r\nexport class WordDocument {\r\n\tprivate _package: OpenXmlPackage;\r\n\tprivate _parser: DocumentParser;\r\n\tprivate _options: any;\r\n\r\n\trels: Relationship[];\r\n\tparts: Part[] = [];\r\n\tpartsMap: Record<string, Part> = {};\r\n\r\n\tdocumentPart: DocumentPart;\r\n\tfontTablePart: FontTablePart;\r\n\tnumberingPart: NumberingPart;\r\n\tstylesPart: StylesPart;\r\n\tfootnotesPart: FootnotesPart;\r\n\tendnotesPart: EndnotesPart;\r\n\tthemePart: ThemePart;\r\n\tcorePropsPart: CorePropsPart;\r\n\textendedPropsPart: ExtendedPropsPart;\r\n\tsettingsPart: SettingsPart;\r\n\r\n\tstatic load(blob, parser: DocumentParser, options: any): Promise<WordDocument> {\r\n\t\tvar d = new WordDocument();\r\n\r\n\t\td._options = options;\r\n\t\td._parser = parser;\r\n\r\n\t\treturn OpenXmlPackage.load(blob, options)\r\n\t\t\t.then(pkg => {\r\n\t\t\t\td._package = pkg;\r\n\r\n\t\t\t\treturn d._package.loadRelationships();\r\n\t\t\t}).then(rels => {\r\n\t\t\t\td.rels = rels;\r\n\r\n\t\t\t\tconst tasks = topLevelRels.map(rel => {\r\n\t\t\t\t\tconst r = rels.find(x => x.type === rel.type) ?? rel; //fallback                    \r\n\t\t\t\t\treturn d.loadRelationshipPart(r.target, r.type);\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn Promise.all(tasks);\r\n\t\t\t}).then(() => d);\r\n\t}\r\n\r\n\tsave(type = \"blob\"): Promise<any> {\r\n\t\treturn this._package.save(type);\r\n\t}\r\n\r\n\tprivate loadRelationshipPart(path: string, type: string): Promise<Part> {\r\n\t\tif (this.partsMap[path])\r\n\t\t\treturn Promise.resolve(this.partsMap[path]);\r\n\r\n\t\tif (!this._package.get(path))\r\n\t\t\treturn Promise.resolve(null);\r\n\r\n\t\tlet part: Part = null;\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase RelationshipTypes.OfficeDocument:\r\n\t\t\t\tthis.documentPart = part = new DocumentPart(this._package, path, this._parser);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.FontTable:\r\n\t\t\t\tthis.fontTablePart = part = new FontTablePart(this._package, path);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.Numbering:\r\n\t\t\t\tthis.numberingPart = part = new NumberingPart(this._package, path, this._parser);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.Styles:\r\n\t\t\t\tthis.stylesPart = part = new StylesPart(this._package, path, this._parser);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.Theme:\r\n\t\t\t\tthis.themePart = part = new ThemePart(this._package, path);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.Footnotes:\r\n\t\t\t\tthis.footnotesPart = part = new FootnotesPart(this._package, path, this._parser);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.Endnotes:\r\n\t\t\t\tthis.endnotesPart = part = new EndnotesPart(this._package, path, this._parser);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.Footer:\r\n\t\t\t\tpart = new FooterPart(this._package, path, this._parser);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.Header:\r\n\t\t\t\tpart = new HeaderPart(this._package, path, this._parser);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.CoreProperties:\r\n\t\t\t\tthis.corePropsPart = part = new CorePropsPart(this._package, path);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.ExtendedProperties:\r\n\t\t\t\tthis.extendedPropsPart = part = new ExtendedPropsPart(this._package, path);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase RelationshipTypes.CustomProperties:\r\n\t\t\t\tpart = new CustomPropsPart(this._package, path);\r\n\t\t\t\tbreak;\r\n\t\r\n\t\t\tcase RelationshipTypes.Settings:\r\n\t\t\t\tthis.settingsPart = part = new SettingsPart(this._package, path);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (part == null)\r\n\t\t\treturn Promise.resolve(null);\r\n\r\n\t\tthis.partsMap[path] = part;\r\n\t\tthis.parts.push(part);\r\n\r\n\t\treturn part.load().then(() => {\r\n\t\t\tif (part.rels == null || part.rels.length == 0)\r\n\t\t\t\treturn part;\r\n\r\n\t\t\tconst [folder] = splitPath(part.path);\r\n\t\t\tconst rels = part.rels.map(rel => {\r\n\t\t\t\treturn this.loadRelationshipPart(resolvePath(rel.target, folder), rel.type)\r\n\t\t\t});\r\n\r\n\t\t\treturn Promise.all(rels).then(() => part);\r\n\t\t});\r\n\t}\r\n\r\n\tloadDocumentImage(id: string, part?: Part): PromiseLike<string> {\r\n\t\treturn this.loadResource(part ?? this.documentPart, id, \"blob\")\r\n\t\t\t.then(x => this.blobToURL(x));\r\n\t}\r\n\r\n\tloadNumberingImage(id: string): PromiseLike<string> {\r\n\t\treturn this.loadResource(this.numberingPart, id, \"blob\")\r\n\t\t\t.then(x => this.blobToURL(x));\r\n\t}\r\n\r\n\tloadFont(id: string, key: string): PromiseLike<string> {\r\n\t\treturn this.loadResource(this.fontTablePart, id, \"uint8array\")\r\n\t\t\t.then(x => x ? this.blobToURL(new Blob([deobfuscate(x, key)])) : x);\r\n\t}\r\n\r\n\tprivate blobToURL(blob: Blob): string | PromiseLike<string> {\r\n\t\tif (!blob)\r\n\t\t\treturn null;\r\n\r\n\t\tif (this._options.useBase64URL) {\r\n\t\t\treturn blobToBase64(blob);\r\n\t\t}\r\n\r\n\t\treturn URL.createObjectURL(blob);\r\n\t}\r\n\r\n\tfindPartByRelId(id: string, basePart: Part = null) {\r\n\t\tvar rel = (basePart.rels ?? this.rels).find(r => r.id == id);\r\n\t\tconst folder = basePart ? splitPath(basePart.path)[0] : '';\r\n\t\treturn rel ? this.partsMap[resolvePath(rel.target, folder)] : null;\r\n\t}\r\n\r\n\tgetPathById(part: Part, id: string): string {\r\n\t\tconst rel = part.rels.find(x => x.id == id);\r\n\t\tconst [folder] = splitPath(part.path);\r\n\t\treturn rel ? resolvePath(rel.target, folder) : null;\r\n\t}\r\n\r\n\tprivate loadResource(part: Part, id: string, outputType: OutputType) {\r\n\t\tconst path = this.getPathById(part, id);\r\n\t\treturn path ? this._package.load(path, outputType) : Promise.resolve(null);\r\n\t}\r\n}\r\n\r\nexport function deobfuscate(data: Uint8Array, guidKey: string): Uint8Array {\r\n\tconst len = 16;\r\n\tconst trimmed = guidKey.replace(/{|}|-/g, \"\");\r\n\tconst numbers = new Array(len);\r\n\r\n\tfor (let i = 0; i < len; i++)\r\n\t\tnumbers[len - i - 1] = parseInt(trimmed.substr(i * 2, 2), 16);\r\n\r\n\tfor (let i = 0; i < 32; i++)\r\n\t\tdata[i] = data[i] ^ numbers[i % len]\r\n\r\n\treturn data;\r\n}","module.exports = __WEBPACK_EXTERNAL_MODULE__626__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t345: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(667);\n"]},"metadata":{},"sourceType":"script"}